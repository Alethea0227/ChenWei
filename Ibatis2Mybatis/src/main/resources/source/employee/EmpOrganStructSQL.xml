<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="tbl_emp_organ_struct" >
  <resultMap id="BaseResultMap" class="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStruct" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Jul 08 15:37:24 CST 2015.
    -->
    <result column="CAT_ID" property="catId" jdbcType="VARCHAR" />
    <result column="EMPLOYEE_ID" property="employeeId" jdbcType="VARCHAR" />
    <result column="PARENT_CAT_ID" property="parentCatId" jdbcType="VARCHAR" />
    <result column="PARENT_EMPLOYEE_ID" property="parentEmployeeId" jdbcType="VARCHAR" />
    <result column="GRADE" property="grade" jdbcType="INTEGER" />
    <result column="COMPANY_ID" property="companyId" jdbcType="VARCHAR" />
    <result column="APPROVE_PROXY_EMP" property="approveProxyEmp" jdbcType="VARCHAR" />
  </resultMap>

  <resultMap id="ResultMapExt" class="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStruct" extends="BaseResultMap">
    <result property="employeeInfo" select="tbl_employee_info_vo.selectByEmployeeIdForOther" column="EMPLOYEE_ID"/>
    <result property="parentEmployeeInfo" select="tbl_employee_info_vo.selectByEmployeeIdForOther" column="PARENT_EMPLOYEE_ID"/>
    <result property="proxyEmployeeInfo" select="tbl_employee_info_vo.selectByEmployeeIdForOther" column="APPROVE_PROXY_EMP"/>
  </resultMap>

  <sql id="organStruct_Where_clause">
    <isNotEmpty property="grade" prepend="and">
      TBL_EMP_ORGAN_STRUCT.GRADE=#grade:INTEGER#
    </isNotEmpty>
    <isNotEmpty property="employeeId" prepend="and">
      TBL_EMP_ORGAN_STRUCT.EMPLOYEE_ID=#employeeId:VARCHAR#
    </isNotEmpty>
    <isNotEmpty property="parentEmployeeId" prepend="and">
      TBL_EMP_ORGAN_STRUCT.PARENT_EMPLOYEE_ID=#parentEmployeeId:VARCHAR#
    </isNotEmpty>
    <isNotEmpty property="catId" prepend="and">
      TBL_EMP_ORGAN_STRUCT.CAT_ID=#catId:VARCHAR#
    </isNotEmpty>
    <isNotEmpty property="parentCatId" prepend="and">
      TBL_EMP_ORGAN_STRUCT.PARENT_CAT_ID=#parentCatId:VARCHAR#
    </isNotEmpty>
    <isNotEmpty property="companyId" prepend="and">
      TBL_EMP_ORGAN_STRUCT.COMPANY_ID=#companyId:VARCHAR#
    </isNotEmpty>
  </sql>
  <sql id="Criteria_Where_Clause" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Jul 08 15:37:24 CST 2015.
    -->
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate" >
      <isEqual property="oredCriteria[].valid" compareValue="true" >
        (
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and" >
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and" >
          $oredCriteria[].criteriaWithSingleValue[].condition$
          #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and" >
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction="," >
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and" >
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  <select id="selectByCriteria" resultMap="BaseResultMap" parameterClass="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStructCriteria" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Jul 08 15:37:24 CST 2015.
    -->
    select *
    from tbl_emp_organ_struct
    <isParameterPresent >
      <include refid="tbl_emp_organ_struct.Criteria_Where_Clause" />
      <isNotNull property="orderByClause" >
        order by $orderByClause$
      </isNotNull>
    </isParameterPresent>
  </select>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterClass="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStructKey" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Jul 08 15:37:24 CST 2015.
    -->
    select *
    from tbl_emp_organ_struct
    where CAT_ID = #catId:VARCHAR#
    and EMPLOYEE_ID = #employeeId:VARCHAR#
    and PARENT_CAT_ID = #parentCatId:VARCHAR#
  </select>
  
   <select id="selectByemployeeid" resultMap="ResultMapExt" parameterClass="java.lang.String" >
    select *
    from tbl_emp_organ_struct
    where EMPLOYEE_ID = #employeeId:VARCHAR#
  </select>

  <!--组织架构 拖动员工时的数据库条件更新拖拽数据 -->
  <select id="getEmpOrganStructByParam" resultMap="BaseResultMap" parameterClass="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStruct" >
    select * from tbl_emp_organ_struct os  where os.CAT_ID = #catId:VARCHAR# and os.COMPANY_ID=#companyId:VARCHAR#
  </select>


  <!--组织架构 拖动员工时的数据库条件更新拖拽数据 -->
  <update id="drag" parameterClass="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStruct">
    update tbl_emp_organ_struct
      set
        CAT_ID=#catId:VARCHAR#,
        PARENT_CAT_ID=#parentCatId:VARCHAR#,
        COMPANY_ID=#companyId:VARCHAR#,
        PARENT_EMPLOYEE_ID = #parentEmployeeId:VARCHAR#,
        GRADE = #grade:VARCHAR#
    where EMPLOYEE_ID=#employeeId:VARCHAR#
  </update>
  <!--组织架构 拖动员工时的数据库条件查询 -->
  <select id="dragselect" resultClass="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStructEmployeeInfo" parameterClass="java.lang.String">
    select COMPANY_ID,EMPLOYEE_ID from tbl_emp_organ_struct
    where CAT_ID=#catId:VARCHAR#
  </select>

  <delete id="deleteByPrimaryKey" parameterClass="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStructKey" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Jul 08 15:37:24 CST 2015.
    -->
    delete from tbl_emp_organ_struct
    where CAT_ID = #catId:VARCHAR#
    and EMPLOYEE_ID = #employeeId:VARCHAR#
    and PARENT_CAT_ID = #parentCatId:VARCHAR#
  </delete>
  <delete id="deleteByCriteria" parameterClass="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStructCriteria" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Jul 08 15:37:24 CST 2015.
    -->
    delete from tbl_emp_organ_struct
    <include refid="tbl_emp_organ_struct.Criteria_Where_Clause" />
  </delete>
  <insert id="insert" parameterClass="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStruct" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Jul 08 15:37:24 CST 2015.
    -->
    insert into tbl_emp_organ_struct (CAT_ID, EMPLOYEE_ID, PARENT_CAT_ID, PARENT_EMPLOYEE_ID, GRADE,COMPANY_ID,APPROVE_PROXY_EMP)
    values (#catId:VARCHAR#, #employeeId:VARCHAR#, #parentCatId:VARCHAR#,
    #parentEmployeeId:VARCHAR#, #grade:INTEGER#,#companyId:VARCHAR#,#approveProxyEmp:VARCHAR#)
  </insert>
  <insert id="insertSelective" parameterClass="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStruct" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Jul 08 15:37:24 CST 2015.
    -->
    insert into tbl_emp_organ_struct
    <dynamic prepend="(" >
      <isNotNull prepend="," property="catId" >
        CAT_ID
      </isNotNull>
      <isNotNull prepend="," property="employeeId" >
        EMPLOYEE_ID
      </isNotNull>
      <isNotNull prepend="," property="parentCatId" >
        PARENT_CAT_ID
      </isNotNull>
      <isNotNull prepend="," property="parentEmployeeId" >
        PARENT_EMPLOYEE_ID
      </isNotNull>
      <isNotNull prepend="," property="grade" >
        GRADE
      </isNotNull>
      <isNotNull prepend="," property="companyId" >
        COMPANY_ID
      </isNotNull>
      <isNotNull prepend="," property="approveProxyEmp" >
        APPROVE_PROXY_EMP
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(" >
      <isNotNull prepend="," property="catId" >
        #catId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="employeeId" >
        #employeeId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="parentCatId" >
        #parentCatId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="parentEmployeeId" >
        #parentEmployeeId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="grade" >
        #grade:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="companyId" >
        #companyId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="approveProxyEmp" >
        #approveProxyEmp:VARCHAR#
      </isNotNull>
      )
    </dynamic>
  </insert>
  <select id="countByCriteria" parameterClass="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStructCriteria" resultClass="java.lang.Integer" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Jul 08 15:37:24 CST 2015.
    -->
    select count(*) from tbl_emp_organ_struct
    <include refid="tbl_emp_organ_struct.Criteria_Where_Clause" />
  </select>
  <update id="updateByCriteriaSelective" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Jul 08 15:37:24 CST 2015.
    -->
    update tbl_emp_organ_struct
    <dynamic prepend="set" >
      <isNotNull prepend="," property="record.catId" >
        CAT_ID = #record.catId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.employeeId" >
        EMPLOYEE_ID = #record.employeeId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.parentCatId" >
        PARENT_CAT_ID = #record.parentCatId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.parentEmployeeId" >
        PARENT_EMPLOYEE_ID = #record.parentEmployeeId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.grade" >
        GRADE = #record.grade:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="record.companyId" >
        COMPANY_ID = #record.companyId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.approveProxyEmp" >
        APPROVE_PROXY_EMP = #record.approveProxyEmp:VARCHAR#
      </isNotNull>
    </dynamic>
    <isParameterPresent >
      <include refid="tbl_emp_organ_struct.Criteria_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="updateByCriteria" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Jul 08 15:37:24 CST 2015.
    -->
    update tbl_emp_organ_struct
    set CAT_ID = #record.catId:VARCHAR#,
    EMPLOYEE_ID = #record.employeeId:VARCHAR#,
    PARENT_CAT_ID = #record.parentCatId:VARCHAR#,
    PARENT_EMPLOYEE_ID = #record.parentEmployeeId:VARCHAR#,
    COMPANY_ID = #record.companyId:VARCHAR#,
    GRADE = #record.grade:INTEGER#,
    APPROVE_PROXY_EMP = #record.approveProxyEmp:VARCHAR#
    <isParameterPresent >
      <include refid="tbl_emp_organ_struct.Criteria_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="updateByPrimaryKeySelective" parameterClass="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStruct" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Jul 08 15:37:24 CST 2015.
    -->
    update tbl_emp_organ_struct
    <dynamic prepend="set" >
      <isNotNull prepend="," property="parentEmployeeId" >
        PARENT_EMPLOYEE_ID = #parentEmployeeId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="grade" >
        GRADE = #grade:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="companyId" >
        COMPANY_ID = #companyId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="approveProxyEmp" >
        APPROVE_PROXY_EMP = #approveProxyEmp:VARCHAR#
      </isNotNull>
    </dynamic>
    where CAT_ID = #catId:VARCHAR#
    and EMPLOYEE_ID = #employeeId:VARCHAR#
    and PARENT_CAT_ID = #parentCatId:VARCHAR#
  </update>
  <update id="updateByPrimaryKey" parameterClass="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStruct" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Jul 08 15:37:24 CST 2015.
    -->
    update tbl_emp_organ_struct
    set PARENT_EMPLOYEE_ID = #parentEmployeeId:VARCHAR#,
    GRADE = #grade:INTEGER#,
    COMPANY_ID = #companyId:VARCHAR#,
    APPROVE_PROXY_EMP = #approveProxyEmp:VARCHAR#
    where CAT_ID = #catId:VARCHAR#
    and EMPLOYEE_ID = #employeeId:VARCHAR#
    and PARENT_CAT_ID = #parentCatId:VARCHAR#
  </update>
  <select id="selectProjectMembers" resultMap="ResultMapExt" parameterClass="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStruct">
    select *
    from tbl_emp_organ_struct
    <dynamic prepend="where">
      <include refid="tbl_emp_organ_struct.organStruct_Where_clause"/>
    </dynamic>
  </select>
  <select id="selectByAllStructs" resultMap="ResultMapExt" parameterClass="java.lang.String">
    SELECT *
    FROM tbl_emp_organ_struct
    WHERE CAT_ID !='0' and COMPANY_ID=#value:VARCHAR#
    ORDER BY GRADE DESC ,CAT_ID
  </select>
  <select id="getAllStructs" resultMap="ResultMapExt" parameterClass="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStruct">
    SELECT *
    FROM tbl_emp_organ_struct
    WHERE substr(PARENT_CAT_ID,1,LENGTH(#parentCatId:VARCHAR#)) = #parentCatId:VARCHAR# and COMPANY_ID=#companyId:VARCHAR#
    ORDER BY GRADE DESC ,CAT_ID
  </select>
  <select id="selectByCatId" resultMap="ResultMapExt" parameterClass="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStruct">
    SELECT *
    FROM tbl_emp_organ_struct
    <dynamic prepend="where">
      <include refid="tbl_emp_organ_struct.organStruct_Where_clause"/>
    </dynamic>
  </select>

  <select id="countOrganStucts" resultClass="java.lang.Integer" parameterClass="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStruct">
    SELECT COUNT(1)
    FROM tbl_emp_organ_struct
    <dynamic prepend="where">
      <include refid="tbl_emp_organ_struct.organStruct_Where_clause"/>
    </dynamic>
  </select>
  <select id="selectOrganStuctsByCatId" resultMap="ResultMapExt" parameterClass="com.i2shopping.i2work.operation.core.employee.model.EmpOrganStruct">
    SELECT *
    FROM tbl_emp_organ_struct
    <dynamic prepend="where">
      <include refid="tbl_emp_organ_struct.organStruct_Where_clause"/>
    </dynamic>
  </select>
  <select id="selectByParentId" resultMap="BaseResultMap" parameterClass="java.lang.String">
    SELECT *
    FROM tbl_emp_organ_struct
    WHERE PARENT_CAT_ID=#value:VARCHAR#
    ORDER BY CAT_ID desc
  </select>
</sqlMap>
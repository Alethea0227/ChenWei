<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="TBL_ROLE_ENT_RELATION" >
  <resultMap id="BankRoleGrantRelationResult" class="com.i2shopping.i2work.operation.core.common.model.BankRoleGrantRelationKey" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Nov 22 20:16:03 CST 2010.
    -->
    <result column="ROLE_ID" property="roleId" jdbcType="VARCHAR2" />
    <result column="DEPART_ID" property="departId" jdbcType="VARCHAR2" />
    <result column="ENTITLEMENT" property="entitlement" jdbcType="VARCHAR2" />
  </resultMap>

  
  
  <sql id="Criteria_Where_Clause" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Nov 22 20:16:03 CST 2010.
    -->
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate" >
      <isEqual property="oredCriteria[].valid" compareValue="true" >
        (
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and" >
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and" >
          $oredCriteria[].criteriaWithSingleValue[].condition$
            #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and" >
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction="," >
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and" >
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  <select id="selectByCriteria" resultMap="BankRoleGrantRelationResult" parameterClass="com.i2shopping.i2work.operation.core.common.dao.BankRoleGrantRelationCriteria" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Nov 22 20:16:03 CST 2010.
    -->
    select ROLE_ID, DEPART_ID, ENTITLEMENT
    from TBL_ROLE_ENT_RELATION
    <isParameterPresent >
      <include refid="Criteria_Where_Clause" />
    </isParameterPresent>
  </select>
  <delete id="deleteByPrimaryKey" parameterClass="com.i2shopping.i2work.operation.core.common.model.BankRoleGrantRelationKey" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Nov 22 20:16:03 CST 2010.
      and DEPART_ID = #departId:VARCHAR#
    -->
    delete from TBL_ROLE_ENT_RELATION
    where ROLE_ID = #roleId:VARCHAR#
      and ENTITLEMENT = #entitlement:VARCHAR#
  </delete>
  <delete id="deleteByCriteria" parameterClass="com.i2shopping.i2work.operation.core.common.dao.BankRoleGrantRelationCriteria" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Nov 22 20:16:03 CST 2010.
    -->
    delete from TBL_ROLE_ENT_RELATION
    <include refid="Criteria_Where_Clause" />
  </delete>
  <insert id="insert" parameterClass="com.i2shopping.i2work.operation.core.common.model.BankRoleGrantRelationKey" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Nov 22 20:16:03 CST 2010.
    -->
    insert into TBL_ROLE_ENT_RELATION (ROLE_ID, DEPART_ID, ENTITLEMENT)
    values (#roleId:VARCHAR#, #departId:VARCHAR#, #entitlement:VARCHAR#)
  </insert>
  <select id="countByCriteria" parameterClass="com.i2shopping.i2work.operation.core.common.dao.BankRoleGrantRelationCriteria" resultClass="java.lang.Integer" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Nov 22 20:16:03 CST 2010.
    -->
    select count(*) from TBL_ROLE_ENT_RELATION
    <include refid="Criteria_Where_Clause" />
  </select>
  <update id="updateByCriteriaSelective" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Nov 22 20:16:03 CST 2010.
    -->
    update TBL_ROLE_ENT_RELATION
    <dynamic prepend="set" >
      <isNotNull prepend="," property="record.roleId" >
        ROLE_ID = #record.roleId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.departId" >
        DEPART_ID = #record.departId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.entitlement" >
        ENTITLEMENT = #record.entitlement:VARCHAR#
      </isNotNull>
    </dynamic>
    <isParameterPresent >
      <include refid="Criteria_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="updateByCriteria" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Nov 22 20:16:03 CST 2010.
    -->
    update TBL_ROLE_ENT_RELATION
    set ROLE_ID = #record.roleId:VARCHAR#,
      DEPART_ID = #record.departId:VARCHAR#,
      ENTITLEMENT = #record.entitlement:VARCHAR#
    <isParameterPresent >
      <include refid="Criteria_Where_Clause" />
    </isParameterPresent>
  </update>
  
  <!-- 
 <select id="selectByCriteriaLazyLoad" resultMap="TBL_BANK_MANAGE_GRANTS.BankManageGrantsResult" parameterClass="com.icbc.emall.common.model.Role">
    SELECT B.* from TBL_ROLE_ENT_RELATION A,TBL_ENTITLEMENT B WHERE A.ROLE_ID = #roleId:VARCHAR# AND A.ENTITLEMENT = B.ENTITLEMENT AND A.DEPART_ID = #department.departId:VARCHAR#
  </select>
   -->
  
  
  <select id="selectByPrimaryKey" resultMap="TBL_BANK_MANAGE_GRANTS.BankManageGrantsResult" parameterClass="java.lang.String">
    SELECT B.* from TBL_ROLE_ENT_RELATION A,TBL_ENTITLEMENT B WHERE A.ROLE_ID = #id:VARCHAR# AND A.ENTITLEMENT = B.ENTITLEMENT
  </select>
  
  <select id="selectAllByEntitlement" resultMap="TBL_BANK_MANAGE_GRANTS.BankManageGrantsResult" parameterClass="com.i2shopping.i2work.operation.core.common.model.BankRoleGrantRelationKey">
    select b1.* from TBL_ROLE_ENT_RELATION b1 where b1.ENTITLEMENT = #entitlement:VARCHAR2#  and  not exists 
	( select b2.ROLE_ID from TBL_ROLE_ENT_RELATION  b2 where b2.ENTITLEMENT = #properties.entitlement:VARCHAR2# and b2.ROLE_ID = b1.ROLE_ID ) 
  </select>
  
  <delete id="deleteByEntitlement" parameterClass="java.lang.String" >
   delete from TBL_ROLE_ENT_RELATION where ENTITLEMENT = #entitlement:VARCHAR# 
  </delete>
</sqlMap>
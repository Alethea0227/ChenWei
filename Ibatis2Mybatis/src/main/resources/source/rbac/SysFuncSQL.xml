<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="TBL_SYS_FUNC" >
  <resultMap id="BaseResultMap" class="com.icbc.emall.common.model.SysFunc" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 21 11:20:04 CST 2012.
    -->
    <result column="FUNC_ID" property="funcId" jdbcType="VARCHAR" />
    <result column="FUNC_NAME" property="funcName" jdbcType="VARCHAR" />
    <result column="FUNC_DESC" property="funcDesc" jdbcType="VARCHAR" />
    <result column="FUNC_URL" property="funcUrl" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Criteria_Where_Clause" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 21 11:20:04 CST 2012.
    -->
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate" >
      <isEqual property="oredCriteria[].valid" compareValue="true" >
        (
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and" >
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and" >
          $oredCriteria[].criteriaWithSingleValue[].condition$
            #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and" >
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction="," >
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and" >
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  <select id="selectByCriteria" resultMap="BaseResultMap" parameterClass="com.icbc.emall.common.model.SysFuncCriteria" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 21 11:20:04 CST 2012.
    -->
    select FUNC_ID, FUNC_NAME, FUNC_DESC, FUNC_URL
    from TBL_SYS_FUNC
    <isParameterPresent >
      <include refid="TBL_SYS_FUNC.Criteria_Where_Clause" />
    </isParameterPresent>
  </select>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterClass="com.icbc.emall.common.model.SysFunc" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 21 11:20:04 CST 2012.
    -->
    select FUNC_ID, FUNC_NAME, FUNC_DESC, FUNC_URL
    from TBL_SYS_FUNC
    where FUNC_ID = #funcId:VARCHAR#
  </select>
  <delete id="deleteByPrimaryKey" parameterClass="com.icbc.emall.common.model.SysFunc" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 21 11:20:04 CST 2012.
    -->
    delete from TBL_SYS_FUNC
    where FUNC_ID = #funcId:VARCHAR#
  </delete>
  <delete id="deleteByCriteria" parameterClass="com.icbc.emall.common.model.SysFuncCriteria" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 21 11:20:04 CST 2012.
    -->
    delete from TBL_SYS_FUNC
    <include refid="TBL_SYS_FUNC.Criteria_Where_Clause" />
  </delete>
  <insert id="insert" parameterClass="com.icbc.emall.common.model.SysFunc" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 21 11:20:04 CST 2012.
    -->
    insert into TBL_SYS_FUNC (FUNC_ID, FUNC_NAME, FUNC_DESC, FUNC_URL)
    values (#funcId:VARCHAR#, #funcName:VARCHAR#, #funcDesc:VARCHAR#, #funcUrl:VARCHAR#)
  </insert>
  <insert id="insertSelective" parameterClass="com.icbc.emall.common.model.SysFunc" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 21 11:20:04 CST 2012.
    -->
    insert into TBL_SYS_FUNC
    <dynamic prepend="(" >
      <isNotNull prepend="," property="funcId" >
        FUNC_ID
      </isNotNull>
      <isNotNull prepend="," property="funcName" >
        FUNC_NAME
      </isNotNull>
      <isNotNull prepend="," property="funcDesc" >
        FUNC_DESC
      </isNotNull>
      <isNotNull prepend="," property="funcUrl" >
        FUNC_URL
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(" >
      <isNotNull prepend="," property="funcId" >
        #funcId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="funcName" >
        #funcName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="funcDesc" >
        #funcDesc:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="funcUrl" >
        #funcUrl:VARCHAR#
      </isNotNull>
      )
    </dynamic>
  </insert>
  <select id="countByCriteria" parameterClass="com.icbc.emall.common.model.SysFuncCriteria" resultClass="java.lang.Integer" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 21 11:20:04 CST 2012.
    -->
    select count(*) from TBL_SYS_FUNC
    <include refid="TBL_SYS_FUNC.Criteria_Where_Clause" />
  </select>
  <update id="updateByCriteriaSelective" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 21 11:20:04 CST 2012.
    -->
    update TBL_SYS_FUNC
    <dynamic prepend="set" >
      <isNotNull prepend="," property="record.funcId" >
        FUNC_ID = #record.funcId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.funcName" >
        FUNC_NAME = #record.funcName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.funcDesc" >
        FUNC_DESC = #record.funcDesc:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.funcUrl" >
        FUNC_URL = #record.funcUrl:VARCHAR#
      </isNotNull>
    </dynamic>
    <isParameterPresent >
      <include refid="TBL_SYS_FUNC.Criteria_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="updateByCriteria" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 21 11:20:04 CST 2012.
    -->
    update TBL_SYS_FUNC
    set FUNC_ID = #record.funcId:VARCHAR#,
      FUNC_NAME = #record.funcName:VARCHAR#,
      FUNC_DESC = #record.funcDesc:VARCHAR#,
      FUNC_URL = #record.funcUrl:VARCHAR#
    <isParameterPresent >
      <include refid="TBL_SYS_FUNC.Criteria_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="updateByPrimaryKeySelective" parameterClass="com.icbc.emall.common.model.SysFunc" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 21 11:20:04 CST 2012.
    -->
    update TBL_SYS_FUNC
    <dynamic prepend="set" >
      <isNotNull prepend="," property="funcName" >
        FUNC_NAME = #funcName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="funcDesc" >
        FUNC_DESC = #funcDesc:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="funcUrl" >
        FUNC_URL = #funcUrl:VARCHAR#
      </isNotNull>
    </dynamic>
    where FUNC_ID = #funcId:VARCHAR#
  </update>
  <update id="updateByPrimaryKey" parameterClass="com.icbc.emall.common.model.SysFunc" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 21 11:20:04 CST 2012.
    -->
    update TBL_SYS_FUNC
    set FUNC_NAME = #funcName:VARCHAR#,
      FUNC_DESC = #funcDesc:VARCHAR#,
      FUNC_URL = #funcUrl:VARCHAR#
    where FUNC_ID = #funcId:VARCHAR#
  </update>
  
  
  <!-- 根据user id 查找用户所属权限带有的功能 -->
  <select id="selectFuncByUserId" resultMap="BaseResultMap" parameterClass="java.lang.String" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 21 11:20:04 CST 2012.
    -->
    select * from TBL_SYS_FUNC where func_id in ( 
    	select FUNC_ID from TBL_MENU 
    	where ENTITLEMENT 
    	in ( 
    		select ENTITLEMENT 
    		from TBL_ROLE_ENT_RELATION 
    		where ROLE_ID 
    		in (
    			select ROLE_ID from TBL_USER_ROLE_REL where USERID = #userid:VARCHAR#
    		)
    	)
    )
  </select>
  
</sqlMap>
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="tbl_project_income_expenditrue_info" >
    <resultMap id="BaseResultMap" class="com.i2shopping.i2work.operation.core.project.model.ProjectIncomeExpenditrueInfo" >
        <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Thu Apr 19 15:03:50 CST 2012.
        -->
        <result column="project_income_id" property="projectIncomeId" jdbcType="VARCHAR" />
        <result column="contant_no" property="contantNo" jdbcType="VARCHAR" />
        <result column="project_name" property="projectName" jdbcType="VARCHAR" />
        <result column="project_money" property="projectMoney" jdbcType="VARCHAR" />
        <result column="project_money_type" property="projectMoneyType" jdbcType="VARCHAR" />
        <result column="custome_fine" property="customeFine" jdbcType="VARCHAR" />
        <result column="export_time" property="exportTime" jdbcType="TIMESTAMP" />
        <result column="project_income" property="projectIncome" jdbcType="VARCHAR" />
        <result column="project_income_date" property="projectIncomeDate" jdbcType="VARCHAR" />
        <result column="rename1" property="rename1" jdbcType="VARCHAR" />
        <result column="rename2" property="rename2" jdbcType="VARCHAR" />
        <result column="rename3" property="rename3" jdbcType="VARCHAR" />
    </resultMap>


    <select id="selectByProjectAll" resultMap="BaseResultMap" parameterClass="java.util.Map" >
        select pi.* from tbl_project_income_expenditrue_info pi,tbl_project_info tpi,tbl_department_info dept
        where pi.contant_no = tpi.contract_no and tpi.department_id = dept.DEPARTMENT_ID
        <isNotNull prepend="and" property="compayId" >
            dept.BEYOND_COMPANY = #compayId:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="departmentId" >
            dept.DEPARTMENT_ID =  = #departmentId:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="contantNo" >
            pi.contant_no= #contantNo:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="projectIncomeId" >
            pi.project_income_id = #projectIncomeId:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="projectName" >
            pi.project_name = #projectName:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="projectMoney" >
            pi.project_money = #projectMoney:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="projectMoneyType" >
            pi.project_money_type = #projectMoneyType:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="customeFine" >
            pi.custome_fine = #customeFine:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="exportTime" >
            pi.export_time = #exportTime:TIMESTAMP#
        </isNotNull>
        <isNotNull prepend="and" property="projectIncome" >
            pi.project_income = #projectIncome:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="projectIncomeDate" >
            pi.project_income_date = #projectIncomeDate:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="rename1" >
            pi.rename1 = #rename1:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="rename2" >
            pi.rename2 = #rename2:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="rename3" >
            pi.rename3 = #rename3:VARCHAR#
        </isNotNull>
        order by pi.export_time desc
    </select>

    <!-- 查询最近 这个是查询最近的导入数据，不是所有的数据 -->
    <select id="findByProjectIncomeExpenditureByContantNo" resultMap="BaseResultMap" parameterClass="com.i2shopping.i2work.operation.core.project.model.ProjectIncomeExpenditrueInfo" >
        select * from (
            select
            pi.project_income_id,
            pi.contant_no,
            pi.project_name,
            pi.project_money,
            pi.project_money_type,
            pi.project_income,
            pi.project_income_date,
            pi.custome_fine,
            pi.export_time,
            pi.rename1,
            pi.rename2,
            pi.rename3
            from tbl_project_income_expenditrue_info pi
            where pi.contant_no= #contantNo:VARCHAR#
            ORDER BY pi.export_time DESC
        )A GROUP BY A.contant_no
    </select>
    <select id="selectByProjectAllCount" resultClass="java.lang.Integer" parameterClass="java.util.Map" >
        select count(1) from tbl_project_income_expenditrue_info pi,tbl_project_info tpi,tbl_department_info dept
        where pi.contant_no = tpi.contract_no and tpi.department_id = dept.DEPARTMENT_ID
        <isNotNull prepend="and" property="compayId" >
            dept.BEYOND_COMPANY = #compayId:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="departmentId" >
            dept.DEPARTMENT_ID =  = #departmentId:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="contantNo" >
            pi.contant_no= #contantNo:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="projectIncomeId" >
            pi.project_income_id = #projectIncomeId:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="projectName" >
            pi.project_name = #projectName:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="projectMoney" >
            pi.project_money = #projectMoney:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="projectMoneyType" >
            pi.project_money_type = #projectMoneyType:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="customeFine" >
            pi.custome_fine = #customeFine:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="exportTime" >
            pi.export_time = #exportTime:TIMESTAMP#
        </isNotNull>
        <isNotNull prepend="and" property="projectIncome" >
            pi.project_income = #projectIncome:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="projectIncomeDate" >
            pi.project_income_date = #projectIncomeDate:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="rename1" >
            pi.rename1 = #rename1:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="rename2" >
            pi.rename2 = #rename2:VARCHAR#
        </isNotNull>
        <isNotNull prepend="and" property="rename3" >
            pi.rename3 = #rename3:VARCHAR#
        </isNotNull>
        order by pi.export_time desc
    </select>

    <select id="queryProjectByProjectIncomeId" resultMap="BaseResultMap" parameterClass="com.i2shopping.i2work.operation.core.project.model.ProjectIncomeExpenditrueInfo" >
        select * from tbl_project_income_expenditrue_info tpei
        <dynamic prepend="where">
            <isNotNull prepend="and" property="projectIncomeId" >
                tpei.project_income_id= #projectIncomeId:VARCHAR#
            </isNotNull>
        </dynamic>

    </select>
    <!-- 查询项目有多少个人 -->
    <select id="selectByProjectEmployeeCount" resultClass="java.lang.Integer" parameterClass="com.i2shopping.i2work.operation.core.project.model.ProjectIncomeExpenditrueInfo">
        select count(1) from  tbl_project_etc pre
        where   pre.is_Leave = '00'
        <isNotNull prepend="and" property="contantNo" >
            pre.contract_no= #contantNo:VARCHAR#
        </isNotNull>
    </select>

    <insert id="insertProjectSelective" parameterClass="com.i2shopping.i2work.operation.core.project.model.ProjectIncomeExpenditrueInfo" >
        <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Wed Jul 08 17:48:50 CST 2015.
        -->
        insert into tbl_project_income_expenditrue_info
        <dynamic prepend="(" >
            <isNotNull prepend="," property="projectIncomeId" >
                project_income_id
            </isNotNull>
            <isNotNull prepend="," property="contantNo" >
                contant_no
            </isNotNull>
            <isNotNull prepend="," property="projectName" >
                project_name
            </isNotNull>
            <isNotNull prepend="," property="projectMoney" >
                project_money
            </isNotNull>
            <isNotNull prepend="," property="projectMoneyType" >
                project_money_type
            </isNotNull>
            <isNotNull prepend="," property="customeFine" >
                custome_fine
            </isNotNull>
            <isNotNull prepend="," property="exportTime" >
                export_time
            </isNotNull>
            <isNotNull prepend="," property="projectIncome" >
                project_income
            </isNotNull>
            <isNotNull prepend="," property="projectIncomeDate" >
                project_income_date
            </isNotNull>
            <isNotNull prepend="," property="rename1" >
                rename1
            </isNotNull>
            <isNotNull prepend="," property="rename2" >
                rename2
            </isNotNull>
            <isNotNull prepend="," property="rename3" >
                rename3
            </isNotNull>
            )
        </dynamic>
        values
        <dynamic prepend="(" >
            <isNotNull prepend="," property="projectIncomeId" >
                 #projectIncomeId:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="contantNo" >
                 #contantNo:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="projectName" >
                 #projectName:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="projectMoney" >
                 #projectMoney:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="projectMoneyType" >
                 #projectMoneyType:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="customeFine" >
                 #customeFine:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="exportTime" >
                #exportTime:TIMESTAMP#
            </isNotNull>
            <isNotNull prepend="," property="projectIncome" >
                #projectIncome:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="projectIncomeDate" >
                #projectIncomeDate:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="rename1" >
                #rename1:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="rename2" >
                #rename2:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="rename3" >
                #rename3:VARCHAR#
            </isNotNull>
            )
        </dynamic>
    </insert>


    <update id="updateByPrimaryKeySelective" parameterClass="com.i2shopping.i2work.operation.core.project.model.ProjectIncomeExpenditrueInfo" >
        <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Wed Jul 08 17:48:50 CST 2015.
        -->
        update tbl_project_income_expenditrue_info
        <dynamic prepend="set" >
            <isNotNull prepend="," property="contantNo" >
                contant_no = #contantNo:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="projectName" >
                project_name = #projectName:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="projectMoney" >
                project_money = #projectMoney:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="projectMoneyType" >
                project_money_type = #projectMoneyType:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="customeFine" >
                custome_fine = #customeFine:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="exportTime" >
                export_time = #exportTime:TIMESTAMP#
            </isNotNull>
            <isNotNull prepend="," property="projectIncome" >
                project_income = #projectIncome:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="projectIncomeDate" >
                project_income_date= #projectIncomeDate:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="rename1" >
                rename1 = #rename1:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="rename2" >
                rename2 = #rename2:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="rename3" >
                rename3 = #rename3:VARCHAR#
            </isNotNull>
        </dynamic>
        <dynamic prepend="where" >
            <isNotNull prepend="and" property="projectIncomeId" >
                project_income_id = #projectIncomeId:VARCHAR#
            </isNotNull>
        </dynamic>
    </update>
</sqlMap>
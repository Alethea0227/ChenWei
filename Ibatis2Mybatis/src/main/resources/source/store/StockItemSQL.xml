<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="tbl_stock_item" >

	  <resultMap id="BaseResultMap" class="com.i2shopping.i2work.operation.core.stock.model.StockItem" >
	    <result column="STOCK_ITEM_ID" property="stockItemId" jdbcType="VARCHAR" />
	    <result column="EMPLOYEE_ID" property="employeeId" jdbcType="VARCHAR" />
	    <result column="STOCK_ITEM_DATE" property="stockItemDate" jdbcType="TIMESTAMP" />
	    <result column="EMP_INTEGRAL" property="empIntegral" jdbcType="INTEGER" />
	    <result column="STOCK_TYPE" property="stockType" jdbcType="CHAR" />
	    <result column="STOCK_REASON" property="stockReason" jdbcType="VARCHAR" />
	  </resultMap>

	<resultMap id="ResultMapExt" class="com.i2shopping.i2work.operation.core.stock.model.StockItem" extends="BaseResultMap">
		<result column="EMPLOYEE_NAME" property="employeeName" jdbcType="VARCHAR" />
	</resultMap>
  
  <sql id="Criteria_Where_Clause" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 10 17:40:43 CST 2015.
    -->
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate" >
      <isEqual property="oredCriteria[].valid" compareValue="true" >
        (
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and" >
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and" >
          $oredCriteria[].criteriaWithSingleValue[].condition$
            #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and" >
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction="," >
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and" >
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  
  
   <sql id="tbl_stock_item.stock_Where_Clause">
    	<isNotEmpty prepend="and" property="stockItemId">
				tbl_stock_item.STOCK_ITEM_ID = #stockItemId:VARCHAR#
		</isNotEmpty>
    	<isNotEmpty prepend="and" property="employeeId">
				tbl_stock_item.EMPLOYEE_ID = #employeeId:VARCHAR#
		</isNotEmpty>
		<isNotEmpty prepend="and" property="stockItemDate">
				tbl_stock_item.STOCK_ITEM_DATE = #stockItemDate:TIMESTAMP#
		</isNotEmpty>
		<isNotEmpty prepend="and" property="empIntegral">
				tbl_stock_item.EMP_INTEGRAL = #empIntegral:INTEGER#
		</isNotEmpty>
		<isNotEmpty prepend="and" property="stockType">
				tbl_stock_item.STOCK_TYPE = #stockType:VARCHAR#
		</isNotEmpty>
		<isNotEmpty prepend="and" property="stockReason">
				tbl_stock_item.STOCK_REASON = #stockReason:VARCHAR#
		</isNotEmpty>
		order by STOCK_ITEM_DATE desc;
    </sql>
  
  <select id="selectByStockItem" resultMap="BaseResultMap" parameterClass="com.i2shopping.i2work.operation.core.stock.model.StockItem" >
  		 select STOCK_ITEM_ID, EMPLOYEE_ID, STOCK_ITEM_DATE, EMP_INTEGRAL, STOCK_TYPE, STOCK_REASON
   			 from tbl_stock_item
   		<dynamic prepend="where">
		    <include refid="tbl_stock_item.stock_Where_Clause" />
		</dynamic>
   </select>
  
  
 <select id="selectByCriteria" resultMap="BaseResultMap" parameterClass="com.i2shopping.i2work.operation.core.stock.model.StockItemCriteria" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 10 17:40:43 CST 2015.
    -->
    select STOCK_ITEM_ID, EMPLOYEE_ID, STOCK_ITEM_DATE, EMP_INTEGRAL, STOCK_TYPE, STOCK_REASON
    from tbl_stock_item
    <isParameterPresent >
      <include refid="tbl_stock_item.Criteria_Where_Clause" />
      <isNotNull property="orderByClause" >
        order by $orderByClause$
      </isNotNull>
    </isParameterPresent>
  </select>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterClass="com.i2shopping.i2work.operation.core.stock.model.StockItem" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 10 17:40:43 CST 2015.
    -->
    select STOCK_ITEM_ID, EMPLOYEE_ID, STOCK_ITEM_DATE, EMP_INTEGRAL, STOCK_TYPE, STOCK_REASON
    from tbl_stock_item
    where STOCK_ITEM_ID = #stockItemId:VARCHAR#
  </select>
  
<delete id="deleteByPrimaryKey" parameterClass="com.i2shopping.i2work.operation.core.stock.model.StockItem" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 10 17:40:43 CST 2015.
    -->
    delete from tbl_stock_item
    where STOCK_ITEM_ID = #stockItemId:VARCHAR#
  </delete>
  <delete id="deleteByCriteria" parameterClass="com.i2shopping.i2work.operation.core.stock.model.StockItemCriteria" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 10 17:40:43 CST 2015.
    -->
    delete from tbl_stock_item
    <include refid="tbl_stock_item.Criteria_Where_Clause" />
  </delete>
  
   <insert id="insert" parameterClass="com.i2shopping.i2work.operation.core.stock.model.StockItem" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 10 17:40:43 CST 2015.
    -->
    insert into tbl_stock_item (STOCK_ITEM_ID, EMPLOYEE_ID, STOCK_ITEM_DATE, EMP_INTEGRAL,
      STOCK_TYPE, STOCK_REASON)
    values (#stockItemId:VARCHAR#, #employeeId:VARCHAR#, #stockItemDate:TIMESTAMP#,
      #empIntegral:INTEGER#, #stockType:CHAR#, #stockReason:VARCHAR#)
  </insert>
  <insert id="insertSelective" parameterClass="com.i2shopping.i2work.operation.core.stock.model.StockItem" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 10 17:40:43 CST 2015.
    -->
    insert into tbl_stock_item
    <dynamic prepend="(" >
      <isNotNull prepend="," property="stockItemId" >
        STOCK_ITEM_ID
      </isNotNull>
      <isNotNull prepend="," property="employeeId" >
        EMPLOYEE_ID
      </isNotNull>
      <isNotNull prepend="," property="stockItemDate" >
        STOCK_ITEM_DATE
      </isNotNull>
      <isNotNull prepend="," property="empIntegral" >
        EMP_INTEGRAL
      </isNotNull>
      <isNotNull prepend="," property="stockType" >
        STOCK_TYPE
      </isNotNull>
      <isNotNull prepend="," property="stockReason" >
        STOCK_REASON
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(" >
      <isNotNull prepend="," property="stockItemId" >
        #stockItemId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="employeeId" >
        #employeeId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="stockItemDate" >
        #stockItemDate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="empIntegral" >
        #empIntegral:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="stockType" >
        #stockType:CHAR#
      </isNotNull>
      <isNotNull prepend="," property="stockReason" >
        #stockReason:VARCHAR#
      </isNotNull>
      )
    </dynamic>
  </insert>
  
<select id="countByCriteria" parameterClass="com.i2shopping.i2work.operation.core.stock.model.StockItemCriteria" resultClass="java.lang.Integer" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 10 17:40:43 CST 2015.
    -->
    select count(*) from tbl_stock_item
    <include refid="tbl_stock_item.Criteria_Where_Clause" />
  </select>
  <update id="updateByCriteriaSelective" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 10 17:40:43 CST 2015.
    -->
    update tbl_stock_item
    <dynamic prepend="set" >
      <isNotNull prepend="," property="record.stockItemId" >
        STOCK_ITEM_ID = #record.stockItemId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.employeeId" >
        EMPLOYEE_ID = #record.employeeId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.stockItemDate" >
        STOCK_ITEM_DATE = #record.stockItemDate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="record.empIntegral" >
        EMP_INTEGRAL = #record.empIntegral:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="record.stockType" >
        STOCK_TYPE = #record.stockType:CHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.stockReason" >
        STOCK_REASON = #record.stockReason:VARCHAR#
      </isNotNull>
    </dynamic>
    <isParameterPresent >
      <include refid="tbl_stock_item.Criteria_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="updateByCriteria" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 10 17:40:43 CST 2015.
    -->
    update tbl_stock_item
    set STOCK_ITEM_ID = #record.stockItemId:VARCHAR#,
      EMPLOYEE_ID = #record.employeeId:VARCHAR#,
      STOCK_ITEM_DATE = #record.stockItemDate:TIMESTAMP#,
      EMP_INTEGRAL = #record.empIntegral:INTEGER#,
      STOCK_TYPE = #record.stockType:CHAR#,
      STOCK_REASON = #record.stockReason:VARCHAR#
    <isParameterPresent >
      <include refid="tbl_stock_item.Criteria_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="updateByPrimaryKeySelective" parameterClass="com.i2shopping.i2work.operation.core.stock.model.StockItem" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 10 17:40:43 CST 2015.
    -->
    update tbl_stock_item
    <dynamic prepend="set" >
      <isNotNull prepend="," property="employeeId" >
        EMPLOYEE_ID = #employeeId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="stockItemDate" >
        STOCK_ITEM_DATE = #stockItemDate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="empIntegral" >
        EMP_INTEGRAL = #empIntegral:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="stockType" >
        STOCK_TYPE = #stockType:CHAR#
      </isNotNull>
      <isNotNull prepend="," property="stockReason" >
        STOCK_REASON = #stockReason:VARCHAR#
      </isNotNull>
    </dynamic>
    where STOCK_ITEM_ID = #stockItemId:VARCHAR#
  </update>
  <update id="updateByPrimaryKey" parameterClass="com.i2shopping.i2work.operation.core.stock.model.StockItem" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 10 17:40:43 CST 2015.
    -->
    update tbl_stock_item
    set EMPLOYEE_ID = #employeeId:VARCHAR#,
      STOCK_ITEM_DATE = #stockItemDate:TIMESTAMP#,
      EMP_INTEGRAL = #empIntegral:INTEGER#,
      STOCK_TYPE = #stockType:CHAR#,
      STOCK_REASON = #stockReason:VARCHAR#
    where STOCK_ITEM_ID = #stockItemId:VARCHAR#
  </update>
  
   <sql id="stock_Item_Where_Clause">
  		<isNotEmpty prepend="and" property="properties.employeeName">
				info.employee_name like concat('%', #properties.employeeName:VARCHAR#, '%')
		</isNotEmpty>
  		<isNotEmpty prepend="and" property="properties.startTime">
  		<![CDATA[
  			date_format(item.STOCK_ITEM_DATE ,'%Y-%m-%d') >= #properties.startTime:VARCHAR#
      	 ]]>
		</isNotEmpty>
		<isNotEmpty prepend="and" property="properties.endTime">
		 <![CDATA[
		 		date_format(item.STOCK_ITEM_DATE ,'%Y-%m-%d') <= #properties.endTime:VARCHAR#
		   ]]>
		</isNotEmpty>
  </sql>
   
  <!-- 查询股权明细， -->
   <select id="selectStockItemByPage" parameterClass="com.i2shopping.i2work.operation.core.stock.model.StockItem" resultMap="ResultMapExt">
    select item.*,info.employee_name from tbl_stock_item item , tbl_employee_info info where item.employee_id = info.employee_id 
  	 <include refid="tbl_stock_item.stock_Item_Where_Clause" />
  	 order by item.STOCK_ITEM_DATE desc
  </select>
  
  <select id="countByStockItem" parameterClass="com.i2shopping.i2work.operation.core.stock.model.StockItem" resultClass="java.lang.Integer" >
	select  count(*) from tbl_stock_item item , tbl_employee_info info where item.employee_id = info.employee_id 
		<include refid="tbl_stock_item.stock_Item_Where_Clause" />
  </select>
  
  <select id="selectByStockItemId" parameterClass="com.i2shopping.i2work.operation.core.stock.model.StockItem" resultClass="com.i2shopping.i2work.operation.core.stock.model.StockItem">
      select item.STOCK_ITEM_ID as stockItemId, item.EMPLOYEE_ID as employeeId, item.STOCK_ITEM_DATE as stockItemDate, item.EMP_INTEGRAL as empIntegral, item.STOCK_TYPE as stockType, item.STOCK_REASON as stockReason,info.employee_name as employeeName from tbl_stock_item item , tbl_employee_info info where item.STOCK_ITEM_ID = #stockItemId:VARCHAR# and item.employee_id = info.employee_id  
  </select>
  
</sqlMap>
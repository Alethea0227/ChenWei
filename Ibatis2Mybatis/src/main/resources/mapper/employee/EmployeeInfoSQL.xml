<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="tbl_employee_info">
  <resultMap id="BaseResultMap" type="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Mon Jun 22 00:14:12 CST 2015.
        -->
    <result column="EMPLOYEE_ID" property="employeeId" jdbcType="VARCHAR"/>
    <result column="EMPLOYEE_NAME" property="employeeName" jdbcType="VARCHAR"/>
    <result column="EMPLOYEE_GRADE" property="employeeGrade" jdbcType="CHAR"/>
    <result column="MOBILE" property="mobile" jdbcType="CHAR"/>
    <result column="EMAIL" property="email" jdbcType="VARCHAR"/>
    <result column="CARDID" property="cardid" jdbcType="VARCHAR"/>
    <result column="EMPLOYEE_DUTY" property="employeeDuty" jdbcType="VARCHAR"/>
    <result column="DEPARTMENT_ID" property="departmentId" jdbcType="CHAR"/>
    <result column="IS_ON_DUTY" property="isOnDuty" jdbcType="CHAR"/>
    <result column="INTEGRATION" property="integration" jdbcType="INTEGER"/>
    <result column="STOCK" property="stock" jdbcType="INTEGER"/>
    <result column="LEVEL" property="level" jdbcType="INTEGER"/>
    <result column="IMAGE_ID" property="imageId" jdbcType="VARCHAR"/>
    <result column="BOARDING_TIME" property="boardingTime" jdbcType="DATE"/>
    <result column="EMPLOYEE_ADRESS" property="employeeAdress" jdbcType="VARCHAR"/>
    <result column="SEX" property="sex" jdbcType="CHAR"/>
    <result column="EMPLOYEE_NATION" property="employeeNation" jdbcType="VARCHAR"/>
    <result column="BIRTH_TIME" property="birthTime" jdbcType="DATE"/>
    <result column="WORK_LIFE" property="workLife" jdbcType="DECIMAL"/>
    <result column="DEGREE" property="degree" jdbcType="VARCHAR"/>
    <result column="LEAVE_TIME" property="leaveTime" jdbcType="DATE"/>
    <result column="HUKOU" property="hukou" jdbcType="VARCHAR"/>
    <result column="HUKOU_TYPE" property="hukouType" jdbcType="CHAR"/>
    <result column="MARRIED_STATUS" property="marriedStatus" jdbcType="CHAR"/>
    <result column="POLITICS_STATUS" property="politicsStatus" jdbcType="CHAR"/>
    <result column="EDUCATION_BACKGROUND" property="educationBackground" jdbcType="CHAR"/>
    <result column="GRADUTED_SCHOOL" property="gradutedSchool" jdbcType="VARCHAR"/>
    <result column="MAJOR" property="major" jdbcType="VARCHAR"/>
    <result column="GRADUTED_TIME" property="gradutedTime" jdbcType="DATE"/>
    <result column="BEGIN_WORK_TIME" property="beginWorkTime" jdbcType="DATE"/>
    <result column="LABOR_CONTRACT_BEGIN_TIME" property="laborContractBeginTime" jdbcType="DATE"/>
    <result column="LABOR_CONTRACT_END_TIME" property="laborContractEndTime" jdbcType="DATE"/>
    <result column="Expected_positive_time" property="expectedPositiveTime" jdbcType="DATE"/>
    <result column="actual_positive_time" property="actualPositiveTime" jdbcType="DATE"/>
    <result column="household_address" property="householdAddress" jdbcType="VARCHAR"/>
    <result column="Employment_way" property="employmentWay" jdbcType="VARCHAR"/>
    <result column="LEAVE_REASON" property="leaveReason" jdbcType="VARCHAR"/>
    <result column="BEYOND_COMPANY" property="beyondCompany" jdbcType="VARCHAR"/>
    <result column="GRASS_LEVEL_ID" property="grassLevelId" jdbcType="VARCHAR"/>
    <result column="actual_employee_id" property="actualEmployeeId" jdbcType="VARCHAR"/>
    <result column="IS_FIXED_PLACE_WORKING" property="isFixedPlaceWorking" jdbcType="CHAR"/>
    <result column="is_check_imsi" property="isCheckImsi" jdbcType="CHAR"/>
    <result column="CONTRACT_TYPE" property="contractType" jdbcType="VARCHAR"/>
    <result column="IS_RENEW" property="isRenew" jdbcType="VARCHAR"/>
    <result column="RENEW_TIME" property="renewTime" jdbcType="VARCHAR"/>
  </resultMap>
  <!--<resultMap id="equipmentRecordMap" class="com.i2shopping.i2work.operation.core.employee.model.EquipmentRecord">-->
  <!--<result column="EMPLOYEE_ID" property="employeeId" jdbcType="VARCHAR"></result>-->
  <!--<result column="EQUIPMENT_ID" property="equipmentId" jdbcType="VARCHAR"></result>-->
  <!--<result column="SERIAL_NUMBER" property="serialNumber" jdbcType="VARCHAR"></result>-->
  <!--</resultMap>-->
  <!--<resultMap id="employeeEquInfoMap" class="com.i2shopping.i2work.operation.core.employee.model.EmployeeEquInfo">-->
  <!--<result column="EMPLOYEE_ID" property="employeeId" jdbcType="VARCHAR"></result>-->
  <!--<result column="actual_employee_id" property="actualEmployeeId" jdbcType="VARCHAR"></result>-->
  <!--<result column="IS_ON_DUTY" property="isOnDuty" jdbcType="VARCHAR"></result>-->
  <!--<result column="EMPLOYEE_NAME" property="employeeName" jdbcType="VARCHAR"></result>-->
  <!--<result column="IS_ACEPT" property="isAcept" jdbcType="VARCHAR"></result>-->
  <!--<result column="IS_CHANGE" property="isChange" jdbcType="VARCHAR"></result>-->
  <!--<result column="IS_RETURN" property="isReturn" jdbcType="VARCHAR"></result>-->
  <!--<result column="RETURN_TIME" property="returnTime" jdbcType="VARCHAR"></result>-->
  <!--<result column="ACCEPT_USER" property="acceptUser" jdbcType="VARCHAR"></result>-->
  <!--<result column="CHANGE_TIME" property="changeTime" jdbcType="VARCHAR"></result>-->
  <!--<result column="IMAGE_ID" property="imageId" jdbcType="VARCHAR"></result>-->
  <!--<result column="EQUIPMENT_ID" property="equipmentId" jdbcType="VARCHAR"></result>-->
  <!--<result column="EQUIPMENT_TIME" property="equipmentTime" jdbcType="VARCHAR"></result>-->
  <!--<result column="EQUIPMENT_TYPE" property="equipmentType" jdbcType="VARCHAR"></result>-->
  <!--<result column="EQUIPMENT_COL" property="equipmentCol" jdbcType="VARCHAR"></result>-->
  <!--<result column="EQUIPMENT_SIZE" property="equipmentSize" jdbcType="VARCHAR"></result>-->
  <!--<result column="EQUIPMENT_SERIAL" property="equipmentSerial" jdbcType="VARCHAR"></result>-->
  <!--<result column="CHANGE_SERIAL" property="changeSerial" jdbcType="VARCHAR"></result>-->
  <!--</resultMap>-->
  <!--<resultMap id="equipmentInfoMap" class="com.i2shopping.i2work.operation.core.employee.model.EquipmentInfo">-->
  <!--<result column="EQUIPMENT_ID" property="equipmentId" jdbcType="VARCHAR"></result>-->
  <!--<result column="EQUIPMENT_TYPE" property="equipmentType" jdbcType="VARCHAR"></result>-->
  <!--<result column="EQUIPMENT_COL" property="equipmentCol" jdbcType="VARCHAR"></result>-->
  <!--<result column="EQUIPMENT_SIZE" property="equipmentSize" jdbcType="VARCHAR"></result>-->
  <!--<result column="EQUIPMENT_SERIAL" property="equipmentSerial" jdbcType="VARCHAR"></result>-->
  <!--</resultMap>-->
  <!-- 搜索可审批人的所有关键信息 -->
  <resultMap id="EmployeeVerifyTask" type="com.i2shopping.i2work.operation.core.employee.model.EmployeeTaskVerify">
    <result column="EMPLOYEE_NAME" property="employeeName" jdbcType="VARCHAR"/>
    <result column="EMPLOYEE_GRADE" property="employeeGrade" jdbcType="CHAR"/>
    <result column="IMAGE_ID" property="imageId" jdbcType="VARCHAR"/>
    <result column="project_name" property="projectName" jdbcType="VARCAHR"/>
    <result column="A" property="allTask" jdbcType="INTEGER"/>
    <result column="B" property="verifyTask" jdbcType="INTEGER"/>
  </resultMap>
  <resultMap id="EmployeeVerifyTaskPercent" extends="EmployeeVerifyTask" type="com.i2shopping.i2work.operation.core.employee.model.EmployeeTaskVerify">
    <result column="C" property="percent" jdbcType="DECIMAL"/>
  </resultMap>
  <resultMap id="contractExpiresMap" type="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">
    <result column="EMPLOYEE_ID" property="employeeId" jdbcType="VARCHAR"/>
    <result column="EMPLOYEE_NAME" property="employeeName" jdbcType="VARCHAR"/>
    <result column="LABOR_CONTRACT_BEGIN_TIME" property="laborContractBeginTime" jdbcType="DATE"/>
    <result column="LABOR_CONTRACT_END_TIME" property="laborContractEndTime" jdbcType="DATE"/>
  </resultMap>
  <resultMap id="BaseResultMapEx" extends="BaseResultMap" type="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">
    <result column="project_name" property="projectName" jdbcType="VARCHAR"/>
    <result column="contract_no" property="contractno" jdbcType="VARCHAR"/>
    <result column="department_name" property="departmentName" jdbcType="VARCHAR"/>
  </resultMap>
  <resultMap id="BaseResultMapExNoContractno" extends="BaseResultMap" type="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">
    <result column="GRADE_NAME" property="gradename" jdbcType="VARCHAR"/>
    <result column="department_name" property="departmentName" jdbcType="VARCHAR"/>
  </resultMap>
  <resultMap id="ResultMapForOther" type="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">
    <result column="EMPLOYEE_ID" property="employeeId" jdbcType="VARCHAR"/>
    <result column="EMPLOYEE_NAME" property="employeeName" jdbcType="VARCHAR"/>
    <result column="EMPLOYEE_GRADE" property="employeeGrade" jdbcType="CHAR"/>
    <result column="MOBILE" property="mobile" jdbcType="CHAR"/>
    <result column="EMAIL" property="email" jdbcType="VARCHAR"/>
  </resultMap>
  <resultMap id="ResultMapForTask" type="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">
    <result column="taskCounts" property="taskCounts" jdbcType="INTEGER"/>
    <result column="IMAGE_ID" property="imageId" jdbcType="VARCHAR"/>
    <result column="EMPLOYEE_NAME" property="employeeName" jdbcType="VARCHAR"/>
    <result column="EMPLOYEE_GRADE" property="employeeGrade" jdbcType="CHAR"/>
    <result column="EMPLOYEE_ID" property="employeeId" jdbcType="VARCHAR"/>
  </resultMap>
  <resultMap id="ResultMapExt" extends="BaseResultMap" type="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">
    <association property="departmentInfo" select="tbl_department_info.selectByDepartmentId" column="DEPARTMENT_ID"/>
    <association property="grade" select="tbl_employee_grade.selectByGradeId" column="EMPLOYEE_DUTY"/>
    <association property="company" select="tbl_company.selectByCompanyId" column="BEYOND_COMPANY"/>
    <result column="LEAVE_CODE" property="leaveCode" jdbcType="VARCHAR"/>
    <result column="LEAVE_POST_TIME" property="leavePostTime" jdbcType="DATE"/>
    <result column="LEAVE_POST_REASON" property="leavePostReason" jdbcType="VARCHAR"/>
  </resultMap>
  <resultMap id="BaseResultMapOfEntryTimes" extends="ResultMapExt" type="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">
    <result column="entry_times" property="entryTimes" jdbcType="VARCHAR"/>
  </resultMap>
  <resultMap id="ResultMapExtProject" extends="BaseResultMap" type="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">
    <association property="departmentInfo" select="tbl_department_info.selectByDepartmentId" column="DEPARTMENT_ID"/>
    <association property="grade" select="tbl_employee_grade.selectByGradeId" column="EMPLOYEE_DUTY"/>
    <association property="company" select="tbl_company.selectByCompanyId" column="BEYOND_COMPANY"/>
    <result column="short_project_name" property="shortProjectName" jdbcType="VARCHAR"/>
  </resultMap>
  <resultMap id="ResultMapForThree" type="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">
    <result column="EMPLOYEE_ID" property="employeeId" jdbcType="VARCHAR"/>
    <result column="taskCount" property="taskCount" jdbcType="INTEGER"/>
  </resultMap>
  <sql id="employee_Where_Clause"> 
    <if test="employeeName != null and employeeName != ''">and tbl_employee_info.EMPLOYEE_NAME like concat('%', #{employeeName:VARCHAR}, '%')</if>  
    <if test="employeeId != null and employeeId != ''">and tbl_employee_info.EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  
    <if test="departmentId != null and departmentId != ''">and tbl_employee_info.DEPARTMENT_ID = #{departmentId:VARCHAR}</if>  
    <if test="beyondCompany != null and beyondCompany != ''">and tbl_employee_info.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
    <if test="email != null and email != ''">and tbl_employee_info.EMAIL = #{email:VARCHAR}</if>  
    <if test="employeeGrade != null and employeeGrade != ''">and tbl_employee_info.EMPLOYEE_GRADE = #{employeeGrade:CHAR}</if>  
    <if test="isOnDuty != null and isOnDuty != ''">and tbl_employee_info.IS_ON_DUTY = #{isOnDuty:CHAR}</if>  
    <if test="grassLevelId != null and grassLevelId != ''">and tbl_employee_info.GRASS_LEVEL_ID = #{grassLevelId:VARCHAR}</if>  
    <if test="properties.projectId != null and properties.projectId != ''">and tbl_employee_info.EMPLOYEE_ID NOT IN ( SELECT tc.employee_id from tbl_project_etc tc where tc.contract_no = #{properties.projectId:VARCHAR} )</if> 
  </sql>
  <sql id="Criteria_Where_Clause"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Wed Jul 01 11:44:57 CST 2015.
        -->  
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate"> 
      <if test="oredCriteria[].valid!= null and oredCriteria[].valid == 'true'.toString()">( 
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and">$oredCriteria[].criteriaWithoutValue[]$</iterate>  
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and">$oredCriteria[].criteriaWithSingleValue[].condition$ #{oredCriteria[].criteriaWithSingleValue[].value}</iterate>  
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and">$oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction=",">#{oredCriteria[].criteriaWithListValue[].values[]}</iterate> 
        </iterate>  
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and">$oredCriteria[].criteriaWithBetweenValue[].condition$ #{oredCriteria[].criteriaWithBetweenValue[].values[0]} and #{oredCriteria[].criteriaWithBetweenValue[].values[1]}</iterate> )
      </if> 
    </iterate> 
  </sql>
  <!--查询所有可审核人的关键信息（按照已经审核的任务数量排序）-->
  <select id="selectVerifiableTask" resultMap="EmployeeVerifyTask" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT e.EMPLOYEE_NAME, e.EMPLOYEE_GRADE, e.IMAGE_ID, f.project_name, sum( CASE WHEN (d.STATUS = '2' or d.status='3') THEN 1 ELSE 0 END ) AS A, sum( CASE WHEN d.STATUS = '3' THEN 1 ELSE 0 END ) AS B FROM tbl_task_target d, tbl_employee_info e, tbl_project_info f WHERE e.EMPLOYEE_ID = d.VERIFY_ID AND d.CONTRACT_NO=f.contract_no AND ( d.STATUS = '3' OR d.STATUS = '2' )
    <if test="properties.queryDate != null and properties.queryDate != ''">date_format(d.BEGIN_TIME,'%Y-%m-%d')= #{properties.queryDate:VARCHAR}</if>  
    <if test="properties.queryDate != null and properties.queryDate != ''">date_format(d.END_TIME,'%Y-%m-%d')= #{properties.queryDate:VARCHAR}</if> -- AND -- date_format(d.BEGIN_TIME,'%Y-%m-%d')= '2017-10-10' AND date_format(d.END_TIME,'%Y-%m-%d')= -- '2017-10-10' GROUP by d.VERIFY_ID order by B DESC
  </select>
  <select id="selectVerifiableTaskPercent" resultMap="EmployeeVerifyTaskPercent" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT e.EMPLOYEE_NAME, e.EMPLOYEE_GRADE, e.IMAGE_ID, f.project_name, sum( CASE WHEN (d.STATUS = '2' or d.status='3') THEN 1 ELSE 0 END ) AS A, sum( CASE WHEN d.STATUS = '3' THEN 1 ELSE 0 END ) AS B, cast( sum( CASE WHEN ( d. STATUS = '3') THEN 1 ELSE 0 END )*100./sum( CASE WHEN d. STATUS = '3' OR d. STATUS = '2' THEN 1 ELSE 0 END ) as decimal(18,0)) as C FROM tbl_task_target d, tbl_employee_info e, tbl_project_info f WHERE e.EMPLOYEE_ID = d.VERIFY_ID AND d.CONTRACT_NO=f.contract_no AND ( d.STATUS = '3' OR d.STATUS = '2' )
    <if test="properties.queryDate != null and properties.queryDate != ''">date_format(d.BEGIN_TIME,'%Y-%m-%d')= #{properties.queryDate:VARCHAR}</if>  
    <if test="properties.queryDate != null and properties.queryDate != ''">date_format(d.END_TIME,'%Y-%m-%d')= #{properties.queryDate:VARCHAR}</if> -- AND -- date_format(d.BEGIN_TIME,'%Y-%m-%d')= '2017-10-10' AND date_format(d.END_TIME,'%Y-%m-%d')= -- '2017-10-10' GROUP by d.VERIFY_ID order by C DESC
  </select>
  <!-- 查询所有的员工 -->
  <select id="selectAllEmployee" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select count(*) from tbl_employee_info emp, tbl_project_etc etc , tbl_project_info pro , tbl_department_info dep where emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id and emp.IS_ON_DUTY ='01' and etc.is_leave='00'
    <if test="employeeName != null and employeeName != ''">and emp.EMPLOYEE_NAME like concat('%', #{employeeName:VARCHAR}, '%')</if>  
    <if test="employeeId != null and employeeId != ''">and emp.EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  
    <if test="departmentId != null and departmentId != ''">and emp.DEPARTMENT_ID = #{departmentId:VARCHAR}</if>  
    <if test="beyondCompany != null and beyondCompany != ''">and emp.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
    <if test="employeeGrade != null and employeeGrade != ''">and emp.EMPLOYEE_GRADE = #{employeeGrade:CHAR}</if>  
    <if test="grassLevelId != null and grassLevelId != ''">and emp.GRASS_LEVEL_ID = #{grassLevelId:VARCHAR}</if>  
    <if test="properties.projectId != null and properties.projectId != ''">and emp.EMPLOYEE_ID NOT IN ( SELECT tc.employee_id from tbl_project_etc tc where tc.contract_no = #{properties.projectId:VARCHAR} )</if>  
    <if test="properties.area != null and properties.area != ''">and dep.area = #{properties.area:VARCHAR}</if> 
  </select>
  <!-- 查询部门员工的数量 -->
  <select id="getEmployeeByDepartmentId" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select count(*) from tbl_employee_info where 1=1 and IS_ON_DUTY ='01'
    <trim prefix=" AND DEPARTMENT_ID IN "> 
      <if test="properties != null"> 
        <if test="properties.departmentIdList != null"> 
          <iterate property="properties.departmentIdList" open="(" close=")" conjunction=",">#{properties.departmentIdList[]}</iterate> 
        </if> 
      </if> 
    </trim> 
  </select>
  <!-- 根据员工ID集合查询对应员工信息 -->
  <select id="getEmployeeInfoByemployeeId" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select * from tbl_employee_info where 1=1 and IS_ON_DUTY ='01'
    <trim prefix=" AND EMPLOYEE_ID IN "> 
      <if test="properties != null"> 
        <if test="properties.employeeIdList != null"> 
          <iterate property="properties.employeeIdList" open="(" close=")" conjunction=",">#{properties.employeeIdList[]}</iterate> 
        </if> 
      </if> 
    </trim> 
  </select>
  <!-- 查询没有任务的员工的数量 -->
  <select id="getNoTaskEmployeeInfosCount" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select count(*) from tbl_employee_info emp, tbl_project_etc etc , tbl_project_info pro , tbl_department_info dep where emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id and emp.IS_ON_DUTY ='01' and etc.is_leave='00'
    <if test="employeeName != null">and emp.employee_name like concat('%', #{employeeName:VARCHAR}, '%')</if>  
    <if test="beyondCompany != null">and emp.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
    <if test="contractno != null">and pro.contract_no = #{contractno:VARCHAR}</if>  
    <if test="departmentId != null">and emp.department_id = #{departmentId:VARCHAR}</if>  
    <if test="properties.area != null">and dep.area = #{properties.area:VARCHAR}</if> and not EXISTS( SELECT distinct task.employee_id FROM tbl_task_target task WHERE emp.employee_id = task.employee_id and date_format( task.create_time,'%Y-%m-%d')=#{properties.signTime:VARCHAR} and emp.beyond_company =#{beyondCompany:VARCHAR} and task.TASK_TYPE='2')
    <if test="properties.signTime != null">
      <!-- <![CDATA[
                  date_format(pro.plan_end_date,'%Y-%m-%d')>= #{properties.signTime:VARCHAR}
             ]]> --> and
    </if> 
  </select>
  <!-- 查询没有任务的员工 -->
  <select id="getNoTaskEmployeeInfos" resultMap="BaseResultMapEx" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select pro.project_name ,pro.contract_no, emp.*, dep.department_name from tbl_employee_info emp, tbl_project_etc etc , tbl_project_info pro , tbl_department_info dep where emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id and emp.IS_ON_DUTY ='01' and etc.is_leave='00'
    <if test="employeeName != null">and emp.employee_name like concat('%', #{employeeName:VARCHAR}, '%')</if>  
    <if test="beyondCompany != null">and emp.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
    <if test="contractno != null">and pro.contract_no = #{contractno:VARCHAR}</if>  
    <if test="departmentId != null">and emp.department_id = #{departmentId:VARCHAR}</if>  
    <if test="properties.area != null">and dep.area = #{properties.area:VARCHAR}</if> and not EXISTS( SELECT distinct task.employee_id FROM tbl_task_target task WHERE emp.employee_id = task.employee_id and date_format( task.create_time,'%Y-%m-%d')=#{properties.signTime:VARCHAR} and emp.beyond_company =#{beyondCompany:VARCHAR} and task.TASK_TYPE='2')
    <if test="properties.signTime != null">
      <!-- <![CDATA[
                  date_format(pro.plan_end_date,'%Y-%m-%d')>= #{properties.signTime:VARCHAR}
             ]]> --> and
    </if> 
  </select>
  <!-- 查询没有签到的人的数量 -->
  <select id="getNoSignEmployeeInfosCount" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select count(*) from tbl_employee_info emp, tbl_project_etc etc , tbl_project_info pro , tbl_department_info dep where emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id and emp.IS_ON_DUTY ='01' and etc.is_leave='00'
    <if test="employeeName != null">and emp.employee_name like concat('%', #{employeeName:VARCHAR}, '%')</if>  
    <if test="beyondCompany != null">and emp.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
    <if test="contractno != null">and pro.contract_no = #{contractno:VARCHAR}</if>  
    <if test="departmentId != null">and emp.department_id = #{departmentId:VARCHAR}</if> and not EXISTS( SELECT 'X' FROM tbl_sign_in_out_record sig WHERE emp.employee_id = sig.employee_id and emp.beyond_company =#{beyondCompany:VARCHAR} and sig.sign_time=#{properties.signTime:VARCHAR})
    <if test="properties.signTime != null">
      <!--  <![CDATA[
                   date_format(pro.plan_end_date,'%Y-%m-%d')>= #{properties.signTime:VARCHAR}
              ]]> --> and
    </if>  
    <if test="properties.area != null and properties.area != ''">and dep.area = #{properties.area:VARCHAR}</if> 
  </select>
  <!-- 查询未签退人的数量  2016年3月1日  liyazhou 监控首页数据Count-->
  <select id="getNoSignEmployeeOutfosCount" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select count(*) from tbl_employee_info emp, tbl_project_etc etc , tbl_project_info pro , tbl_department_info dep where emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id and emp.IS_ON_DUTY ='01' and etc.is_leave='00'
    <if test="employeeName != null">and emp.employee_name like concat('%', #{employeeName:VARCHAR}, '%')</if>  
    <if test="beyondCompany != null">and emp.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
    <if test="contractno != null">and pro.contract_no = #{contractno:VARCHAR}</if>  
    <if test="departmentId != null">and emp.department_id = #{departmentId:VARCHAR}</if>  
    <if test="properties.area != null">and dep.area = #{properties.area:VARCHAR}</if> and EXISTS( SELECT 'X' FROM tbl_sign_in_out_record sig WHERE emp.employee_id = sig.employee_id and emp.beyond_company =#{beyondCompany:VARCHAR}
    <if test="properties.signTime != null">and date_format( sig.sign_time,'%Y-%m-%d') = #{properties.signTime:VARCHAR} and date_format(sig.sign_in_time,'%Y-%m-%d') = #{properties.signTime:VARCHAR} and sig.sign_out_time is not null</if> ) 
    <if test="properties.signTime != null">and date_format(pro.plan_end_date,'%Y-%m-%d')&gt;= #{properties.signTime:VARCHAR}</if> 
  </select>
  <!-- 查询未签退人 2016年3月1日  liyazhou   监控首页数据-集合数据-->
  <select id="getNoSignEmployeeOutfos" resultMap="BaseResultMapEx" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select pro.project_name ,pro.contract_no, emp.* , dep.department_name from tbl_employee_info emp, tbl_project_etc etc , tbl_project_info pro , tbl_department_info dep where emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id and emp.IS_ON_DUTY ='01' and etc.is_leave='00'
    <if test="employeeName != null">and emp.employee_name like concat('%', #{employeeName:VARCHAR}, '%')</if>  
    <if test="beyondCompany != null">and emp.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
    <if test="contractno != null">and pro.contract_no = #{contractno:VARCHAR}</if>  
    <if test="departmentId != null">and emp.department_id = #{departmentId:VARCHAR}</if>  
    <if test="properties.area != null">and dep.area = #{properties.area:VARCHAR}</if> and EXISTS( SELECT 'X' FROM tbl_sign_in_out_record sig WHERE emp.employee_id = sig.employee_id and emp.beyond_company =#{beyondCompany:VARCHAR}
    <if test="properties.signTime != null">and date_format( sig.sign_time,'%Y-%m-%d') = #{properties.signTime:VARCHAR} and date_format(sig.sign_in_time,'%Y-%m-%d') = #{properties.signTime:VARCHAR} and sig.sign_out_time is not null</if> ) 
    <if test="properties.signTime != null">and date_format(pro.plan_end_date,'%Y-%m-%d')&gt;= #{properties.signTime:VARCHAR}</if> 
  </select>
  <!--查询所有员工  -->
  <select id="selectAllEmployeeInfo" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select * from tbl_employee_info where <![CDATA[
   			  CONVERT(EMPLOYEE_GRADE,SIGNED) <= CONVERT(#{employeeGrade:CHAR},SIGNED)
   		  ]]> and BEYOND_COMPANY = #{beyondCompany:VARCHAR} and IS_ON_DUTY ='01'</select>
  <!--根据部门查询所有员工  -->
  <select id="getEmployeeInfbyDepartID" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select * from tbl_employee_info where DEPARTMENT_ID =#{departmentId:VARCHAR} <![CDATA[
   			  and CONVERT(EMPLOYEE_GRADE,SIGNED) <= CONVERT(#{employeeGrade:CHAR},SIGNED)
   		  ]]> and IS_ON_DUTY ='01'</select>
  <!-- 查询没有签到的人的信息-->
  <select id="getNoSignEmployeeInfos" resultMap="BaseResultMapEx" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select pro.project_name ,pro.contract_no, emp.* , dep.department_name from tbl_employee_info emp, tbl_project_etc etc , tbl_project_info pro , tbl_department_info dep where emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id and emp.IS_ON_DUTY ='01' and etc.is_leave='00'
    <if test="employeeName != null">and emp.employee_name like concat('%', #{employeeName:VARCHAR}, '%')</if>  
    <if test="beyondCompany != null">and emp.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
    <if test="contractno != null">and pro.contract_no = #{contractno:VARCHAR}</if>  
    <if test="departmentId != null">and emp.department_id = #{departmentId:VARCHAR}</if> and not EXISTS( SELECT 'X' FROM tbl_sign_in_out_record sig WHERE emp.employee_id = sig.employee_id and emp.beyond_company =#{beyondCompany:VARCHAR} and sig.sign_time=#{properties.signTime:VARCHAR})
    <if test="properties.signTime != null">
      <!--  <![CDATA[
                   date_format(pro.plan_end_date,'%Y-%m-%d')>= #{properties.signTime:VARCHAR}
              ]]> --> and
    </if>  
    <if test="properties.area != null and properties.area != ''">and dep.area = #{properties.area:VARCHAR}</if> 
  </select>
  <select id="getEmployeeInfosCount" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select count(*) from tbl_employee_info emp, tbl_project_etc etc , tbl_project_info pro ,tbl_department_info dept where emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and etc.is_leave='00' and emp.employee_name like concat('%', #{employeeName:VARCHAR}, '%') and emp.DEPARTMENT_ID = dept.DEPARTMENT_ID
    <if test="properties.planEndDate != null">and date_format(pro.plan_end_date,'%Y-%m-%d')&gt;= #{properties.planEndDate:VARCHAR}</if>  
    <if test="properties.area != null">and dept.AREA = #{properties.area:VARCHAR}</if>  
    <if test="properties.companyid != null">and emp.BEYOND_COMPANY = #{properties.companyid:VARCHAR}</if> 
  </select>
  <select id="getEmployeeInfos" resultMap="BaseResultMapEx" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select pro.project_name ,pro.contract_no, emp.* , dep.department_name from tbl_employee_info emp, tbl_project_etc etc , tbl_project_info pro , tbl_department_info dep where emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and etc.is_leave='00' and dep.department_id = emp.department_id and emp.employee_name like concat('%', #{employeeName:VARCHAR}, '%')
    <if test="properties.planEndDate != null">and date_format(pro.plan_end_date,'%Y-%m-%d')&gt;= #{properties.planEndDate:VARCHAR}</if>  
    <if test="properties.area != null">and dep.AREA = #{properties.area:VARCHAR}</if>  
    <if test="properties.companyid != null">and emp.BEYOND_COMPANY = #{properties.companyid:VARCHAR}</if> 
  </select>
  <select id="selectByCriteria" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfoCriteria"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Wed Jul 01 11:44:57 CST 2015.
        --> select * from tbl_employee_info
    <if test="_parameter != null"> 
      <include refid="tbl_employee_info.Criteria_Where_Clause"/>  
      <if test="orderByClause != null">order by ${orderByClause}</if> 
    </if> 
  </select>
  <select id="selectByPrimaryKey" resultMap="BaseResultMapOfEntryTimes" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Wed Jul 01 11:44:57 CST 2015.
        --> select * from tbl_employee_info where EMPLOYEE_ID = #{employeeId:VARCHAR}
  </select>
  <!--<select id="getEquipmentById" parameterType="com.i2shopping.i2work.operation.core.employee.model.EquipmentRecord"-->
  <!--resultMap="equipmentRecordMap">-->
  <!--select * from tbl_equipment_record where EMPLOYEE_ID = #{employeeId:VARCHAR}-->
  <!--</select>-->
  <!--<select id="selectEquipInfo" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeEquInfo"-->
  <!--resultMap="employeeEquInfoMap">-->
  <!--SELECT-->
  <!--a.EMPLOYEE_ID,-->
  <!--a.IS_RETURN,-->
  <!--a.IS_ACEPT,-->
  <!--a.IS_CHANGE,-->
  <!--a.EQUIPMENT_TIME,-->
  <!--a.RETURN_TIME,-->
  <!--a.ACCEPT_USER,-->
  <!--a.CHANGE_TIME,-->
  <!--a.CHANGE_SERIAL,-->
  <!--b.*,-->
  <!--c.IMAGE_ID,-->
  <!--c.EMPLOYEE_NAME,-->
  <!--c.actual_employee_id,-->
  <!--c.IS_ON_DUTY-->
  <!--FROM-->
  <!--tbl_equipment_record a,-->
  <!--tbl_equipment_info b,-->
  <!--tbl_employee_info c-->
  <!--WHERE-->
  <!--a.EQUIPMENT_ID = b.EQUIPMENT_ID AND a.EMPLOYEE_ID = c.EMPLOYEE_ID-->
  <!--AND a.EMPLOYEE_ID = ANY ( SELECT EMPLOYEE_ID FROM tbl_employee_info WHERE-->
  <!--IS_ON_DUTY = #{isOnDuty:VARCHAR}-->
  <!--<isNotNull prepend="AND" property="employeeName">-->
  <!--EMPLOYEE_NAME = #{employeeName:VARCHAR}-->
  <!--</isNotNull>-->
  <!--)-->
  <!--<isNotNull prepend="AND" property="isReturn">-->
  <!--a.IS_RETURN = #{isReturn:VARCHAR}-->
  <!--</isNotNull>-->
  <!--<isNull prepend="AND" property="isReturn">-->
  <!--a.IS_RETURN = '0'-->
  <!--</isNull>-->
  <!--<isNotNull prepend="AND" property="isChange">-->
  <!--a.IS_CHANGE = #{isChange:VARCHAR}-->
  <!--</isNotNull>-->
  <!--<isNotNull prepend="AND" property="isAcept">-->
  <!--a.IS_ACEPT = #{isAcept:VARCHAR}-->
  <!--</isNotNull>-->
  <!--<isNull prepend="AND" property="isAcept">-->
  <!--a.IS_ACEPT = '1'-->
  <!--</isNull>-->
  <!--<isNotNull prepend="AND" property="equipmentSerial">-->
  <!--b.EQUIPMENT_SERIAL = #{equipmentSerial:VARCHAR}-->
  <!--</isNotNull>-->
  <!--</select>-->
  <!--<select id="selectEquipmentByID" parameterType="java.lang.String" resultMap="equipmentRecordMap">-->
  <!--select * from tbl_equipment_record where EMPLOYEE_ID = #{employeeId:VARCHAR}-->
  <!--</select>-->
  <!--<select id="getEquipmentInfoById" parameterType="com.i2shopping.i2work.operation.core.employee.model.EquipmentInfo"-->
  <!--resultMap="equipmentInfoMap">-->
  <!--select * from tbl_equipment_info where EQUIPMENT_ID = #{equipmentId:VARCHAR}-->
  <!--</select>-->
  <delete id="deleteByPrimaryKey" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Mon Jun 22 00:14:12 CST 2015.
        --> delete from tbl_employee_info where EMPLOYEE_ID = #{employeeId:VARCHAR}
  </delete>
  <delete id="deleteByCriteria" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfoCriteria"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Mon Jun 22 00:14:12 CST 2015.
        --> delete from tbl_employee_info 
    <include refid="tbl_employee_info.Criteria_Where_Clause"/> 
  </delete>
  <insert id="insert" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Wed Jul 01 11:44:57 CST 2015.
        --> insert into tbl_employee_info (EMPLOYEE_ID, EMPLOYEE_NAME, EMPLOYEE_GRADE, EMAIL, MOBILE, CARDID, EMPLOYEE_DUTY, DEPARTMENT_ID, IS_ON_DUTY, INTEGRATION, STOCK, LEVEL, IMAGE_ID, BOARDING_TIME, EMPLOYEE_ADRESS, SEX, EMPLOYEE_NATION, BIRTH_TIME, WORK_LIFE, DEGREE, LEAVE_TIME, HUKOU, HUKOU_TYPE, MARRIED_STATUS, POLITICS_STATUS, EDUCATION_BACKGROUND, GRADUTED_SCHOOL, MAJOR, GRADUTED_TIME, BEGIN_WORK_TIME, LABOR_CONTRACT_BEGIN_TIME, LABOR_CONTRACT_END_TIME, Expected_positive_time, actual_positive_time, household_address, Employment_way, LEAVE_REASON,BEYOND_COMPANY,GRASS_LEVEL_ID,IS_FIXED_PLACE_WORKING,actual_employee_id,is_check_imsi,entry_times) values (#{employeeId:VARCHAR}, #{employeeName:VARCHAR}, #{employeeGrade:CHAR}, #{email:VARCHAR}, #{mobile:CHAR}, #{cardid:VARCHAR}, #{employeeDuty:VARCHAR}, #{departmentId:CHAR}, #{isOnDuty:CHAR}, #{integration:INTEGER}, #{stock:INTEGER}, #{level:INTEGER}, #{imageId:VARCHAR}, #{boardingTime:DATE}, #{employeeAdress:VARCHAR}, #{sex:CHAR}, #{employeeNation:VARCHAR}, #{birthTime:DATE}, #{workLife:DECIMAL}, #{degree:VARCHAR}, #{leaveTime:DATE}, #{hukou:VARCHAR}, #{hukouType:CHAR}, #{marriedStatus:CHAR}, #{politicsStatus:CHAR}, #{educationBackground:CHAR}, #{gradutedSchool:VARCHAR}, #{major:VARCHAR}, #{gradutedTime:DATE}, #{beginWorkTime:DATE}, #{laborContractBeginTime:DATE}, #{laborContractEndTime:DATE}, #{expectedPositiveTime:DATE}, #{actualPositiveTime:DATE}, #{householdAddress:VARCHAR}, #{employmentWay:VARCHAR}, #{leaveReason:VARCHAR},#{beyondCompany:VARCHAR}, #{grassLevelId:VARCHAR},#{isFixedPlaceWorking:CHAR},#{actualEmployeeId:VARCHAR},#{isCheckImsi:CHAR},#{entryTimes:varchar })
  </insert>
  <!--<insert id="insertEquipmentInfo" parameterType="com.i2shopping.i2work.operation.core.employee.model.EquipmentInfo">-->
  <!--insert into tbl_equipment_info (EQUIPMENT_ID, EQUIPMENT_TYPE, EQUIPMENT_COL, EQUIPMENT_SIZE, EQUIPMENT_SERIAL)-->
  <!--values (#{equipmentId:VARCHAR}, #{equipmentType:VARCHAR}, #{equipmentCol:VARCHAR}, #{equipmentSize:VARCHAR}, #{equipmentSerial:VARCHAR})-->
  <!--</insert>-->
  <!--<insert id="insertEquipmentRecord" parameterType="com.i2shopping.i2work.operation.core.employee.model.EquipmentRecord">-->
  <!--insert into tbl_equipment_record (EMPLOYEE_ID, EQUIPMENT_ID, SERIAL_NUMBER, IS_ACEPT, IS_CHANGE, IS_RETURN, EQUIPMENT_TIME)-->
  <!--values (#{employeeId:VARCHAR}, #{equipmentId:VARCHAR}, #{serialNumber:VARCHAR}, #{isAcept:VARCHAR}, #{isChange:VARCHAR}, #{isReturn:VARCHAR}, #{equipmentTime:VARCHAR})-->
  <!--</insert>-->
  <insert id="insertSelective" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Wed Jul 01 11:44:57 CST 2015.
        --> insert into tbl_employee_info 
    <trim prefix="("> 
      <if test="employeeId != null">EMPLOYEE_ID ,</if>  
      <if test="employeeName != null">EMPLOYEE_NAME ,</if>  
      <if test="employeeGrade != null">EMPLOYEE_GRADE ,</if>  
      <if test="email != null">EMAIL ,</if>  
      <if test="mobile != null">MOBILE ,</if>  
      <if test="cardid != null">CARDID ,</if>  
      <if test="employeeDuty != null">EMPLOYEE_DUTY ,</if>  
      <if test="departmentId != null">DEPARTMENT_ID ,</if>  
      <if test="isOnDuty != null">IS_ON_DUTY ,</if>  
      <if test="integration != null">INTEGRATION ,</if>  
      <if test="stock != null">STOCK ,</if>  
      <if test="level != null">LEVEL ,</if>  
      <if test="imageId != null">IMAGE_ID ,</if>  
      <if test="boardingTime != null">BOARDING_TIME ,</if>  
      <if test="employeeAdress != null">EMPLOYEE_ADRESS ,</if>  
      <if test="sex != null">SEX ,</if>  
      <if test="employeeNation != null">EMPLOYEE_NATION ,</if>  
      <if test="birthTime != null">BIRTH_TIME ,</if>  
      <if test="workLife != null">WORK_LIFE ,</if>  
      <if test="degree != null">DEGREE ,</if>  
      <if test="leaveTime != null">LEAVE_TIME ,</if>  
      <if test="hukou != null">HUKOU ,</if>  
      <if test="hukouType != null">HUKOU_TYPE ,</if>  
      <if test="marriedStatus != null">MARRIED_STATUS ,</if>  
      <if test="politicsStatus != null">POLITICS_STATUS ,</if>  
      <if test="educationBackground != null">EDUCATION_BACKGROUND ,</if>  
      <if test="gradutedSchool != null">GRADUTED_SCHOOL ,</if>  
      <if test="major != null">MAJOR ,</if>  
      <if test="gradutedTime != null">GRADUTED_TIME ,</if>  
      <if test="beginWorkTime != null">BEGIN_WORK_TIME ,</if>  
      <if test="laborContractBeginTime != null">LABOR_CONTRACT_BEGIN_TIME ,</if>  
      <if test="expectedPositiveTime != null">Expected_positive_time ,</if>  
      <if test="actualPositiveTime != null">actual_positive_time ,</if>  
      <if test="householdAddress != null">household_address ,</if>  
      <if test="employmentWay != null">Employment_way ,</if>  
      <if test="leaveReason != null">LEAVE_REASON ,</if>  
      <if test="beyondCompany != null">BEYOND_COMPANY ,</if>  
      <if test="grassLevelId != null">GRASS_LEVEL_ID ,</if>  
      <if test="isFixedPlaceWorking != null">IS_FIXED_PLACE_WORKING ,</if>  
      <if test="actualEmployeeId != null">actual_employee_id ,</if>  
      <if test="isCheckImsi != null">is_check_imsi ,</if>  
      <if test="entryTimes != null">entry_times ,</if> )
    </trim> values 
    <trim prefix="("> 
      <if test="employeeId != null">#{employeeId:VARCHAR} ,</if>  
      <if test="employeeName != null">#{employeeName:VARCHAR} ,</if>  
      <if test="employeeGrade != null">#{employeeGrade:CHAR} ,</if>  
      <if test="email != null">#{email:VARCHAR} ,</if>  
      <if test="mobile != null">#{mobile:CHAR} ,</if>  
      <if test="cardid != null">#{cardid:VARCHAR} ,</if>  
      <if test="employeeDuty != null">#{employeeDuty:VARCHAR} ,</if>  
      <if test="departmentId != null">#{departmentId:CHAR} ,</if>  
      <if test="isOnDuty != null">#{isOnDuty:CHAR} ,</if>  
      <if test="integration != null">#{integration:INTEGER} ,</if>  
      <if test="stock != null">#{stock:INTEGER} ,</if>  
      <if test="level != null">#{level:INTEGER} ,</if>  
      <if test="imageId != null">#{imageId:VARCHAR} ,</if>  
      <if test="boardingTime != null">#{boardingTime:DATE} ,</if>  
      <if test="employeeAdress != null">#{employeeAdress:VARCHAR} ,</if>  
      <if test="sex != null">#{sex:CHAR} ,</if>  
      <if test="employeeNation != null">#{employeeNation:VARCHAR} ,</if>  
      <if test="birthTime != null">#{birthTime:DATE} ,</if>  
      <if test="workLife != null">#{workLife:DECIMAL} ,</if>  
      <if test="degree != null">#{degree:VARCHAR} ,</if>  
      <if test="leaveTime != null">#{leaveTime:DATE} ,</if>  
      <if test="hukou != null">#{hukou:VARCHAR} ,</if>  
      <if test="hukouType != null">#{hukouType:CHAR} ,</if>  
      <if test="marriedStatus != null">#{marriedStatus:CHAR} ,</if>  
      <if test="politicsStatus != null">#{politicsStatus:CHAR} ,</if>  
      <if test="educationBackground != null">#{educationBackground:CHAR} ,</if>  
      <if test="gradutedSchool != null">#{gradutedSchool:VARCHAR} ,</if>  
      <if test="major != null">#{major:VARCHAR} ,</if>  
      <if test="gradutedTime != null">#{gradutedTime:DATE} ,</if>  
      <if test="beginWorkTime != null">#{beginWorkTime:DATE} ,</if>  
      <if test="laborContractBeginTime != null">#{laborContractBeginTime:DATE} ,</if>  
      <if test="expectedPositiveTime != null">#{expectedPositiveTime:DATE} ,</if>  
      <if test="actualPositiveTime != null">#{actualPositiveTime:DATE} ,</if>  
      <if test="householdAddress != null">#{householdAddress:VARCHAR} ,</if>  
      <if test="employmentWay != null">#{employmentWay:VARCHAR} ,</if>  
      <if test="leaveReason != null">#{leaveReason:VARCHAR} ,</if>  
      <if test="beyondCompany != null">#{beyondCompany:VARCHAR} ,</if>  
      <if test="grassLevelId != null">#{grassLevelId:VARCHAR} ,</if>  
      <if test="isFixedPlaceWorking != null">#{isFixedPlaceWorking:CHAR} ,</if>  
      <if test="actualEmployeeId != null">#{actualEmployeeId:VARCHAR} ,</if>  
      <if test="isCheckImsi != null">#{isCheckImsi:CHAR} ,</if>  
      <if test="entryTimes != null">#{entryTimes:VARCHAR} ,</if> )
    </trim> 
  </insert>
  <select id="countByCriteria" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfoCriteria" resultType="java.lang.Integer"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Mon Jun 22 00:14:12 CST 2015.
        --> select count(*) from tbl_employee_info 
    <include refid="tbl_employee_info.Criteria_Where_Clause"/> 
  </select>
  <update id="updateByCriteriaSelective"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Wed Jul 01 11:44:57 CST 2015.
        --> update tbl_employee_info 
    <trim prefix="set"> 
      <if test="record.employeeId != null">EMPLOYEE_ID = #{record.employeeId:VARCHAR} ,</if>  
      <if test="record.employeeName != null">EMPLOYEE_NAME = #{record.employeeName:VARCHAR} ,</if>  
      <if test="record.employeeGrade != null">EMPLOYEE_GRADE = #{record.employeeGrade:CHAR} ,</if>  
      <if test="record.email != null">EMAIL = #{record.email:VARCHAR} ,</if>  
      <if test="record.mobile != null">MOBILE = #{record.mobile:CHAR} ,</if>  
      <if test="record.cardid != null">CARDID = #{record.cardid:VARCHAR} ,</if>  
      <if test="record.employeeDuty != null">EMPLOYEE_DUTY = #{record.employeeDuty:VARCHAR} ,</if>  
      <if test="record.departmentId != null">DEPARTMENT_ID = #{record.departmentId:CHAR} ,</if>  
      <if test="record.isOnDuty != null">IS_ON_DUTY = #{record.isOnDuty:CHAR} ,</if>  
      <if test="record.integration != null">INTEGRATION = #{record.integration:INTEGER} ,</if>  
      <if test="record.stock != null">STOCK = #{record.stock:INTEGER} ,</if>  
      <if test="record.level != null">LEVEL = #{record.level:INTEGER} ,</if>  
      <if test="record.imageId != null">IMAGE_ID = #{record.imageId:VARCHAR} ,</if>  
      <if test="record.boardingTime != null">BOARDING_TIME = #{record.boardingTime:DATE} ,</if>  
      <if test="record.employeeAdress != null">EMPLOYEE_ADRESS = #{record.employeeAdress:VARCHAR} ,</if>  
      <if test="record.sex != null">SEX = #{record.sex:CHAR} ,</if>  
      <if test="record.employeeNation != null">EMPLOYEE_NATION = #{record.employeeNation:VARCHAR} ,</if>  
      <if test="record.birthTime != null">BIRTH_TIME = #{record.birthTime:DATE} ,</if>  
      <if test="record.workLife != null">WORK_LIFE = #{record.workLife:DECIMAL} ,</if>  
      <if test="record.degree != null">DEGREE = #{record.degree:VARCHAR} ,</if>  
      <if test="record.leaveTime != null">LEAVE_TIME = #{record.leaveTime:DATE} ,</if>  
      <if test="record.hukou != null">HUKOU = #{record.hukou:VARCHAR} ,</if>  
      <if test="record.hukouType != null">HUKOU_TYPE = #{record.hukouType:CHAR} ,</if>  
      <if test="record.marriedStatus != null">MARRIED_STATUS = #{record.marriedStatus:CHAR} ,</if>  
      <if test="record.politicsStatus != null">POLITICS_STATUS = #{record.politicsStatus:CHAR} ,</if>  
      <if test="record.educationBackground != null">EDUCATION_BACKGROUND = #{record.educationBackground:CHAR} ,</if>  
      <if test="record.gradutedSchool != null">GRADUTED_SCHOOL = #{record.gradutedSchool:VARCHAR} ,</if>  
      <if test="record.major != null">MAJOR = #{record.major:VARCHAR} ,</if>  
      <if test="record.gradutedTime != null">GRADUTED_TIME = #{record.gradutedTime:DATE} ,</if>  
      <if test="record.beginWorkTime != null">BEGIN_WORK_TIME = #{record.beginWorkTime:DATE} ,</if>  
      <if test="record.laborContractBeginTime != null">LABOR_CONTRACT_BEGIN_TIME = #{record.laborContractBeginTime:DATE} ,</if>  
      <if test="record.expectedPositiveTime != null">Expected_positive_time = #{record.expectedPositiveTime:DATE} ,</if>  
      <if test="record.actualPositiveTime != null">actual_positive_time = #{record.actualPositiveTime:DATE} ,</if>  
      <if test="record.householdAddress != null">household_address = #{record.householdAddress:VARCHAR} ,</if>  
      <if test="record.employmentWay != null">Employment_way = #{record.employmentWay:VARCHAR} ,</if>  
      <if test="record.leaveReason != null">LEAVE_REASON = #{record.leaveReason:VARCHAR} ,</if>  
      <if test="record.beyondCompany != null">BEYOND_COMPANY = #{record.beyondCompany:VARCHAR} ,</if>  
      <if test="record.grassLevelId != null">GRASS_LEVEL_ID = #{record.grassLevelId:VARCHAR} ,</if>  
      <if test="record.isFixedPlaceWorking != null">IS_FIXED_PLACE_WORKING = #{record.isFixedPlaceWorking:CHAR} ,</if>  
      <if test="record.actualEmployeeId != null">actual_employee_id = #{record.actualEmployeeId:CHAR} ,</if>  
      <if test="record.isCheckImsi != null">actual_employee_id = #{record.isCheckImsi:CHAR} ,</if>  
      <if test="entryTimes != null">entry_times = #{record.entryTimes:VARCHAR} ,</if> 
    </trim>  
    <if test="_parameter != null"> 
      <include refid="tbl_employee_info.Criteria_Where_Clause"/> 
    </if> 
  </update>
  <update id="updateByCriteria"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Wed Jul 01 11:44:57 CST 2015.
        --> update tbl_employee_info set EMPLOYEE_ID = #{record.employeeId:VARCHAR}, EMPLOYEE_NAME = #{record.employeeName:VARCHAR}, EMPLOYEE_GRADE = #{record.employeeGrade:CHAR}, EMAIL = #{record.email:VARCHAR}, MOBILE = #{record.mobile:CHAR}, CARDID = #{record.cardid:VARCHAR}, EMPLOYEE_DUTY = #{record.employeeDuty:VARCHAR}, DEPARTMENT_ID = #{record.departmentId:CHAR}, IS_ON_DUTY = #{record.isOnDuty:CHAR}, INTEGRATION = #{record.integration:INTEGER}, STOCK = #{record.stock:INTEGER}, LEVEL = #{record.level:INTEGER}, IMAGE_ID = #{record.imageId:VARCHAR}, BOARDING_TIME = #{record.boardingTime:DATE}, EMPLOYEE_ADRESS = #{record.employeeAdress:VARCHAR}, SEX = #{record.sex:CHAR}, EMPLOYEE_NATION = #{record.employeeNation:VARCHAR}, BIRTH_TIME = #{record.birthTime:DATE}, WORK_LIFE = #{record.workLife:DECIMAL}, DEGREE = #{record.degree:VARCHAR}, LEAVE_TIME = #{record.leaveTime:DATE}, HUKOU = #{record.hukou:VARCHAR}, HUKOU_TYPE = #{record.hukouType:CHAR}, MARRIED_STATUS = #{record.marriedStatus:CHAR}, POLITICS_STATUS = #{record.politicsStatus:CHAR}, EDUCATION_BACKGROUND = #{record.educationBackground:CHAR}, GRADUTED_SCHOOL = #{record.gradutedSchool:VARCHAR}, MAJOR = #{record.major:VARCHAR}, GRADUTED_TIME = #{record.gradutedTime:DATE}, BEGIN_WORK_TIME = #{record.beginWorkTime:DATE}, LABOR_CONTRACT_BEGIN_TIME = #{record.laborContractBeginTime:DATE}, Expected_positive_time = #{record.expectedPositiveTime:DATE}, actual_positive_time = #{record.actualPositiveTime:DATE}, household_address = #{record.householdAddress:VARCHAR}, Employment_way = #{record.employmentWay:VARCHAR}, LEAVE_REASON = #{record.leaveReason:VARCHAR}, BEYOND_COMPANY = #{record.beyondCompany:VARCHAR}, GRASS_LEVEL_ID = #{record.grassLevelId:VARCHAR}, IS_FIXED_PLACE_WORKING = #{record.isFixedPlaceWorking:CHAR}, actual_employee_id = #{record.actualEmployeeId:VARCHAR}, is_check_imsi = #{record.isCheckImsi:CHAR}, entry_times = #{record.entryTimes:VARCHAR}
    <if test="_parameter != null"> 
      <include refid="tbl_employee_info.Criteria_Where_Clause"/> 
    </if> 
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Wed Jul 01 11:44:57 CST 2015.
        --> update tbl_employee_info 
    <trim prefix="set"> 
      <if test="employeeName != null">EMPLOYEE_NAME = #{employeeName:VARCHAR} ,</if>  
      <if test="employeeGrade != null">EMPLOYEE_GRADE = #{employeeGrade:CHAR} ,</if>  
      <if test="email != null">EMAIL = #{email:VARCHAR} ,</if>  
      <if test="mobile != null">MOBILE = #{mobile:CHAR} ,</if>  
      <if test="cardid != null">CARDID = #{cardid:VARCHAR} ,</if>  
      <if test="employeeDuty != null">EMPLOYEE_DUTY = #{employeeDuty:VARCHAR} ,</if>  
      <if test="departmentId != null">DEPARTMENT_ID = #{departmentId:CHAR} ,</if>  
      <if test="isOnDuty != null">IS_ON_DUTY = #{isOnDuty:CHAR} ,</if>  
      <if test="integration != null">INTEGRATION = #{integration:INTEGER} ,</if>  
      <if test="stock != null">STOCK = #{stock:INTEGER} ,</if>  
      <if test="level != null">LEVEL = #{level:INTEGER} ,</if>  
      <if test="imageId != null">IMAGE_ID = #{imageId:VARCHAR} ,</if>  
      <if test="boardingTime != null">BOARDING_TIME = #{boardingTime:DATE} ,</if>  
      <if test="employeeAdress != null">EMPLOYEE_ADRESS = #{employeeAdress:VARCHAR} ,</if>  
      <if test="sex != null">SEX = #{sex:CHAR} ,</if>  
      <if test="employeeNation != null">EMPLOYEE_NATION = #{employeeNation:VARCHAR} ,</if>  
      <if test="birthTime != null">BIRTH_TIME = #{birthTime:DATE} ,</if>  
      <if test="workLife != null">WORK_LIFE = #{workLife:DECIMAL} ,</if>  
      <if test="degree != null">DEGREE = #{degree:VARCHAR} ,</if>  
      <if test="leaveTime != null">LEAVE_TIME = #{leaveTime:DATE} ,</if>  
      <if test="hukou != null">HUKOU = #{hukou:VARCHAR} ,</if>  
      <if test="hukouType != null">HUKOU_TYPE = #{hukouType:CHAR} ,</if>  
      <if test="marriedStatus != null">MARRIED_STATUS = #{marriedStatus:CHAR} ,</if>  
      <if test="politicsStatus != null">POLITICS_STATUS = #{politicsStatus:CHAR} ,</if>  
      <if test="educationBackground != null">EDUCATION_BACKGROUND = #{educationBackground:CHAR} ,</if>  
      <if test="gradutedSchool != null">GRADUTED_SCHOOL = #{gradutedSchool:VARCHAR} ,</if>  
      <if test="major != null">MAJOR = #{major:VARCHAR} ,</if>  
      <if test="gradutedTime != null">GRADUTED_TIME = #{gradutedTime:DATE} ,</if>  
      <if test="beginWorkTime != null">BEGIN_WORK_TIME = #{beginWorkTime:DATE} ,</if>  
      <if test="laborContractBeginTime != null">LABOR_CONTRACT_BEGIN_TIME = #{laborContractBeginTime:DATE} ,</if>  
      <if test="laborContractEndTime != null">LABOR_CONTRACT_END_TIME = #{laborContractEndTime:DATE} ,</if>  
      <if test="expectedPositiveTime != null">Expected_positive_time = #{expectedPositiveTime:DATE} ,</if>  
      <if test="actualPositiveTime != null">actual_positive_time = #{actualPositiveTime:DATE} ,</if>  
      <if test="householdAddress != null">household_address = #{householdAddress:VARCHAR} ,</if>  
      <if test="employmentWay != null">Employment_way = #{employmentWay:VARCHAR} ,</if>  
      <if test="leaveReason != null">LEAVE_REASON = #{leaveReason:VARCHAR} ,</if>  
      <if test="leaveCode != null">LEAVE_CODE = #{leaveCode:VARCHAR} ,</if>  
      <if test="beyondCompany != null">BEYOND_COMPANY = #{beyondCompany:VARCHAR} ,</if>  
      <if test="grassLevelId != null">GRASS_LEVEL_ID = #{grassLevelId:VARCHAR} ,</if>  
      <if test="isFixedPlaceWorking != null">IS_FIXED_PLACE_WORKING = #{isFixedPlaceWorking:CHAR} ,</if>  
      <if test="actualEmployeeId != null">actual_employee_id = #{actualEmployeeId:VARCHAR} ,</if>  
      <if test="isCheckImsi != null">is_check_imsi = #{isCheckImsi:CHAR} ,</if>  
      <if test="leavePostTime != null">LEAVE_POST_TIME = #{leavePostTime:DATE} ,</if>  
      <if test="leavePostReason != null">LEAVE_POST_REASON = #{leavePostReason:VARCHAR} ,</if>  
      <if test="entryTimes != null">entry_times = #{entryTimes:VARCHAR} ,</if>  
      <if test="contractType != null">CONTRACT_TYPE = #{contractType:VARCHAR} ,</if>  
      <if test="isRenew != null">IS_RENEW = #{isRenew:VARCHAR} ,</if>  
      <if test="renewTime != null">RENEW_TIME = #{renewTime:VARCHAR} ,</if> 
    </trim> where EMPLOYEE_ID = #{employeeId:VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Wed Jul 01 11:44:57 CST 2015.
        --> update tbl_employee_info set EMPLOYEE_NAME = #{employeeName:VARCHAR}, EMPLOYEE_GRADE = #{employeeGrade:CHAR}, EMAIL = #{email:VARCHAR}, MOBILE = #{mobile:CHAR}, CARDID = #{cardid:VARCHAR}, EMPLOYEE_DUTY = #{employeeDuty:VARCHAR}, DEPARTMENT_ID = #{departmentId:CHAR}, IS_ON_DUTY = #{isOnDuty:CHAR}, INTEGRATION = #{integration:INTEGER}, STOCK = #{stock:INTEGER}, LEVEL = #{level:INTEGER}, IMAGE_ID = #{imageId:VARCHAR}, BOARDING_TIME = #{boardingTime:DATE}, EMPLOYEE_ADRESS = #{employeeAdress:VARCHAR}, SEX = #{sex:CHAR}, EMPLOYEE_NATION = #{employeeNation:VARCHAR}, BIRTH_TIME = #{birthTime:DATE}, WORK_LIFE = #{workLife:DECIMAL}, DEGREE = #{degree:VARCHAR}, LEAVE_TIME = #{leaveTime:DATE}, HUKOU = #{hukou:VARCHAR}, HUKOU_TYPE = #{hukouType:CHAR}, MARRIED_STATUS = #{marriedStatus:CHAR}, POLITICS_STATUS = #{politicsStatus:CHAR}, EDUCATION_BACKGROUND = #{educationBackground:CHAR}, GRADUTED_SCHOOL = #{gradutedSchool:VARCHAR}, MAJOR = #{major:VARCHAR}, GRADUTED_TIME = #{gradutedTime:DATE}, BEGIN_WORK_TIME = #{beginWorkTime:DATE}, LABOR_CONTRACT_BEGIN_TIME = #{laborContractBeginTime:DATE}, Expected_positive_time = #{expectedPositiveTime:DATE}, actual_positive_time = #{actualPositiveTime:DATE}, household_address = #{householdAddress:VARCHAR}, Employment_way = #{employmentWay:VARCHAR}, LEAVE_REASON = #{leaveReason:VARCHAR}, BEYOND_COMPANY = #{beyondCompany:VARCHAR}, GRASS_LEVEL_ID = #{grassLevelId:VARCHAR}, IS_FIXED_PLACE_WORKING = #{isFixedPlaceWorking:VARCHAR}, actual_Employee_Id = #{actualEmployeeId:VARCHAR}, is_check_imsi = #{isCheckImsi:CHAR} entry_times = #{entryTimes:VARCHAR} where EMPLOYEE_ID = #{employeeId:VARCHAR}
  </update>
  <select id="selectProjectTeamEmployee" resultMap="BaseResultMap" parameterType="java.lang.String">SELECT fo.* FROM tbl_employee_info fo,tbl_project_team_emp_rel rel WHERE fo.EMPLOYEE_ID = rel.EMPLOYEE_ID AND rel.CONTRACT_TEAM_NO=#{value:VARCHAR}</select>
  <select id="selectProjectEmployees" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT fo.* FROM tbl_employee_info fo, (SELECT * FROM tbl_project_etc etc WHERE etc.employee_id NOT IN ( SELECT rel.EMPLOYEE_ID FROM tbl_project_team_info tinfo,tbl_project_team_emp_rel rel where tinfo.CONTRACT_TEAM_NO=rel.CONTRACT_TEAM_NO and tinfo.CONTRACT_NO=#{properties.contract_no:VARCHAR} )) exp WHERE fo.EMPLOYEE_ID = exp.EMPLOYEE_ID AND exp.contract_no=#{properties.contract_no:VARCHAR} AND exp.is_leave='00'</select>
  <select id="selectProjectAllEmployees" resultMap="BaseResultMap" parameterType="java.lang.String">SELECT fo.* FROM tbl_employee_info fo,tbl_project_etc etc WHERE fo.EMPLOYEE_ID = etc.EMPLOYEE_ID AND etc.contract_no=#{value:VARCHAR} AND etc.is_leave='00'</select>
  <select id="checkEmployeeInProject" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT fo.* FROM tbl_employee_info fo,tbl_project_etc etc WHERE fo.EMPLOYEE_ID = etc.employee_id AND fo.EMPLOYEE_ID = #{employeeId:VARCHAR} AND etc.contract_no=#{properties.contractNo:VARCHAR }</select>
  <select id="selectApproveMembers" resultMap="BaseResultMap" parameterType="java.lang.String">SELECT o.* FROM tbl_employee_info o , tbl_emp_organ_struct t WHERE o.EMPLOYEE_ID = t.EMPLOYEE_ID AND o.IS_ON_DUTY='01' AND t.PARENT_EMPLOYEE_ID=#{value:VARCHAR}</select>
  <!-- 查询可审核人员的基本信息 -->
  <select id="selectApproveMembersInfo" resultType="java.util.HashMap" parameterType="java.lang.String">SELECT o.employee_id, o.employee_name FROM tbl_employee_info o , tbl_emp_organ_struct t WHERE o.EMPLOYEE_ID = t.EMPLOYEE_ID AND o.IS_ON_DUTY='01' AND t.PARENT_EMPLOYEE_ID=#{value:VARCHAR}</select>
  <select id="selectEmployeeImgUrl" resultType="java.lang.String" parameterType="java.lang.String">SELECT IMAGE_ID FROM tbl_employee_info WHERE EMPLOYEE_ID = #{value:VARCHAR}</select>
  <select id="countByEmployeeInfo" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT count(1) FROM tbl_employee_info
    <trim prefix="where"> 
      <include refid="tbl_employee_info.employee_Where_Clause"/> 
    </trim> 
  </select>
  <select id="selectEquipInfocount" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeEquInfo">SELECT count(1) FROM tbl_equipment_record a, tbl_equipment_info b WHERE a.EQUIPMENT_ID = b.EQUIPMENT_ID AND a.EMPLOYEE_ID = ANY ( SELECT EMPLOYEE_ID FROM tbl_employee_info WHERE IS_ON_DUTY = #{isOnDuty:VARCHAR}
    <if test="employeeName != null">EMPLOYEE_NAME = #{employeeName:VARCHAR}</if> ) 
    <if test="isReturn != null">a.IS_RETURN = #{isReturn:VARCHAR}</if>  
    <if test="equipmentSerial != null">b.EQUIPMENT_SERIAL = #{equipmentSerial:VARCHAR}</if>  
    <isNull prepend="AND" property="isReturn">a.IS_RETURN = '0'</isNull>  
    <if test="isChange != null">a.IS_CHANGE = #{isChange:VARCHAR}</if>  
    <if test="isAcept != null">a.IS_ACEPT = #{isAcept:VARCHAR}</if>  
    <isNull prepend="AND" property="isAcept">a.IS_ACEPT = '1'</isNull> 
  </select>
  <select id="countByEmployeeInfo_new" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT count(1) FROM tbl_employee_info emp LEFT JOIN tbl_project_etc etc on etc.employee_id = emp.employee_id AND etc.is_Leave = '00' AND emp.IS_ON_DUTY ='01'
    <if test="employeeName != null and employeeName != ''">and emp.EMPLOYEE_NAME like concat('%', #{employeeName:VARCHAR}, '%')</if>  
    <if test="employeeId != null and employeeId != ''">and emp.EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  
    <if test="departmentId != null and departmentId != ''">and emp.DEPARTMENT_ID = #{departmentId:VARCHAR}</if>  
    <if test="beyondCompany != null and beyondCompany != ''">and emp.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
    <if test="email != null and email != ''">and emp.EMAIL = #{email:VARCHAR}</if>  
    <if test="employeeGrade != null and employeeGrade != ''">and emp.EMPLOYEE_GRADE = #{employeeGrade:CHAR}</if>  
    <if test="isOnDuty != null and isOnDuty != ''">and emp.IS_ON_DUTY = #{isOnDuty:CHAR}</if>  
    <if test="grassLevelId != null and grassLevelId != ''">and emp.GRASS_LEVEL_ID = #{grassLevelId:VARCHAR}</if>  
    <if test="properties.projectId != null and properties.projectId != ''">and emp.EMPLOYEE_ID NOT IN ( SELECT tc.employee_id from tbl_project_etc tc where tc.contract_no = #{properties.projectId:VARCHAR} )</if> LEFT JOIN tbl_project_info pro on etc.contract_no = pro.contract_no order by emp.employee_id DESC
  </select>
  <!-- 业务添加员工信息管理中心 新增  项目名称 这是之前的sql ResultMapExt ResultMapExtProject-->
  <select id="selectByEmployeeInfo" resultMap="ResultMapExt" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT * FROM tbl_employee_info
    <trim prefix="where"> 
      <include refid="tbl_employee_info.employee_Where_Clause"/> 
    </trim> order BY EMPLOYEE_ID DESC
  </select>
  <select id="ContractExpires" resultMap="contractExpiresMap" parameterType="com.i2shopping.i2work.operation.common.OnlineObject">SELECT EMPLOYEE_ID,EMPLOYEE_NAME,LABOR_CONTRACT_BEGIN_TIME,LABOR_CONTRACT_END_TIME FROM tbl_employee_info WHERE (SELECT DATEDIFF(LABOR_CONTRACT_END_TIME,NOW())) &lt; 7 AND (SELECT DATEDIFF(LABOR_CONTRACT_END_TIME,NOW())) &gt; 0 
    <if test="roleId != null">and DEPARTMENT_ID in(select department_id from tbl_project_info WHERE contract_no in(select ROLE_ENTILENMENT from tbl_project_menu WHERE ROLE_ID =#{roleId:VARCHAR} AND ROLE_CHECKED=1 AND LENGTH(ROLE_ENTILENMENT)=11 ))</if> 
  </select>
  <!--  2016-04-11
     后台管理>>项目人员管理>>添加项目成员>>条件查询
     查询所有员工，请勿乱用! -->
  <select id="getManagementProjectEmployeeList" resultMap="ResultMapExt" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT * FROM tbl_employee_info
    <trim prefix="where"> 
      <include refid="tbl_employee_info.employee_Where_Clause"/> 
    </trim> order BY EMPLOYEE_ID DESC
  </select>
  <!--  2016-04-11
       后台管理>>项目人员管理>>添加项目成员>>条件查询
       查询所有员工，请勿乱用! -->
  <select id="getManagementProjectEmployeeListCount" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo"> 
    <!--SELECT count(1)
      FROM tbl_employee_info
      <dynamic prepend="where">
        <include refid="tbl_employee_info.employee_Where_Clause" />
      </dynamic>--> SELECT count(1) FROM tbl_employee_info,tbl_department_info dep where dep.DEPARTMENT_ID = tbl_employee_info.DEPARTMENT_ID
    <if test="properties.employeeinfoArea != null and properties.employeeinfoArea != ''">and dep.area=#{properties.employeeinfoArea:VARCHAR}</if>  
    <include refid="tbl_employee_info.employee_Where_Clause"/> order BY EMPLOYEE_ID DESC
  </select>
  <!-- 业务添加员工信息管理中心 新增  项目名称 这是 新 sql -->
  <select id="selectByEmployeeInfo_new" resultMap="ResultMapExtProject" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT emp.*,pro.short_project_name FROM tbl_employee_info emp LEFT JOIN tbl_project_etc etc on etc.employee_id = emp.employee_id AND etc.is_Leave = '00' AND emp.IS_ON_DUTY ='01'
    <if test="employeeName != null and employeeName != ''">and emp.EMPLOYEE_NAME like concat('%', #{employeeName:VARCHAR}, '%')</if>  
    <if test="employeeId != null and employeeId != ''">and emp.EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  
    <if test="departmentId != null and departmentId != ''">and emp.DEPARTMENT_ID = #{departmentId:VARCHAR}</if>  
    <if test="beyondCompany != null and beyondCompany != ''">and emp.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
    <if test="email != null and email != ''">and emp.EMAIL = #{email:VARCHAR}</if>  
    <if test="employeeGrade != null and employeeGrade != ''">and emp.EMPLOYEE_GRADE = #{employeeGrade:CHAR}</if>  
    <if test="isOnDuty != null and isOnDuty != ''">and emp.IS_ON_DUTY = #{isOnDuty:CHAR}</if>  
    <if test="grassLevelId != null and grassLevelId != ''">and emp.GRASS_LEVEL_ID = #{grassLevelId:VARCHAR}</if>  
    <if test="properties.projectId != null and properties.projectId != ''">and emp.EMPLOYEE_ID NOT IN ( SELECT tc.employee_id from tbl_project_etc tc where tc.contract_no = #{properties.projectId:VARCHAR} )</if> LEFT JOIN tbl_project_info pro on etc.contract_no = pro.contract_no order by emp.employee_id DESC
  </select>
  <select id="selectEmpProject" resultMap="ResultMapExt" parameterType="java.lang.String">select * from tbl_employee_info WHERE EMPLOYEE_ID = #{value:VARCHAR}</select>
  <!-- 找回密码查询用户是否存在 -->
  <select id="selectEmployeeInfoByCardId" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT * FROM tbl_employee_info WHERE EMAIL = #{email:VARCHAR} and CARDID = #{cardid:VARCHAR}</select>
  <select id="selectEntryEmployeeInfo" resultMap="BaseResultMapOfEntryTimes" parameterType="java.lang.String">SELECT * FROM tbl_employee_info WHERE CARDID = #{value:VARCHAR}</select>
  <!-- 查询所有可以添加的用户 -->
  <select id="countByEmployeeInfoList" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select count(*) from tbl_employee_info info where info.employee_id not in ( select rel.user_id from tbl_user_role_rel rel)
    <if test="employeeName != null and employeeName != ''">and info.EMPLOYEE_NAME like concat('%', #{employeeName:VARCHAR}, '%')</if> 
  </select>
  <select id="countByEmployeeInfoLists" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select count(*) from tbl_employee_info info 
    <if test="employeeName != null and employeeName != ''">info.EMPLOYEE_NAME like concat('%', #{employeeName:VARCHAR}, '%')</if> 
  </select>
  <select id="selectByEmployeeInfoList" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select info.* from tbl_employee_info info where info.employee_id not in ( select rel.user_id from tbl_user_role_rel rel)
    <if test="employeeName != null and employeeName != ''">and info.EMPLOYEE_NAME like concat('%', #{employeeName:VARCHAR}, '%')</if> 
  </select>
  <select id="selectByEmployeeInfoLists" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select info.* from tbl_employee_info info 
    <if test="employeeName != null and employeeName != ''">info.EMPLOYEE_NAME like concat('%', #{employeeName:VARCHAR}, '%')</if> 
  </select>
  <select id="selectByEmployeeId" resultMap="BaseResultMap" parameterType="java.lang.String">SELECT * FROM tbl_employee_info WHERE EMPLOYEE_ID=#{value:VARCHAR}</select>
  <select id="selectByEmployeeIdForOther" resultMap="ResultMapForOther" parameterType="java.lang.String">SELECT * FROM tbl_employee_info WHERE EMPLOYEE_ID=#{value:VARCHAR}</select>
  <select id="countEmployeeNoInOrgan" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT count(1) FROM tbl_employee_info WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM tbl_emp_organ_struct)
    <trim> 
      <include refid="tbl_employee_info.employee_Where_Clause"/> 
    </trim> 
  </select>
  <select id="selectEmployeeNoInOrgan" resultMap="ResultMapExt" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT * FROM tbl_employee_info WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM tbl_emp_organ_struct)
    <trim> 
      <include refid="tbl_employee_info.employee_Where_Clause"/> 
    </trim> 
  </select>
  <select id="exportEmployees" resultType="java.util.HashMap" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT info.actual_employee_id,k.project_name,k.project_actual_no,dep.AREA as area,dep.DEPARTMENT_NAME,info.EMPLOYEE_GRADE,gd.GRADE_NAME,info.EMPLOYEE_NAME, info.BOARDING_TIME,info.CARDID,info.SEX,info.BIRTH_TIME,DATE_FORMAT( FROM_DAYS( TO_DAYS( NOW( ) )-TO_DAYS( info.BIRTH_TIME ) ),'%Y' ) +0 AS age, info.HUKOU,info.HUKOU_TYPE,info.MARRIED_STATUS,info.POLITICS_STATUS,info.EDUCATION_BACKGROUND,info.GRADUTED_SCHOOL, info.MAJOR,info.GRADUTED_TIME,round(TIMESTAMPDIFF(DAY , info.BOARDING_TIME, CURRENT_TIMESTAMP())/365,2) as borderPeroid, info.BEGIN_WORK_TIME,info.MOBILE,info.LABOR_CONTRACT_BEGIN_TIME,info.Expected_positive_time,info.actual_positive_time, DATE_ADD(info.LABOR_CONTRACT_BEGIN_TIME,INTERVAL 3 YEAR ) AS deadlineTime, (3*12*30-DATEDIFF(CURRENT_DATE(),BOARDING_TIME))/30 as remainTime,info.household_address,info.EMPLOYEE_ADRESS,info.Employment_way, info.LEAVE_POST_TIME,null as month_leave_rate,null as year_leave_rate,info.LEAVE_REASON,null as is_quit FROM tbl_employee_info info LEFT JOIN tbl_department_info dep ON info.DEPARTMENT_ID=dep.DEPARTMENT_ID LEFT JOIN tbl_employee_grade gd ON info.EMPLOYEE_DUTY=gd.GRADE_ID LEFT JOIN (select etc.*,pf.project_name,pf.project_actual_no from tbl_project_etc etc LEFT JOIN tbl_project_info pf on etc.contract_no=pf.contract_no where etc.is_Leave='00' or etc.is_Leave is null) as k ON info.EMPLOYEE_ID=k.employee_id
    <trim prefix="where"> 
      <if test="employeeName != null and employeeName != ''">and info.EMPLOYEE_NAME like concat('%', #{employeeName:VARCHAR}, '%')</if>  
      <if test="employeeId != null and employeeId != ''">and info.EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  
      <if test="departmentId != null and departmentId != ''">and info.DEPARTMENT_ID = #{departmentId:VARCHAR}</if>  
      <if test="beyondCompany != null and beyondCompany != ''">and info.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
      <if test="grassLevelId != null and grassLevelId != ''">and info.GRASS_LEVEL_ID = #{grassLevelId:VARCHAR}</if>  
      <if test="isOnDuty != null and isOnDuty != ''">and info.IS_ON_DUTY = #{isOnDuty:VARCHAR}</if> 
    </trim> 
  </select>
  <select id="selectEmployeeByParams" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT * FROM tbl_employee_info tei ,tbl_department_info dept WHERE tei.DEPARTMENT_ID = dept.DEPARTMENT_ID
    <if test="properties.projectManageArea != null and properties.projectManageArea != ''">and dept.AREA = #{properties.projectManageArea:VARCHAR}</if>  
    <if test="employeeName != null and employeeName != ''">and tei.EMPLOYEE_NAME like concat('%', #{employeeName:VARCHAR}, '%')</if>  
    <if test="employeeId != null and employeeId != ''">and tei.EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  
    <if test="departmentId != null and departmentId != ''">and tei.DEPARTMENT_ID = #{departmentId:VARCHAR}</if>  
    <if test="beyondCompany != null and beyondCompany != ''">and tei.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
    <if test="email != null and email != ''">and tei.EMAIL = #{email:VARCHAR}</if>  
    <if test="employeeGrade != null and employeeGrade != ''">and tei.EMPLOYEE_GRADE = #{employeeGrade:CHAR}</if>  
    <if test="isOnDuty != null and isOnDuty != ''">and tei.IS_ON_DUTY = #{isOnDuty:CHAR}</if>  
    <if test="grassLevelId != null and grassLevelId != ''">and tei.GRASS_LEVEL_ID = #{grassLevelId:VARCHAR}</if>  
    <if test="properties.projectId != null and properties.projectId != ''">and tei.EMPLOYEE_ID NOT IN ( SELECT tc.employee_id from tbl_project_etc tc where tc.contract_no = #{properties.projectId:VARCHAR} )</if> order BY tei.EMPLOYEE_ID DESC
  </select>
  <select id="getEmployeeNoTaskLessThree" resultMap="ResultMapForThree" parameterType="java.util.Map">SELECT k.EMPLOYEE_ID,k.num as taskCount from( select ifnull(a.countNum,0) as num,cc.employee_id FROM tbl_project_etc cc LEFT JOIN ( SELECT count(1) as countNum,tt.EMPLOYEE_ID from tbl_task_target tt where date_format(tt.CREATE_TIME,'%Y-%m-%d') = date_format(sysdate(),'%Y-%m-%d') GROUP BY tt.EMPLOYEE_ID)a ON cc.employee_id=a.EMPLOYEE_ID where cc.contract_no=#{contractNo} )k where<![CDATA[ k.num<#{needCount}








        ]]> </select>
  <!-- 积分清零 -->
  <update id="resetIntegration" parameterType="java.lang.String">update tbl_employee_info set INTEGRATION = 0 where EMPLOYEE_ID = #{employeeId:VARCHAR}</update>
  <update id="updateEquipmentRecord" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeEquInfo">update tbl_equipment_record set IS_RETURN = '1',RETURN_TIME = #{returnTime:VARCHAR},ACCEPT_USER = #{acceptUser:VARCHAR} where EQUIPMENT_ID = #{equipmentId:VARCHAR}</update>
  <update id="changeEquPrice" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeEquInfo">update tbl_equipment_info set EQUIPMENT_COL = #{equipmentCol:VARCHAR} where EQUIPMENT_ID = #{equipmentId:VARCHAR}</update>
  <update id="reupdateEquipmentRecord" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeEquInfo">update tbl_equipment_record set IS_CHANGE = '1',CHANGE_TIME = #{changeTime:VARCHAR},CHANGE_SERIAL = #{changeSerial:VARCHAR} where EQUIPMENT_ID = #{equipmentId:VARCHAR}</update>
  <!-- 积分查询 -->
  <select id="selectIntegration" resultMap="BaseResultMap" parameterType="java.lang.String">select * from tbl_employee_info where EMPLOYEE_ID = #{employeeId:VARCHAR}</select>
  <!-- 积分查询 -->
  <update id="updateIntegral" parameterType="java.util.Map">update tbl_employee_info set INTEGRATION = #{integration:INTEGER} where EMPLOYEE_ID = #{employeeId:VARCHAR}</update>
  <!-- 组织架构 拖拽 功能 -->
  <select id="getarentByUserEmployeeId" resultType="java.lang.String" parameterType="java.lang.String">select CAT_ID from tbl_emp_organ_struct eos where eos.PARENT_EMPLOYEE_ID = #{employeeId:VARCHAR}</select>
  <!--operation指定任务 查询所有的员工  2016-01-16 13:49:16 -->
  <select id="getAllEmployeeInfo" resultMap="BaseResultMap">select emp.* from tbl_employee_info emp, tbl_project_etc etc , tbl_project_info pro where emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and etc.is_leave='00' and emp.IS_ON_DUTY ='01'</select>
  <!--<select id="getAllEmployeeInfoMin" resultMap="BaseResultMap" >
        select *
from tbl_employee_info
where IS_ON_DUTY='01'
    </select>-->
  <select id="getAllEmployeeInfoMap" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select emp.* from tbl_employee_info emp,tbl_project_etc etc,tbl_project_info pro,tbl_department_info dep where emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id and emp.IS_ON_DUTY ='01' and etc.is_leave='00'
    <if test="properties.contractNo != null">and pro.contract_no = #{properties.contractNo:VARCHAR}</if>  
    <if test="properties.departmentId != null">and emp.department_id= #{properties.departmentId:VARCHAR}</if>  
    <if test="properties.companyId != null">and emp.BEYOND_COMPANY = #{properties.companyId:VARCHAR}</if>  
    <if test="properties.queryEmployeeId != null">and emp.EMPLOYEE_ID = #{properties.queryEmployeeId:VARCHAR}</if> 
  </select>
  <!--根据条件查询 已经请假的员工信息  2016年2月29日 liyazhou-->
  <select id="getNoSignEmployeeInfosLevel" resultMap="BaseResultMapEx" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select pro.project_name ,pro.contract_no, emp.* , dep.department_name from tbl_employee_leave as lv , tbl_employee_info as emp , tbl_project_etc as etc , tbl_project_info as pro , tbl_department_info as dep where lv.employee_id = emp.employee_id and emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id
    <if test="properties.checktype != null">and lv.check_type = #{properties.checktype:VARCHAR}</if>  
    <if test="properties.checktypes != null">and (lv.check_type = '1' or lv.check_type = '2')</if>  
    <if test="properties.beyondCompany != null">and emp.BEYOND_COMPANY = #{properties.beyondCompany:VARCHAR}</if>  
    <if test="properties.contractnos != null">and pro.contract_no = #{properties.contractnos:VARCHAR}</if>  
    <if test="properties.area != null">and dep.area = #{properties.area:VARCHAR}</if>  
    <if test="properties.queryDate != null">and date_format(lv.leave_end_date,'%Y-%m-%d') &gt;= #{properties.queryDate:VARCHAR} and date_format(lv.leave_start_date,'%Y-%m-%d')&lt;=#{properties.queryDate:VARCHAR}</if>  
    <!--  ORDER BY lv.leave_end_date desc -->  
    <!-- 2016年3月11日 15:01:35  请假人 当天轻很多假期 只显示一个即可   后面未开始    count(emp.employee_id)>0 （相同）  count(emp.employee_id)>=1--> GROUP BY emp.employee_id HAVING count(emp.employee_id)&gt;0 ORDER BY lv.leave_end_date desc
  </select>
  <select id="getNoSignEmployeeInfosLevelCount" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select count(*) from tbl_employee_leave as lv , tbl_employee_info as emp , tbl_project_etc as etc , tbl_project_info as pro , tbl_department_info as dep where lv.employee_id = emp.employee_id and emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id
    <if test="properties.checktype != null">and lv.check_type = #{properties.checktype:VARCHAR}</if>  
    <if test="properties.queryDate != null">and date_format(lv.leave_end_date,'%Y-%m-%d') &gt;= #{properties.queryDate:VARCHAR} and date_format(lv.leave_start_date,'%Y-%m-%d')&lt;=#{properties.queryDate:VARCHAR}</if>  
    <!--  ORDER BY lv.leave_end_date desc -->  
    <!-- 2016年3月11日 15:01:35  请假人 当天很多假期 只显示一个即可     --> GROUP BY emp.employee_id HAVING count(emp.employee_id)&gt;0 ORDER BY lv.leave_end_date desc
  </select>
  <select id="getNoSignEmployeeInfosLevelCounts" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select ifnull(f.fnum,0) + ifnull(k.dupnum,0) as num from (select count(*) as fnum from (select emp.employee_id from tbl_employee_leave as lv , tbl_employee_info as emp , tbl_project_etc as etc , tbl_project_info as pro , tbl_department_info as dep where lv.employee_id = emp.employee_id and emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id
    <if test="properties.checktype != null">and lv.check_type = #{properties.checktype:VARCHAR}</if>  
    <if test="properties.checktypes != null">and (lv.check_type = '1' or lv.check_type = '2')</if>  
    <if test="properties.contractnos != null">and pro.contract_no = #{properties.contractnos:VARCHAR}</if>  
    <if test="properties.beyondCompany != null">and emp.BEYOND_COMPANY = #{properties.beyondCompany:VARCHAR}</if>  
    <if test="properties.area != null">and dep.AREA = #{properties.area:VARCHAR}</if>  
    <if test="properties.queryDate != null">and date_format(lv.leave_end_date,'%Y-%m-%d') &gt;= #{properties.queryDate:VARCHAR} and date_format(lv.leave_start_date,'%Y-%m-%d')&lt;=#{properties.queryDate:VARCHAR}</if> GROUP BY emp.employee_id HAVING count(emp.employee_id) =1)B)f ,(select count(1) as dupnum from (select emp.employee_id from tbl_employee_leave as lv , tbl_employee_info as emp , tbl_project_etc as etc , tbl_project_info as pro , tbl_department_info as dep where lv.employee_id = emp.employee_id and emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id
    <if test="properties.checktype != null">and lv.check_type = #{properties.checktype:VARCHAR}</if>  
    <if test="properties.checktypes != null">and (lv.check_type = '1' or lv.check_type = '2')</if>  
    <if test="properties.beyondCompany != null">and emp.BEYOND_COMPANY = #{properties.beyondCompany:VARCHAR}</if>  
    <if test="properties.contractnos != null">and pro.contract_no = #{properties.contractnos:VARCHAR}</if>  
    <if test="properties.area != null">and dep.AREA = #{properties.area:VARCHAR}</if>  
    <if test="properties.queryDate != null">and date_format(lv.leave_end_date,'%Y-%m-%d') &gt;= #{properties.queryDate:VARCHAR} and date_format(lv.leave_start_date,'%Y-%m-%d')&lt;=#{properties.queryDate:VARCHAR}</if> GROUP BY emp.employee_id HAVING count(emp.employee_id) &gt;1) A)k
  </select>
  <!-- 查询任务的总数量 2016年3月2日 liyazhou  -->
  <select id="getNoTaskEmployeeTaskGetFinish" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT count(*) FROM tbl_employee_info emps ,tbl_task_target task WHERE emps.employee_id = task.employee_id
    <if test="properties.queryDate != null">and date_format(task.create_time,'%Y-%m-%d') = #{properties.queryDate:VARCHAR}</if>  
    <if test="employeeId != null and employeeId != ''">and emps.EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  
    <if test="beyondCompany != null and beyondCompany != ''">and emps.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if> and task.STATUS in ('3','2') GROUP BY task.employee_id
  </select>
  <!-- 查询任务的完成度  2016年3月2日  liyazhou  -->
  <select id="getNoTaskEmployeeTaskGetTotals" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT count(*) FROM tbl_employee_info emps ,tbl_task_target task WHERE emps.employee_id = task.employee_id
    <if test="properties.queryDate != null">and date_format(task.create_time,'%Y-%m-%d') = #{properties.queryDate:VARCHAR}</if>  
    <if test="employeeId != null and employeeId != ''">and emps.EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  
    <if test="beyondCompany != null and beyondCompany != ''">and emps.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if> and task.STATUS in ('3','2','1','0') GROUP BY task.employee_id
  </select>
  <select id="getTaskCounts" resultMap="ResultMapForTask" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT count( * ) AS taskCounts,emps.IMAGE_ID,emps.EMPLOYEE_NAME,emps.EMPLOYEE_GRADE,emps.EMPLOYEE_ID FROM tbl_employee_info emps, tbl_task_target task WHERE emps.employee_id = task.employee_id AND date_format( task.create_time, '%Y-%m-%d' ) = '2015-10-12' AND task.STATUS IN ( '3', '2', '1', '0' )
    <if test="beyondCompany != null and beyondCompany != ''">and emps.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if> GROUP BY task.employee_id ORDER BY count( * ) desc LIMIT 20
  </select>
  <select id="getNoTaskEmployeeInfosFindNumber" resultMap="BaseResultMapEx" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select pro.project_name , pro.contract_no, emp.*, dep.department_name from tbl_employee_info emp, tbl_project_etc etc , tbl_project_info pro , tbl_department_info dep ,tbl_task_target task where emp.employee_id = etc.employee_id and emp.employee_id = task.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id and etc.is_leave='00' and emp.IS_ON_DUTY ='01' and task.TASK_TYPE='2'
    <if test="properties.area != null">and dep.area = #{properties.area:VARCHAR}</if>  
    <if test="properties.beyondCompany != null">and emp.BEYOND_COMPANY = #{properties.beyondCompany:VARCHAR}</if>  
    <if test="properties.beyondCompany != null">and emp.BEYOND_COMPANY = #{properties.beyondCompany:VARCHAR}</if>  
    <if test="properties.contractno != null">and pro.contract_no = #{properties.contractno:VARCHAR}</if>  
    <if test="properties.createtime != null">and date_format(task.create_time,'%Y-%m-%d') = #{properties.createtime:VARCHAR}</if>  
    <if test="properties.planenddate != null">and date_format(pro.plan_end_date,'%Y-%m-%d') &gt;= #{properties.planenddate:VARCHAR}</if> GROUP BY task.employee_id 
    <if test="properties.xiaoyusignTime != null"> <![CDATA[
		   HAVING  count(task.employee_id) < #{properties.xiaoyusignTime:VARCHAR}
		    ]]> </if>  
    <if test="properties.dayusignTime != null"> <![CDATA[
		   HAVING    count(task.employee_id) >= #{properties.dayusignTime:VARCHAR}
		    ]]> </if> 
  </select>
  <select id="getNoTaskEmployeeInfosFindNumberCount" resultMap="BaseResultMapEx" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select pro.project_name , pro.contract_no, emp.*, dep.department_name from tbl_employee_info emp, tbl_project_etc etc , tbl_project_info pro , tbl_department_info dep ,tbl_task_target task where emp.employee_id = etc.employee_id and emp.employee_id = task.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id and etc.is_leave='00' and emp.IS_ON_DUTY ='01' and task.TASK_TYPE='2'
    <if test="properties.area != null">and dep.area = #{properties.area:VARCHAR}</if>  
    <if test="properties.beyondCompany != null">and emp.BEYOND_COMPANY = #{properties.beyondCompany:VARCHAR}</if>  
    <if test="properties.contractno != null">and pro.contract_no = #{properties.contractno:VARCHAR}</if>  
    <if test="properties.createtime != null">and date_format(task.create_time,'%Y-%m-%d') = #{properties.createtime:VARCHAR}</if>  
    <if test="properties.planenddate != null">and date_format(pro.plan_end_date,'%Y-%m-%d') &gt;= #{properties.planenddate:VARCHAR}</if> GROUP BY task.employee_id 
    <if test="properties.xiaoyusignTime != null"> <![CDATA[
		   HAVING    count(task.employee_id) < #{properties.xiaoyusignTime:VARCHAR}
		    ]]> </if>  
    <if test="properties.dayusignTime != null"> <![CDATA[
		   HAVING    count(task.employee_id) >= #{properties.dayusignTime:VARCHAR}
		    ]]> </if> 
  </select>
  <!-- 查询已经签到的人的信息 2016年3月11日  查询是否已经迟到-->
  <select id="getNoSignEmployeeInfosInOut" resultMap="BaseResultMapEx" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select pro.project_name ,pro.contract_no, emp.* , dep.department_name from tbl_employee_info emp, tbl_project_etc etc , tbl_project_info pro , tbl_department_info dep where emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id and emp.IS_ON_DUTY ='01' and etc.is_leave='00'
    <if test="employeeName != null">and emp.employee_name like concat('%', #{employeeName:VARCHAR}, '%')</if>  
    <if test="beyondCompany != null">and emp.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
    <if test="contractno != null">and pro.contract_no = #{contractno:VARCHAR}</if>  
    <if test="departmentId != null">and emp.department_id = #{departmentId:VARCHAR}</if> and EXISTS( SELECT 'X' FROM tbl_sign_in_out_record sig WHERE emp.employee_id = sig.employee_id and emp.beyond_company =#{beyondCompany:VARCHAR}<![CDATA[
		    	  and sig.sign_time=#{properties.signTime:VARCHAR}
				  and  date_format(sig.sign_in_time,'%Y-%m-%d') = #{properties.signTime:VARCHAR}
		     	]]> )
  </select>
  <!-- 查询已经签到的人的信息 2016年3月11日  查询是否已经迟到-->
  <select id="getNoSignEmployeeInfosInOutCount" resultMap="BaseResultMapEx" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select pro.project_name ,pro.contract_no, emp.* , dep.department_name from tbl_employee_info emp, tbl_project_etc etc , tbl_project_info pro , tbl_department_info dep where emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id and emp.IS_ON_DUTY ='01' and etc.is_leave='00'
    <if test="employeeName != null">and emp.employee_name like concat('%', #{employeeName:VARCHAR}, '%')</if>  
    <if test="beyondCompany != null">and emp.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
    <if test="contractno != null">and pro.contract_no = #{contractno:VARCHAR}</if>  
    <if test="departmentId != null">and emp.department_id = #{departmentId:VARCHAR}</if> and EXISTS( SELECT 'X' FROM tbl_sign_in_out_record sig WHERE emp.employee_id = sig.employee_id and emp.beyond_company =#{beyondCompany:VARCHAR}<![CDATA[
		    	  and sig.sign_time=#{properties.signTime:VARCHAR}
				  and  date_format(sig.sign_in_time,'%Y-%m-%d') = #{properties.signTime:VARCHAR}
		     	]]> )
  </select>
  <!--  根据项目查询员工信息  带部门信息 -->
  <select id="getProjectEmployeesAndDeptment" resultMap="BaseResultMapEx" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select pro.project_name ,pro.contract_no, emp.* , dep.department_name from tbl_employee_info emp, tbl_project_etc etc , tbl_project_info pro , tbl_department_info dep where emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id and emp.IS_ON_DUTY ='01' and etc.is_leave='00'
    <if test="contractno != null">and etc.contract_no = #{contractno:VARCHAR}</if> 
  </select>
  <!-- 2016年3月16日   @desc 查询没有 项目的员工 -->
  <select id="getNoSignEmployeeInfosNocontractNo" resultMap="BaseResultMapExNoContractno" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select dep_.department_name, teg_.grade_name, emp_.* from tbl_employee_info emp_ ,tbl_department_info dep_,tbl_employee_grade teg_ where emp_.IS_ON_DUTY ='01' and teg_.GRADE_ID = emp_.EMPLOYEE_DUTY and dep_.department_id = emp_.department_id
    <if test="beyondCompany != null">and emp_.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
    <if test="properties.area != null">and dep_.area = #{properties.area:VARCHAR}</if> and emp_.employee_id not in( select emp.employee_id from tbl_project_etc etc , tbl_project_info pro, tbl_employee_info emp where etc.contract_no = pro.contract_no and etc.employee_id = emp.EMPLOYEE_ID and emp.IS_ON_DUTY ='01' and etc.is_Leave = '00'
    <if test="beyondCompany != null">and emp.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if> order by etc.employee_id )
  </select>
  <!-- 2016年3月16日   @desc 查询没有 项目的员工 -->
  <select id="getNoSignEmployeeInfosNocontractNoCount" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select count(*) from tbl_employee_info emp, tbl_department_info dep, tbl_employee_grade teg where emp.IS_ON_DUTY ='01' and teg.GRADE_ID = emp.EMPLOYEE_DUTY and dep.department_id = emp.department_id
    <if test="beyondCompany != null">and emp.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
    <if test="properties.area != null">and dep.area = #{properties.area:VARCHAR}</if> and emp.employee_id not in( select emp.employee_id from tbl_project_etc etc , tbl_project_info pro, tbl_employee_info emp where etc.contract_no = pro.contract_no and etc.employee_id = emp.employee_id and emp.IS_ON_DUTY ='01' and etc.is_Leave = '00'
    <if test="beyondCompany != null">and emp.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if> order by etc.employee_id )
  </select>
  <!-- 监控签到圈圈中 显示迟到的人数 new 2016-08-05 -->
  <select id="getNoSignEmployeeInfosInOutLateCount" resultMap="BaseResultMapEx" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select pro.project_name ,pro.contract_no, emp.* , dep.department_name from tbl_employee_info emp, tbl_project_etc etc , tbl_project_info pro , tbl_department_info dep where emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id and emp.IS_ON_DUTY ='01' and etc.is_leave='00' and emp.employee_id not in ('00000275','00000100')
    <if test="employeeName != null">and emp.employee_name like concat('%', #{employeeName:VARCHAR}, '%')</if>  
    <if test="beyondCompany != null">and emp.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
    <if test="contractno != null">and pro.contract_no = #{contractno:VARCHAR}</if>  
    <if test="departmentId != null">and emp.department_id = #{departmentId:VARCHAR}</if>  
    <if test="properties.area != null">and dep.area = #{properties.area:VARCHAR}</if> and EXISTS( SELECT 'X' FROM tbl_sign_in_out_record sig WHERE emp.employee_id = sig.employee_id and emp.beyond_company =#{beyondCompany:VARCHAR}<![CDATA[
		    	  and sig.sign_time=#{properties.signTime:VARCHAR}
				  and date_format(sig.sign_in_time,'%Y-%m-%d') = #{properties.signTime:VARCHAR}
				  and str_to_date(substring(sig.sign_in_time, 12,5),"%H:%i") >= str_to_date(pro.standwork_starttime,'%H:%i')
		     	]]> )
  </select>
  <!-- 监控首页签到圈圈中 显示迟到的人数 new 2016-08-05-->
  <select id="getNoSignEmployeeInfosInOutLate" resultMap="BaseResultMapEx" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">select pro.project_name ,pro.contract_no, emp.* , dep.department_name from tbl_employee_info emp, tbl_project_etc etc , tbl_project_info pro , tbl_department_info dep where emp.employee_id = etc.employee_id and etc.contract_no = pro.contract_no and dep.department_id = emp.department_id and emp.IS_ON_DUTY ='01' and etc.is_leave='00' and emp.employee_id not in ('00000275','00000100')
    <if test="employeeName != null">and emp.employee_name like concat('%', #{employeeName:VARCHAR}, '%')</if>  
    <if test="beyondCompany != null">and emp.BEYOND_COMPANY = #{beyondCompany:VARCHAR}</if>  
    <if test="contractno != null">and pro.contract_no = #{contractno:VARCHAR}</if>  
    <if test="departmentId != null">and emp.department_id = #{departmentId:VARCHAR}</if>  
    <if test="properties.area != null">and dep.area = #{properties.area:VARCHAR}</if> and EXISTS( SELECT 'X' FROM tbl_sign_in_out_record sig WHERE emp.employee_id = sig.employee_id and emp.beyond_company =#{beyondCompany:VARCHAR}<![CDATA[
		    	  and sig.sign_time=#{properties.signTime:VARCHAR}
				  and date_format(sig.sign_in_time,'%Y-%m-%d') = #{properties.signTime:VARCHAR}
				  and str_to_date(substring(sig.sign_in_time, 12,5),"%H:%i") >= str_to_date(pro.standwork_starttime,'%H:%i')
		     	]]> )
  </select>
  <!-- 后台管理>>员工管理>>员工列表 区分地区和公司 -->
  <select id="countByEmployeeInfoArea" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT count(1) FROM tbl_employee_info ,tbl_department_info dep where dep.DEPARTMENT_ID = tbl_employee_info.DEPARTMENT_ID
    <if test="properties.employeeinfoArea != null and properties.employeeinfoArea != ''">and dep.area=#{properties.employeeinfoArea:VARCHAR}</if>  
    <include refid="tbl_employee_info.employee_Where_Clause"/> 
  </select>
  <!-- 后台管理>>员工管理>>员工列表 区分地区和公司 -->
  <select id="selectByEmployeeInfoArea" resultMap="ResultMapExt" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT * FROM tbl_employee_info,tbl_department_info dep where dep.DEPARTMENT_ID = tbl_employee_info.DEPARTMENT_ID
    <if test="properties.employeeinfoArea != null and properties.employeeinfoArea != ''">and dep.area=#{properties.employeeinfoArea:VARCHAR}</if>  
    <include refid="tbl_employee_info.employee_Where_Clause"/> order BY 
    <if test="isOnDuty!= null and isOnDuty == '00'.toString()">LEAVE_POST_TIME DESC,</if> EMPLOYEE_ID DESC
  </select>
  <!--  2016-04-11
    后台管理>>项目人员管理>>添加项目成员>>条件查询 区分公司和地区
    -->
  <select id="getManagementProjectEmployeeListArea" resultMap="ResultMapExt" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT * FROM tbl_employee_info,tbl_department_info dep where dep.DEPARTMENT_ID = tbl_employee_info.DEPARTMENT_ID
    <if test="properties.employeeinfoArea != null and properties.employeeinfoArea != ''">and dep.area=#{properties.employeeinfoArea:VARCHAR}</if>  
    <include refid="tbl_employee_info.employee_Where_Clause"/> order BY EMPLOYEE_ID DESC
  </select>
  <!--  2016-04-11
       后台管理>>项目人员管理>>添加项目成员>>条件查询 区分公司和地区 -->
  <select id="getManagementProjectEmployeeListCountArea" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT count(1) FROM tbl_employee_info,tbl_department_info dep where dep.DEPARTMENT_ID = tbl_employee_info.DEPARTMENT_ID
    <if test="properties.employeeinfoArea != null and properties.employeeinfoArea != ''">and dep.area=#{properties.employeeinfoArea:VARCHAR}</if>  
    <include refid="tbl_employee_info.employee_Where_Clause"/> 
  </select>
  <select id="selectEmployeeInfoByEmployeeId" resultMap="BaseResultMap" parameterType="java.lang.String">SELECT * FROM tbl_employee_info WHERE EMPLOYEE_ID = #{employeeId:VARCHAR}</select>
  <select id="getCountByDepartmentId" resultType="java.lang.Integer" parameterType="java.lang.String">select count(*) from tbl_employee_info where DEPARTMENT_ID = #{departmentId:VARCHAR}</select>
  <select id="selectByDepartmentId" resultMap="ResultMapExt" parameterType="java.util.List">SELECT * FROM tbl_employee_info WHERE DEPARTMENT_ID in
    <iterate close=")" open="(" conjunction=","> <![CDATA[
                 #{departmentId[]}
            ]]> </iterate> 
  </select>
  <select id="getAnnualLeave" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.employee.model.EmployeeInfo">SELECT * FROM tbl_employee_info</select>
  <select id="selectInfoByEmployeeId" resultMap="BaseResultMap" parameterType="java.lang.String">SELECT * FROM tbl_employee_info WHERE EMPLOYEE_ID = #{employeeId:VARCHAR}</select>
  <select id="selectEmployeeInfoByDepartmentId" resultMap="ResultMapExt" parameterType="java.lang.String">SELECT * FROM tbl_employee_info WHERE DEPARTMENT_ID = #{departmentId:VARCHAR}</select>
</mapper>

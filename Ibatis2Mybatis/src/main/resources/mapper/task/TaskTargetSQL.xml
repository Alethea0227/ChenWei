<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="tbl_task_target">
  <resultMap id="BaseResultMap" type="com.i2shopping.i2work.operation.core.task.model.TaskTarget">
    <result column="TASK_ID" property="taskId" jdbcType="VARCHAR"/>
    <result column="EMPLOYEE_ID" property="employeeId" jdbcType="VARCHAR"/>
    <result column="CONTRACT_NO" property="contractNo" jdbcType="VARCHAR"/>
    <result column="TARGET_NAME" property="targetName" jdbcType="VARCHAR"/>
    <result column="TARGET_DESC" property="targetDesc" jdbcType="VARCHAR"/>
    <result column="COMPLETE_SCORE" property="completeScore" jdbcType="DECIMAL"/>
    <result column="QUALITY_SCORE" property="qualityScore" jdbcType="DECIMAL"/>
    <result column="CREATE_TIME" property="createTime" jdbcType="TIMESTAMP"/>
    <result column="BEGIN_TIME" property="beginTime" jdbcType="TIMESTAMP"/>
    <result column="END_TIME" property="endTime" jdbcType="TIMESTAMP"/>
    <result column="STATUS" property="status" jdbcType="CHAR"/>
    <result column="VERIFY_ID" property="verifyId" jdbcType="VARCHAR"/>
    <result column="TASK_TYPE" property="taskType" jdbcType="CHAR"/>
    <result column="COMPLETE_TIME" property="completeTime" jdbcType="VARCHAR"/>
    <result column="VERIFY_NAME" property="verifyName" jdbcType="VARCHAR"/>
    <result column="REMARK" property="remark" jdbcType="VARCHAR"/>
    <result column="VREMARK" property="vremark" jdbcType="VARCHAR"/>
  </resultMap>
  <resultMap id="BaseResultMapEx" type="com.i2shopping.i2work.operation.core.task.model.TaskTarget">
    <result column="taskCount" property="taskCount" jdbcType="INTEGER"/>
    <result column="CONTRACT_NO" property="contractNo" jdbcType="VARCHAR"/>
  </resultMap>
  <!-- 监控任务折线图 返回数据 -->
  <resultMap id="BaseResultMapTask" type="com.i2shopping.i2work.operation.core.task.model.TaskTarget">
    <result column="taskChartCount" property="taskChartCount" jdbcType="INTEGER"/>
    <result column="taskChartDates" property="taskChartDates" jdbcType="TIMESTAMP"/>
  </resultMap>
  <resultMap id="BaseResultMapExt" extends="BaseResultMap" type="com.i2shopping.i2work.operation.core.task.model.TaskTarget">
    <result column="MOBILE" property="mobile" jdbcType="CHAR"/>
    <result column="EMPLOYEE_NAME" property="employeeName" jdbcType="VARCHAR"/>
    <association property="employeeInfo" select="tbl_employee_info_vo.selectByEmployeeIdForOther" column="EMPLOYEE_ID"/>
  </resultMap>
  <resultMap id="BaseResultMapExtra" extends="BaseResultMap" type="com.i2shopping.i2work.operation.core.task.model.TaskTarget">
    <result column="EMPLOYEE_NAME" property="employeeName" jdbcType="VARCHAR"/>
  </resultMap>
  <sql id="Criteria_Where_Clause"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Jun 23 14:49:19 CST 2015.
    -->  
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate"> 
      <if test="oredCriteria[].valid!= null and oredCriteria[].valid == 'true'.toString()">( 
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and">$oredCriteria[].criteriaWithoutValue[]$</iterate>  
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and">$oredCriteria[].criteriaWithSingleValue[].condition$ #{oredCriteria[].criteriaWithSingleValue[].value}</iterate>  
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and">$oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction=",">#{oredCriteria[].criteriaWithListValue[].values[]}</iterate> 
        </iterate>  
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and">$oredCriteria[].criteriaWithBetweenValue[].condition$ #{oredCriteria[].criteriaWithBetweenValue[].values[0]} and #{oredCriteria[].criteriaWithBetweenValue[].values[1]}</iterate> )
      </if> 
    </iterate> 
  </sql>
  <!-- 有任务的员工 -->
  <select id="selectHaveTaskEmp" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">select count(DISTINCT tt.employee_id) from tbl_task_target tt, tbl_employee_info tei,tbl_department_info tdi where tt.employee_id = tei.employee_id and tdi.DEPARTMENT_ID = tei.DEPARTMENT_ID
    <!-- and tt.TASK_TYPE='2'  任务都已经放开 --> and tei.IS_ON_DUTY ='01' 
    <if test="createTime != null">and date_format(tt.CREATE_TIME,'%Y-%m-%d') = date_format(#{createTime:TIMESTAMP},'%Y-%m-%d')</if>  
    <if test="contractNo != null">and tt.contract_no = #{contractNo:VARCHAR}</if>  
    <if test="properties.companyId != null and properties.companyId != ''">and tei.BEYOND_COMPANY = #{properties.companyId:VARCHAR}</if>  
    <if test="properties.area != null and properties.area != ''">and tdi.area = #{properties.area:VARCHAR}</if> 
  </select>
  <!-- 查询部门待审批的任务 -->
  <select id="selectEmployeeVeriftyTask" resultMap="BaseResultMapExt" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">select task.*, employee_name, mobile from tbl_task_target task, tbl_employee_info emp where task.verify_id = emp.employee_id and task.status= #{status:CHAR} and task.TASK_TYPE='2'
    <if test="endTime != null and endTime != ''"> <![CDATA[
      	date_format(task.END_TIME,'%Y-%m-%d') = date_format(#{endTime:TIMESTAMP},'%Y-%m-%d')
      ]]> </if>  
    <trim prefix=" AND task.CONTRACT_NO IN "> 
      <if test="properties != null"> 
        <if test="properties.constractNoList != null"> 
          <iterate property="properties.constractNoList" open="(" close=")" conjunction=",">#{properties.constractNoList[]}</iterate> 
        </if> 
      </if> 
    </trim> order by end_Time desc limit 50
  </select>
  <!-- 查询个人待审批任务 -->
  <select id="selectUnapproveTask" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">select count(*) from tbl_task_target where VERIFY_ID = #{verifyId:VARCHAR} and TASK_TYPE ='2' and status =#{status:CHAR} and date_format(CREATE_TIME,'%Y-%m-%d') = date_format(#{createTime:TIMESTAMP},'%Y-%m-%d')</select>
  <!-- 查询部门超时的任务 -->
  <select id="selectEmployeeTask" resultMap="BaseResultMapExt" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">select task.*, employee_name, mobile from tbl_task_target task, tbl_employee_info emp where task.employee_id = emp.employee_id and (task.status="0" or task.status="1") and task.TASK_TYPE='2'
    <if test="endTime != null and endTime != ''"> <![CDATA[
      	date_format(task.END_TIME,'%Y-%m-%d %H:%i:%S') < date_format(#{endTime:TIMESTAMP},'%Y-%m-%d %H:%i:%S')
      	and
      	date_format(task.END_TIME,'%Y-%m-%d') = date_format(#{endTime:TIMESTAMP},'%Y-%m-%d')
      ]]> </if>  
    <trim prefix=" AND task.CONTRACT_NO IN "> 
      <if test="properties != null"> 
        <if test="properties.constractNoList != null"> 
          <iterate property="properties.constractNoList" open="(" close=")" conjunction=",">#{properties.constractNoList[]}</iterate> 
        </if> 
      </if> 
    </trim> order by end_Time desc limit 100
  </select>
  <!-- 查询部门任务数量 -->
  <select id="selectDepartmentTaskCount" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">select count(*) from tbl_task_target tt,tbl_employee_info tei,tbl_department_info tdi where tt.EMPLOYEE_ID = tei.EMPLOYEE_ID and tei.DEPARTMENT_ID = tdi.DEPARTMENT_ID
    <if test="createTime != null and createTime != ''">date_format(tt.CREATE_TIME,'%Y-%m-%d') = date_format(#{createTime:TIMESTAMP},'%Y-%m-%d')</if>  
    <trim prefix=" AND tt.CONTRACT_NO IN "> 
      <if test="properties != null"> 
        <if test="properties.constractNoList != null"> 
          <iterate property="properties.constractNoList" open="(" close=")" conjunction=",">#{properties.constractNoList[]}</iterate> 
        </if> 
      </if> 
    </trim>  
    <if test="properties.status != null and properties.status != ''">and (tt.status="2" or tt.status="3")</if>  
    <if test="properties.area != null and properties.area != ''">and tdi.area = #{properties.area:VARCHAR}</if> 
  </select>
  <!-- 查询任务数量 -->
  <select id="selectAllTaskCount" resultMap="BaseResultMapEx" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">select CONTRACT_NO, count(*) taskCount from tbl_task_target where TASK_TYPE='2'
    <if test="createTime != null and createTime != ''">date_format(CREATE_TIME,'%Y-%m-%d') = date_format(#{createTime:TIMESTAMP},'%Y-%m-%d')</if>  
    <if test="properties.status != null and properties.status != ''">and (status="2" or status="3")</if> group by CONTRACT_NO
  </select>
  <!-- 查询部门任务数量 -->
  <select id="selectTaskCount" resultMap="BaseResultMapEx" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">select CONTRACT_NO, count(*) taskCount from tbl_task_target where TASK_TYPE='2'
    <if test="createTime != null and createTime != ''">date_format(CREATE_TIME,'%Y-%m-%d') = date_format(#{createTime:TIMESTAMP},'%Y-%m-%d')</if>  
    <if test="properties.status != null and properties.status != ''">and (status="2" or status="3")</if>  
    <trim prefix=" AND CONTRACT_NO IN "> 
      <if test="properties != null"> 
        <if test="properties.constractNoList != null"> 
          <iterate property="properties.constractNoList" open="(" close=")" conjunction=",">#{properties.constractNoList[]}</iterate> 
        </if> 
      </if> 
    </trim> group by CONTRACT_NO
  </select>
  <select id="selectByCriteria" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTargetCriteria">select TASK_ID, EMPLOYEE_ID, CONTRACT_NO, TARGET_NAME, TARGET_DESC, COMPLETE_SCORE, QUALITY_SCORE, CREATE_TIME, BEGIN_TIME, END_TIME, STATUS, VERIFY_ID, TASK_TYPE, COMPLETE_TIME, VERIFY_NAME, REMARK, VREMARK from tbl_task_target
    <if test="_parameter != null"> 
      <include refid="tbl_task_target.Criteria_Where_Clause"/>  
      <if test="orderByClause != null">order by ${orderByClause}</if> 
    </if> 
  </select>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Jun 23 14:49:19 CST 2015.
    --> select TASK_ID, EMPLOYEE_ID, CONTRACT_NO, TARGET_NAME, TARGET_DESC, COMPLETE_SCORE, QUALITY_SCORE, CREATE_TIME, BEGIN_TIME, END_TIME, STATUS, VERIFY_ID, TASK_TYPE, COMPLETE_TIME, VERIFY_NAME, REMARK, VREMARK from tbl_task_target where TASK_ID = #{taskId:VARCHAR}
  </select>
  <select id="selectByKey" resultMap="BaseResultMap" parameterType="java.lang.String"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Jun 23 14:49:19 CST 2015.
    --> select TASK_ID, EMPLOYEE_ID, CONTRACT_NO, TARGET_NAME, TARGET_DESC, COMPLETE_SCORE, QUALITY_SCORE, CREATE_TIME, BEGIN_TIME, END_TIME, STATUS, VERIFY_ID, TASK_TYPE, COMPLETE_TIME, VERIFY_NAME, REMARK, VREMARK from tbl_task_target where TASK_ID = #{taskId:VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Jun 23 14:49:19 CST 2015.
    --> delete from tbl_task_target where TASK_ID = #{taskId:VARCHAR}
  </delete>
  <delete id="deleteByCriteria" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTargetCriteria"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Jun 23 14:49:19 CST 2015.
    --> delete from tbl_task_target 
    <include refid="tbl_task_target.Criteria_Where_Clause"/> 
  </delete>
  <insert id="insert" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Jun 23 14:49:19 CST 2015.
    --> insert into tbl_task_target (TASK_ID, EMPLOYEE_ID, CONTRACT_NO, TARGET_NAME, TARGET_DESC, COMPLETE_SCORE, QUALITY_SCORE, CREATE_TIME, BEGIN_TIME, END_TIME, STATUS, VERIFY_ID, TASK_TYPE, COMPLETE_TIME, VERIFY_NAME, REMARK, VREMARK) values (#{taskId:VARCHAR}, #{employeeId:VARCHAR}, #{contractNo:VARCHAR}, #{targetName:VARCHAR}, #{targetDesc:VARCHAR}, #{completeScore:DECIMAL}, #{qualityScore:DECIMAL}, #{createTime:TIMESTAMP}, #{beginTime:TIMESTAMP}, #{endTime:TIMESTAMP}, #{status:CHAR}, #{verifyId:VARCHAR}, #{taskType:CHAR}, #{completeTime:VARCHAR}, #{verifyName:VARCHAR}, #{remark:VARCHAR}, #{vremark:VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Jun 23 14:49:19 CST 2015.
    --> insert into tbl_task_target 
    <trim prefix="("> 
      <if test="taskId != null">TASK_ID ,</if>  
      <if test="employeeId != null">EMPLOYEE_ID ,</if>  
      <if test="contractNo != null">CONTRACT_NO ,</if>  
      <if test="targetName != null">TARGET_NAME ,</if>  
      <if test="targetDesc != null">TARGET_DESC ,</if>  
      <if test="completeScore != null">COMPLETE_SCORE ,</if>  
      <if test="qualityScore != null">QUALITY_SCORE ,</if>  
      <if test="createTime != null">CREATE_TIME ,</if>  
      <if test="beginTime != null">BEGIN_TIME ,</if>  
      <if test="endTime != null">END_TIME ,</if>  
      <if test="status != null">STATUS ,</if>  
      <if test="verifyId != null">VERIFY_ID ,</if>  
      <if test="taskType != null">TASK_TYPE ,</if>  
      <if test="completeTime != null">COMPLETE_TIME ,</if>  
      <if test="verifyName != null">VERIFY_NAME ,</if>  
      <if test="remark != null">REMARK ,</if>  
      <if test="vremark != null">VREMARK ,</if> )
    </trim> values 
    <trim prefix="("> 
      <if test="taskId != null">#{taskId:VARCHAR} ,</if>  
      <if test="employeeId != null">#{employeeId:VARCHAR} ,</if>  
      <if test="contractNo != null">#{contractNo:VARCHAR} ,</if>  
      <if test="targetName != null">#{targetName:VARCHAR} ,</if>  
      <if test="targetDesc != null">#{targetDesc:VARCHAR} ,</if>  
      <if test="completeScore != null">#{completeScore:DECIMAL} ,</if>  
      <if test="qualityScore != null">#{qualityScore:DECIMAL} ,</if>  
      <if test="createTime != null">#{createTime:TIMESTAMP} ,</if>  
      <if test="beginTime != null">#{beginTime:TIMESTAMP} ,</if>  
      <if test="endTime != null">#{endTime:TIMESTAMP} ,</if>  
      <if test="status != null">#{status:CHAR} ,</if>  
      <if test="verifyId != null">#{verifyId:VARCHAR} ,</if>  
      <if test="taskType != null">#{taskType:CHAR} ,</if>  
      <if test="completeTime != null">#{completeTime:VARCHAR} ,</if>  
      <if test="verifyName != null">#{verifyName:VARCHAR} ,</if>  
      <if test="remark != null">#{remark:VARCHAR} ,</if>  
      <if test="vremark != null">#{vremark:VARCHAR} ,</if> )
    </trim> 
  </insert>
  <select id="countByCriteria" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTargetCriteria" resultType="java.lang.Integer"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Jun 23 14:49:19 CST 2015.
    --> select count(*) from tbl_task_target 
    <include refid="tbl_task_target.Criteria_Where_Clause"/> 
  </select>
  <update id="updateByCriteriaSelective"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Jun 23 14:49:19 CST 2015.
    --> update tbl_task_target 
    <trim prefix="set"> 
      <if test="record.taskId != null">TASK_ID = #{record.taskId:VARCHAR} ,</if>  
      <if test="record.employeeId != null">EMPLOYEE_ID = #{record.employeeId:VARCHAR} ,</if>  
      <if test="record.contractNo != null">CONTRACT_NO = #{record.contractNo:VARCHAR} ,</if>  
      <if test="record.targetName != null">TARGET_NAME = #{record.targetName:VARCHAR} ,</if>  
      <if test="record.targetDesc != null">TARGET_DESC = #{record.targetDesc:VARCHAR} ,</if>  
      <if test="record.completeScore != null">COMPLETE_SCORE = #{record.completeScore:DECIMAL} ,</if>  
      <if test="record.qualityScore != null">QUALITY_SCORE = #{record.qualityScore:DECIMAL} ,</if>  
      <if test="record.createTime != null">CREATE_TIME = #{record.createTime:TIMESTAMP} ,</if>  
      <if test="record.beginTime != null">BEGIN_TIME = #{record.beginTime:TIMESTAMP} ,</if>  
      <if test="record.endTime != null">END_TIME = #{record.endTime:TIMESTAMP} ,</if>  
      <if test="record.status != null">STATUS = #{record.status:CHAR} ,</if>  
      <if test="record.verifyId != null">VERIFY_ID = #{record.verifyId:VARCHAR} ,</if>  
      <if test="record.taskType != null">TASK_TYPE = #{record.taskType:CHAR} ,</if>  
      <if test="record.completeTime != null">COMPLETE_TIME = #{record.completeTime:VARCHAR} ,</if>  
      <if test="record.verifyName != null">VERIFY_NAME = #{record.verifyName:VARCHAR} ,</if>  
      <if test="record.remark != null">REMARK = #{record.remark:VARCHAR} ,</if>  
      <if test="record.vremark != null">VREMARK = #{record.vremark:VARCHAR} ,</if> 
    </trim>  
    <if test="_parameter != null"> 
      <include refid="tbl_task_target.Criteria_Where_Clause"/> 
    </if> 
  </update>
  <update id="updateByCriteria"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Jun 23 14:49:19 CST 2015.
    --> update tbl_task_target set TASK_ID = #{record.taskId:VARCHAR}, EMPLOYEE_ID = #{record.employeeId:VARCHAR}, CONTRACT_NO = #{record.contractNo:VARCHAR}, TARGET_NAME = #{record.targetName:VARCHAR}, TARGET_DESC = #{record.targetDesc:VARCHAR}, COMPLETE_SCORE = #{record.completeScore:DECIMAL}, QUALITY_SCORE = #{record.qualityScore:DECIMAL}, CREATE_TIME = #{record.createTime:TIMESTAMP}, BEGIN_TIME = #{record.beginTime:TIMESTAMP}, END_TIME = #{record.endTime:TIMESTAMP}, STATUS = #{record.status:CHAR}, VERIFY_ID = #{record.verifyId:VARCHAR}, TASK_TYPE = #{record.taskType:CHAR}, COMPLETE_TIME = #{record.completeTime:VARCHAR}, VERIFY_NAME = #{record.verifyName:VARCHAR}, REMARK = #{record.remark:VARCHAR}, VREMARK = #{record.vremark:VARCHAR}
    <if test="_parameter != null"> 
      <include refid="tbl_task_target.Criteria_Where_Clause"/> 
    </if> 
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Jun 23 14:49:19 CST 2015.
    --> update tbl_task_target 
    <trim prefix="set"> 
      <if test="employeeId != null">EMPLOYEE_ID = #{employeeId:VARCHAR} ,</if>  
      <if test="contractNo != null">CONTRACT_NO = #{contractNo:VARCHAR} ,</if>  
      <if test="targetName != null">TARGET_NAME = #{targetName:VARCHAR} ,</if>  
      <if test="targetDesc != null">TARGET_DESC = #{targetDesc:VARCHAR} ,</if>  
      <if test="completeScore != null">COMPLETE_SCORE = #{completeScore:DECIMAL} ,</if>  
      <if test="qualityScore != null">QUALITY_SCORE = #{qualityScore:DECIMAL} ,</if>  
      <if test="createTime != null">CREATE_TIME = #{createTime:TIMESTAMP} ,</if>  
      <if test="beginTime != null">BEGIN_TIME = #{beginTime:TIMESTAMP} ,</if>  
      <if test="endTime != null">END_TIME = #{endTime:TIMESTAMP} ,</if>  
      <if test="status != null">STATUS = #{status:CHAR} ,</if>  
      <if test="verifyId != null">VERIFY_ID = #{verifyId:VARCHAR} ,</if>  
      <if test="taskType != null">TASK_TYPE = #{taskType:CHAR} ,</if>  
      <if test="completeTime != null">COMPLETE_TIME = #{completeTime:VARCHAR} ,</if>  
      <if test="verifyName != null">VERIFY_NAME = #{verifyName:VARCHAR} ,</if>  
      <if test="remark != null">REMARK = #{remark:VARCHAR} ,</if>  
      <if test="vremark != null">VREMARK = #{vremark:VARCHAR} ,</if> 
    </trim> where TASK_ID = #{taskId:VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Jun 23 14:49:19 CST 2015.
    --> update tbl_task_target set EMPLOYEE_ID = #{employeeId:VARCHAR}, CONTRACT_NO = #{contractNo:VARCHAR}, TARGET_NAME = #{targetName:VARCHAR}, TARGET_DESC = #{targetDesc:VARCHAR}, COMPLETE_SCORE = #{completeScore:DECIMAL}, QUALITY_SCORE = #{qualityScore:DECIMAL}, CREATE_TIME = #{createTime:TIMESTAMP}, BEGIN_TIME = #{beginTime:TIMESTAMP}, END_TIME = #{endTime:TIMESTAMP}, STATUS = #{status:CHAR}, VERIFY_ID = #{verifyId:VARCHAR}, TASK_TYPE = #{taskType:CHAR}, COMPLETE_TIME = #{completeTime:VARCHAR}, VERIFY_NAME = #{verifyName:VARCHAR}, REMARK = #{remark:VARCHAR}, VREMARK = #{vremark:VARCHAR} where TASK_ID = #{taskId:VARCHAR}
  </update>
  <select id="selectTaskList" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">SELECT * FROM tbl_task_target WHERE TASK_TYPE = '2'
    <if test="employeeId != null and employeeId != ''">EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  
    <if test="createTime != null and createTime != ''"> 
      <!-- 计划任务导致 今日签到提示没有任务 bug  修改
       date_format(CREATE_TIME,'%Y-%m-%d') = date_format(sysdate(),'%Y-%m-%d')
      --> date_format(BEGIN_TIME,'%Y-%m-%d') = date_format(sysdate(),'%Y-%m-%d') and date_format(END_TIME,'%Y-%m-%d') = date_format(sysdate(),'%Y-%m-%d')
    </if>  
    <if test="status != null and status != ''">STATUS = #{status:CHAR}</if> order by TASK_ID asc
  </select>
  <select id="selectAplanTaskList" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">SELECT * FROM tbl_task_target WHERE TASK_TYPE = '3'
    <if test="employeeId != null and employeeId != ''">EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  
    <if test="status != null and status != ''">STATUS = #{status:CHAR}</if>  <![CDATA[
      and date_format(BEGIN_TIME,'%Y-%m-%d') = date_format(sysdate(),'%Y-%m-%d')
      and date_format(END_TIME,'%Y-%m-%d') = date_format(sysdate(),'%Y-%m-%d')
      ]]> order by TASK_ID asc
  </select>
  <select id="selectPersonDispatchTasks" resultMap="BaseResultMapExtra" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">SELECT task.* ,emp.employee_name FROM tbl_task_target task, tbl_employee_info emp WHERE task.TASK_TYPE = '1'
    <if test="verifyId != null and verifyId != ''">task.VERIFY_ID = #{verifyId:VARCHAR}</if> and task.employee_id =emp.employee_id 
    <if test="status != null and status != ''">task.STATUS = #{status:CHAR}</if> and date_format(task.END_TIME,'%Y-%m-%d %H:%i:%S') &gt;= date_format(sysdate(),'%Y-%m-%d %H:%i:%S')
  </select>
  <select id="selectPersonPlanTasks" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">SELECT * FROM tbl_task_target WHERE EMPLOYEE_ID = #{employeeId:VARCHAR} AND TASK_TYPE = '3'<![CDATA[
      and date_format(BEGIN_TIME,'%Y-%m-%d') > date_format(sysdate(),'%Y-%m-%d')
      ]]>  
    <if test="status != null and status != ''">STATUS = #{status:CHAR}</if> order by TASK_ID asc
  </select>
  <select id="selectPersonPlanTasksChange" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">SELECT * FROM tbl_task_target WHERE EMPLOYEE_ID = #{employeeId:VARCHAR} AND TASK_TYPE = '3'<![CDATA[
      and date_format(BEGIN_TIME,'%Y-%m-%d') = date_format(sysdate(),'%Y-%m-%d')
      and date_format(END_TIME,'%Y-%m-%d') = date_format(sysdate(),'%Y-%m-%d')
      ]]>  
    <if test="status != null and status != ''">STATUS = #{status:CHAR}</if> order by TASK_ID asc
  </select>
  <select id="selectAllTaskList" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">SELECT * FROM tbl_task_target WHERE EMPLOYEE_ID = #{employeeId:VARCHAR}
    <if test="createTime != null and createTime != ''">date_format(CREATE_TIME,'%Y-%m-%d') = date_format(#{createTime:TIMESTAMP},'%Y-%m-%d')</if>  
    <if test="taskType != null and taskType != ''">TASK_TYPE = #{taskType:VARCHAR}</if>  
    <if test="status != null and status != ''">STATUS = #{status:CHAR}</if> order by TASK_ID asc
  </select>
  <!--监控和签到查看任务 2016-08-24 新增查询任务 条件是开始时间和结束时间都是当日的任务 -->
  <select id="selectAllTaskListDayBetweenAndYesterday" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">SELECT * FROM tbl_task_target WHERE EMPLOYEE_ID = #{employeeId:VARCHAR}
    <if test="beginTime != null and beginTime != ''">date_format(BEGIN_TIME,'%Y-%m-%d') = date_format(#{beginTime:TIMESTAMP},'%Y-%m-%d')</if>  
    <if test="endTime != null and endTime != ''">date_format(END_TIME,'%Y-%m-%d') = date_format(#{endTime:TIMESTAMP},'%Y-%m-%d')</if>  
    <if test="taskType != null and taskType != ''">TASK_TYPE = #{taskType:VARCHAR}</if>  
    <if test="status != null and status != ''">STATUS = #{status:CHAR}</if> order by TASK_ID asc
  </select>
  <select id="selectAllTasks" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">SELECT * FROM tbl_task_target WHERE EMPLOYEE_ID = #{employeeId:VARCHAR}
    <if test="createTime != null and createTime != ''">date_format(CREATE_TIME,'%Y-%m-%d') = date_format(#{createTime:TIMESTAMP},'%Y-%m-%d')</if>  
    <if test="status != null and status != ''">STATUS = #{status:CHAR}</if> and TASK_TYPE in ('2','3') order by TASK_ID asc
  </select>
  <!-- 获取指派任务 -->
  <select id="selectDispatchTaskList" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">SELECT * FROM tbl_task_target WHERE EMPLOYEE_ID = #{employeeId:VARCHAR}
    <if test="createTime != null and createTime != ''">date_format(END_TIME,'%Y-%m-%d %H:%i:%S') &gt;= date_format(#{createTime:TIMESTAMP},'%Y-%m-%d %H:%i:%S')</if>  
    <if test="taskType != null and taskType != ''">TASK_TYPE = #{taskType:VARCHAR}</if>  
    <if test="status != null and status != ''">STATUS = #{status:CHAR}</if> order by TASK_ID asc
  </select>
  <select id="selectTasksAboveComplete" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">SELECT * FROM tbl_task_target WHERE TASK_TYPE = '2' and STATUS in ('2','3')
    <if test="employeeId != null and employeeId != ''">EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  
    <if test="createTime != null and createTime != ''">date_format(CREATE_TIME,'%Y-%m-%d') = date_format(sysdate(),'%Y-%m-%d')</if> order by TASK_ID asc
  </select>
  <select id="selectPlanTasksAboveComplete" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">SELECT * FROM tbl_task_target WHERE TASK_TYPE = '3' and STATUS in ('2','3')
    <if test="employeeId != null and employeeId != ''">EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  <![CDATA[
      and date_format(BEGIN_TIME,'%Y-%m-%d') = date_format(sysdate(),'%Y-%m-%d')
      and date_format(END_TIME,'%Y-%m-%d') = date_format(sysdate(),'%Y-%m-%d')
      ]]> order by TASK_ID asc
  </select>
  <select id="selectLastPlanTasksAboveComplete" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">SELECT * FROM tbl_task_target WHERE TASK_TYPE = '3' and STATUS in ('2','3')
    <if test="employeeId != null and employeeId != ''">EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  
    <if test="createTime != null and createTime != ''"> <![CDATA[
        date_format(BEGIN_TIME,'%Y-%m-%d') = date_format(date_sub(curdate(),interval 1 day),'%Y-%m-%d')
   		and date_format(END_TIME,'%Y-%m-%d') = date_format(date_sub(curdate(),interval 1 day),'%Y-%m-%d')
      ]]> </if> order by TASK_ID asc
  </select>
  <select id="selectTasksAboveCompleteByKeys" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">SELECT * FROM tbl_task_target WHERE TASK_TYPE = '2' and STATUS in ('2','3')
    <if test="employeeId != null and employeeId != ''">EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  
    <if test="createTime != null and createTime != ''"> <![CDATA[
      		date_format(BEGIN_TIME,'%Y-%m-%d') = date_format(date_sub(curdate(),interval 1 day),'%Y-%m-%d')
    		and date_format(END_TIME,'%Y-%m-%d') = date_format(date_sub(curdate(),interval 1 day),'%Y-%m-%d')
      		]]> </if> order by TASK_ID asc
  </select>
  <select id="selectTasksUnFinish" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">SELECT * FROM tbl_task_target WHERE TASK_TYPE = '2' and STATUS in ('0','1')
    <if test="employeeId != null and employeeId != ''">EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  
    <if test="createTime != null and createTime != ''">date_format(CREATE_TIME,'%Y-%m-%d') = date_format(sysdate(),'%Y-%m-%d')</if> order by TASK_ID asc
  </select>
  <select id="selectPlanTasksUnFinish" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">SELECT * FROM tbl_task_target WHERE TASK_TYPE = '3' and STATUS in ('0','1')
    <if test="employeeId != null and employeeId != ''">EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  <![CDATA[
      and date_format(BEGIN_TIME,'%Y-%m-%d') = date_format(sysdate(),'%Y-%m-%d')
      and date_format(END_TIME,'%Y-%m-%d') = date_format(sysdate(),'%Y-%m-%d')
      ]]> order by TASK_ID asc
  </select>
  <select id="selectLastPlanTasksUnFinish" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">SELECT * FROM tbl_task_target WHERE TASK_TYPE = '3' and STATUS in ('0','1')
    <if test="employeeId != null and employeeId != ''">EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  <![CDATA[
       and date_format(BEGIN_TIME,'%Y-%m-%d') = date_format(date_sub(curdate(),interval 1 day),'%Y-%m-%d')
       and date_format(END_TIME,'%Y-%m-%d') = date_format(date_sub(curdate(),interval 1 day),'%Y-%m-%d')
      ]]> order by TASK_ID asc
  </select>
  <select id="selectTasksUnFinishByKeys" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">SELECT * FROM tbl_task_target WHERE TASK_TYPE = '2' and STATUS in ('0','1')
    <if test="employeeId != null and employeeId != ''">EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  
    <if test="createTime != null and createTime != ''"> <![CDATA[
      		date_format(BEGIN_TIME,'%Y-%m-%d') = date_format(date_sub(curdate(),interval 1 day),'%Y-%m-%d')
    		and date_format(END_TIME,'%Y-%m-%d') = date_format(date_sub(curdate(),interval 1 day),'%Y-%m-%d')
      		]]> </if> order by TASK_ID asc
  </select>
  <select id="selectTaskTarget" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">select * from tbl_task_target task where task.TASK_TYPE = '2'
    <if test="properties.queryDate != null and properties.queryDate != ''">and date_format(task.begin_time,'%Y-%m-%d')= #{properties.queryDate:VARCHAR}</if>  
    <trim prefix=" AND task.employee_id IN "> 
      <if test="properties != null"> 
        <if test="properties.employeeIdList != null"> 
          <iterate property="properties.employeeIdList" open="(" close=")" conjunction=",">#{properties.employeeIdList[]}</iterate> 
        </if> 
      </if> 
    </trim> 
  </select>
  <!-- 查询员工作任务数量 监控系统使用 -->
  <select id="selectSignPointsByTaskEmployeeIdTask" resultMap="BaseResultMapTask" parameterType="com.i2shopping.i2work.operation.core.task.model.TaskTarget">select <![CDATA[ date_format(ts.create_time,'%Y-%m-%d') ]]> as taskChartDates,count(ts.create_time) as taskChartCount from tbl_task_target as ts where ts.status in (2,3) 
    <if test="employeeId != null and employeeId != ''">ts.EMPLOYEE_ID = #{employeeId:VARCHAR}</if>  
    <if test="contractNo != null and contractNo != ''">ts.CONTRACT_NO = #{contractNo:VARCHAR}</if>  
    <if test="properties.beginTime != null and properties.beginTime != ''">and date_format(ts.create_time,'%Y-%m-%d')&gt;= #{properties.beginTime:VARCHAR}</if>  
    <if test="properties.endTime != null and properties.endTime != ''">and date_format(ts.create_time,'%Y-%m-%d')&lt; #{properties.endTime:VARCHAR}</if> GROUP BY date_format(ts.create_time,'%Y-%m-%d') ORDER BY ts.create_time ASC
  </select>
</mapper>

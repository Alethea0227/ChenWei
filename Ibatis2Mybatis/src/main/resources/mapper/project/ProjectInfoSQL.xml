<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="tbl_project_info">
  <resultMap id="BaseResultMap" type="com.i2shopping.i2work.operation.core.project.model.ProjectInfo">
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Mon Jun 22 11:31:33 CST 2015.
        -->
    <result column="contract_no" property="contractNo" jdbcType="VARCHAR"/>
    <result column="project_name" property="projectName" jdbcType="VARCHAR"/>
    <result column="labour_budget" property="labourBudget" jdbcType="DECIMAL"/>
    <result column="fee_budget" property="feeBudget" jdbcType="DECIMAL"/>
    <result column="sales_budget" property="salesBudget" jdbcType="DECIMAL"/>
    <result column="contract_amount" property="contractAmount" jdbcType="DECIMAL"/>
    <result column="project_valid_amount" property="projectValidAmount" jdbcType="DECIMAL"/>
    <result column="business_fee" property="businessFee" jdbcType="DECIMAL"/>
    <result column="plan_start_date" property="planStartDate" jdbcType="DATE"/>
    <result column="plan_end_date" property="planEndDate" jdbcType="DATE"/>
    <result column="department_id" property="departmentId" jdbcType="CHAR"/>
    <result column="standwork_starttime" property="standworkStarttime" jdbcType="VARCHAR"/>
    <result column="standwork_endtime" property="standworkEndtime" jdbcType="VARCHAR"/>
    <result column="STATUS" property="status" jdbcType="CHAR"/>
    <result column="EMPLOYEE_ID" property="employeeId" jdbcType="VARCHAR"/>
    <result column="PROJECT_DETAIL" property="projectDetail" jdbcType="VARCHAR"/>
    <result column="COMPANY_ID" property="companyId" jdbcType="VARCHAR"/>
    <result column="LONGITUDE" property="longitude" jdbcType="VARCHAR"/>
    <result column="LATITUDE" property="latitude" jdbcType="VARCHAR"/>
    <result column="SHORT_PROJECT_NAME" property="shortProjectName" jdbcType="VARCHAR"/>
    <result column="RADIUS" property="radius" jdbcType="VARCHAR"/>
    <result column="project_actual_no" property="projectActualNo" jdbcType="VARCHAR"/>
  </resultMap>
  <resultMap id="resultMapExt" extends="BaseResultMap" type="com.i2shopping.i2work.operation.core.project.model.ProjectInfo">
    <result column="plan_warn_signin_start_date" property="signInStartDate" jdbcType="VARCHAR"/>
    <result column="plan_warn_signout_end_date" property="signOutStartDate" jdbcType="VARCHAR"/>
    <association property="departmentInfo" select="tbl_department_info.selectByDepartmentId" column="department_id"/>
    <association property="employeeInfo" select="tbl_employee_info.selectByEmployeeId" column="EMPLOYEE_ID"/>
    <association property="company" select="tbl_company.selectByCompanyId" column="COMPANY_ID"/>
  </resultMap>
  <resultMap id="resultMapExtt" extends="resultMapExt" type="com.i2shopping.i2work.operation.core.project.model.ProjectInfo">
    <result column="EMPLOYEE_NAME" property="employeeName" jdbcType="VARCHAR"/>
    <result column="empName" property="empName" jdbcType="VARCHAR"/>
  </resultMap>
  <resultMap id="BaseResultMapEmp" extends="BaseResultMap" type="com.i2shopping.i2work.operation.core.project.model.ProjectInfo">
    <result column="EMPLOYEE_NAME" property="employeeName" jdbcType="VARCHAR"/>
    <result column="MOBILE" property="mobile" jdbcType="CHAR"/>
  </resultMap>
  <resultMap id="SimpleMap" type="com.i2shopping.i2work.operation.core.project.model.ProjectInfoVo">
    <result column="contract_no" property="contractNo" jdbcType="VARCHAR"/>
    <result column="project_name" property="projectName" jdbcType="VARCHAR"/>
    <result column="department_id" property="departmentId" jdbcType="VARCHAR"/>
    <result column="project_actual_no" property="projectActualNo" jdbcType="VARCHAR"/>
  </resultMap>
  <sql id="project_Where_Clause"> 
    <if test="departmentId != null and departmentId != ''">and TBL_PROJECT_INFO.department_id = #{departmentId:VARCHAR}</if>  
    <if test="companyId != null and companyId != ''">and TBL_PROJECT_INFO.COMPANY_ID = #{companyId:VARCHAR}</if>  
    <if test="projectName != null and projectName != ''">and TBL_PROJECT_INFO.project_name like concat('%', #{projectName:VARCHAR}, '%')</if> 
  </sql>
  <sql id="Criteria_Where_Clause"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Mon Jun 22 11:31:33 CST 2015.
        -->  
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate"> 
      <if test="oredCriteria[].valid!= null and oredCriteria[].valid == 'true'.toString()">( 
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and">$oredCriteria[].criteriaWithoutValue[]$</iterate>  
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and">$oredCriteria[].criteriaWithSingleValue[].condition$ #{oredCriteria[].criteriaWithSingleValue[].value}</iterate>  
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and">$oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction=",">#{oredCriteria[].criteriaWithListValue[].values[]}</iterate> 
        </iterate>  
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and">$oredCriteria[].criteriaWithBetweenValue[].condition$ #{oredCriteria[].criteriaWithBetweenValue[].values[0]} and #{oredCriteria[].criteriaWithBetweenValue[].values[1]}</iterate> )
      </if> 
    </iterate> 
  </sql>
  <select id="selectByCriteria" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfoCriteria"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Mon Jun 22 11:31:33 CST 2015.
        --> select * from tbl_project_info
    <if test="_parameter != null"> 
      <include refid="tbl_project_info.Criteria_Where_Clause"/>  
      <if test="orderByClause != null">order by ${orderByClause}</if> 
    </if> 
  </select>
  <!-- 查询项目经理详细信息 -->
  <select id="selectByProjectInfoEmp" resultMap="BaseResultMapEmp" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo">select pro.*, emp.employee_name, emp.mobile from tbl_project_info pro, tbl_employee_info emp where pro.employee_id = emp.employee_id and contract_no = #{contractNo:VARCHAR}</select>
  <select id="selectByPrimaryKey" resultMap="resultMapExt" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Mon Jun 22 11:31:33 CST 2015.
        --> select * from tbl_project_info where contract_no = #{contractNo:VARCHAR}
  </select>
  <select id="selectByPrimaryKeyS" resultMap="resultMapExt" parameterType="java.lang.String">select * from tbl_project_info where contract_no = #{value :VARCHAR}</select>
  <delete id="deleteByPrimaryKey" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Mon Jun 22 11:31:33 CST 2015.
        --> delete from tbl_project_info where contract_no = #{contractNo:VARCHAR}
  </delete>
  <delete id="deleteByCriteria" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfoCriteria"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Mon Jun 22 11:31:33 CST 2015.
        --> delete from tbl_project_info 
    <include refid="tbl_project_info.Criteria_Where_Clause"/> 
  </delete>
  <insert id="insert" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Mon Jun 22 11:31:33 CST 2015.
        --> insert into tbl_project_info (contract_no, project_name, short_project_name,labour_budget, fee_budget, sales_budget, contract_amount, project_valid_amount, business_fee, plan_start_date, plan_end_date, department_id, standwork_starttime, standwork_endtime, STATUS, EMPLOYEE_ID ,PROJECT_DETAIL,COMPANY_ID,LONGITUDE,LATITUDE,RADIUS,project_actual_no,plan_warn_signin_start_date,plan_warn_signout_end_date) values (#{contractNo:VARCHAR}, #{projectName:VARCHAR}, #{shortProjectName},#{labourBudget:DECIMAL}, #{feeBudget:DECIMAL}, #{salesBudget:DECIMAL}, #{contractAmount:DECIMAL}, #{projectValidAmount:DECIMAL}, #{businessFee:DECIMAL}, #{planStartDate:DATE}, #{planEndDate:DATE}, #{departmentId:CHAR}, #{standworkStarttime:VARCHAR}, #{standworkEndtime:VARCHAR}, #{status:CHAR}, #{employeeId:VARCHAR},#{projectDetail:VARCHAR},#{companyId:VARCHAR},#{longitude:VARCHAR} ,#{latitude:VARCHAR},#{radius:VARCHAR},#{projectActualNo:VARCHAR},#{signInStartDate:VARCHAR},#{signOutStartDate:VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Mon Jun 22 11:31:33 CST 2015.
        --> insert into tbl_project_info 
    <trim prefix="("> 
      <if test="contractNo != null">contract_no ,</if>  
      <if test="projectName != null">project_name ,</if>  
      <if test="shortProjectName != null">short_project_name ,</if>  
      <if test="labourBudget != null">labour_budget ,</if>  
      <if test="feeBudget != null">fee_budget ,</if>  
      <if test="salesBudget != null">sales_budget ,</if>  
      <if test="contractAmount != null">contract_amount ,</if>  
      <if test="projectValidAmount != null">project_valid_amount ,</if>  
      <if test="businessFee != null">business_fee ,</if>  
      <if test="planStartDate != null">plan_start_date ,</if>  
      <if test="planEndDate != null">plan_end_date ,</if>  
      <if test="departmentId != null">department_id ,</if>  
      <if test="standworkStarttime != null">standwork_starttime ,</if>  
      <if test="standworkEndtime != null">standwork_endtime ,</if>  
      <if test="status != null">STATUS ,</if>  
      <if test="employeeId != null">EMPLOYEE_ID ,</if>  
      <if test="projectDetail != null">PROJECT_DETAIL ,</if>  
      <if test="companyId != null">COMPANY_ID ,</if>  
      <if test="longitude != null">LONGITUDE ,</if>  
      <if test="latitude != null">LATITUDE ,</if>  
      <if test="radius != null">RADIUS ,</if>  
      <if test="projectActualNo != null">project_actual_no ,</if> )
    </trim> values 
    <trim prefix="("> 
      <if test="contractNo != null">#{contractNo:VARCHAR} ,</if>  
      <if test="projectName != null">#{projectName:VARCHAR} ,</if>  
      <if test="shortProjectName != null">#{shortProjectName:VARCHAR} ,</if>  
      <if test="labourBudget != null">#{labourBudget:DECIMAL} ,</if>  
      <if test="feeBudget != null">#{feeBudget:DECIMAL} ,</if>  
      <if test="salesBudget != null">#{salesBudget:DECIMAL} ,</if>  
      <if test="contractAmount != null">#{contractAmount:DECIMAL} ,</if>  
      <if test="projectValidAmount != null">#{projectValidAmount:DECIMAL} ,</if>  
      <if test="businessFee != null">#{businessFee:DECIMAL} ,</if>  
      <if test="planStartDate != null">#{planStartDate:DATE} ,</if>  
      <if test="planEndDate != null">#{planEndDate:DATE} ,</if>  
      <if test="departmentId != null">#{departmentId:CHAR} ,</if>  
      <if test="standworkStarttime != null">#{standworkStarttime:VARCHAR} ,</if>  
      <if test="standworkEndtime != null">#{standworkEndtime:VARCHAR} ,</if>  
      <if test="status != null">#{status:CHAR} ,</if>  
      <if test="employeeId != null">#{employeeId:VARCHAR} ,</if>  
      <if test="projectDetail != null">#{projectDetail:VARCHAR} ,</if>  
      <if test="companyId != null">#{companyId:VARCHAR} ,</if>  
      <if test="longitude != null">#{longitude:VARCHAR} ,</if>  
      <if test="latitude != null">#{latitude:VARCHAR} ,</if>  
      <if test="radius != null">#{radius:VARCHAR} ,</if>  
      <if test="projectActualNo != null">#{projectActualNo:VARCHAR} ,</if> )
    </trim> 
  </insert>
  <select id="countByCriteria" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfoCriteria" resultType="java.lang.Integer"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Mon Jun 22 11:31:33 CST 2015.
        --> select count(*) from tbl_project_info 
    <include refid="tbl_project_info.Criteria_Where_Clause"/> 
  </select>
  <update id="updateByCriteriaSelective"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Mon Jun 22 11:31:33 CST 2015.
        --> update tbl_project_info 
    <trim prefix="set"> 
      <if test="record.contractNo != null">contract_no = #{record.contractNo:VARCHAR} ,</if>  
      <if test="record.projectName != null">project_name = #{record.projectName:VARCHAR} ,</if>  
      <if test="record.shortProjectName != null">short_project_name = #{record.shortProjectName:VARCHAR} ,</if>  
      <if test="record.labourBudget != null">labour_budget = #{record.labourBudget:DECIMAL} ,</if>  
      <if test="record.feeBudget != null">fee_budget = #{record.feeBudget:DECIMAL} ,</if>  
      <if test="record.salesBudget != null">sales_budget = #{record.salesBudget:DECIMAL} ,</if>  
      <if test="record.contractAmount != null">contract_amount = #{record.contractAmount:DECIMAL} ,</if>  
      <if test="record.projectValidAmount != null">project_valid_amount = #{record.projectValidAmount:DECIMAL} ,</if>  
      <if test="record.businessFee != null">business_fee = #{record.businessFee:DECIMAL} ,</if>  
      <if test="record.planStartDate != null">plan_start_date = #{record.planStartDate:DATE} ,</if>  
      <if test="record.planEndDate != null">plan_end_date = #{record.planEndDate:DATE} ,</if>  
      <if test="record.departmentId != null">department_id = #{record.departmentId:CHAR} ,</if>  
      <if test="record.standworkStarttime != null">standwork_starttime = #{record.standworkStarttime:VARCHAR} ,</if>  
      <if test="record.standworkEndtime != null">standwork_endtime = #{record.standworkEndtime:VARCHAR} ,</if>  
      <if test="record.status != null">STATUS = #{record.status:CHAR} ,</if>  
      <if test="record.employeeId != null">EMPLOYEE_ID = #{record.employeeId:VARCHAR} ,</if>  
      <if test="record.projectDetail != null">PROJECT_DETAIL = #{record.projectDetail:VARCHAR} ,</if>  
      <if test="record.companyId != null">COMPANY_ID = #{record.companyId:VARCHAR} ,</if>  
      <if test="record.latitude != null">LATITUDE = #{record.latitude:VARCHAR} ,</if>  
      <if test="record.longitude != null">LONGITUDE = #{record.longitude:VARCHAR} ,</if>  
      <if test="record.radius != null">RADIUS = #{record.radius:VARCHAR} ,</if>  
      <if test="record.projectActualNo != null">project_actual_no = #{record.projectActualNo:VARCHAR} ,</if> 
    </trim>  
    <if test="_parameter != null"> 
      <include refid="tbl_project_info.Criteria_Where_Clause"/> 
    </if> 
  </update>
  <update id="updateByCriteria"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Mon Jun 22 11:31:33 CST 2015.
        --> update tbl_project_info set contract_no = #{record.contractNo:VARCHAR}, project_name = #{record.projectName:VARCHAR}, short_project_name = #{record.shortProjectName:VARCHAR}, labour_budget = #{record.labourBudget:DECIMAL}, fee_budget = #{record.feeBudget:DECIMAL}, sales_budget = #{record.salesBudget:DECIMAL}, contract_amount = #{record.contractAmount:DECIMAL}, project_valid_amount = #{record.projectValidAmount:DECIMAL}, business_fee = #{record.businessFee:DECIMAL}, plan_start_date = #{record.planStartDate:DATE}, plan_end_date = #{record.planEndDate:DATE}, department_id = #{record.departmentId:CHAR}, standwork_starttime = #{record.standworkStarttime:VARCHAR}, standwork_endtime = #{record.standworkEndtime:VARCHAR}, STATUS = #{record.status:CHAR}, EMPLOYEE_ID = #{record.employeeId:VARCHAR}, PROJECT_DETAIL = #{record.projectDetail:VARCHAR}, COMPANY_ID = #{record.companyId:VARCHAR}, LONGITUDE = #{record.longitude:VARCHAR}, LATITUDE = #{record.latitude:VARCHAR}, RADIUS = #{record.radius:VARCHAR}, project_actual_no = #{record.projectActualNo:VARCHAR}
    <if test="_parameter != null"> 
      <include refid="tbl_project_info.Criteria_Where_Clause"/> 
    </if> 
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Mon Jun 22 11:31:33 CST 2015.
        --> update tbl_project_info 
    <trim prefix="set"> 
      <if test="projectName != null">project_name = #{projectName:VARCHAR} ,</if>  
      <if test="shortProjectName != null">short_project_name = #{shortProjectName:VARCHAR} ,</if>  
      <if test="labourBudget != null">labour_budget = #{labourBudget:DECIMAL} ,</if>  
      <if test="feeBudget != null">fee_budget = #{feeBudget:DECIMAL} ,</if>  
      <if test="salesBudget != null">sales_budget = #{salesBudget:DECIMAL} ,</if>  
      <if test="contractAmount != null">contract_amount = #{contractAmount:DECIMAL} ,</if>  
      <if test="projectValidAmount != null">project_valid_amount = #{projectValidAmount:DECIMAL} ,</if>  
      <if test="businessFee != null">business_fee = #{businessFee:DECIMAL} ,</if>  
      <if test="planStartDate != null">plan_start_date = #{planStartDate:DATE} ,</if>  
      <if test="planEndDate != null">plan_end_date = #{planEndDate:DATE} ,</if>  
      <if test="departmentId != null">department_id = #{departmentId:CHAR} ,</if>  
      <if test="standworkStarttime != null">standwork_starttime = #{standworkStarttime:VARCHAR} ,</if>  
      <if test="standworkEndtime != null">standwork_endtime = #{standworkEndtime:VARCHAR} ,</if>  
      <if test="status != null">STATUS = #{status:CHAR} ,</if>  
      <if test="employeeId != null">EMPLOYEE_ID = #{employeeId:VARCHAR} ,</if>  
      <if test="projectDetail != null">PROJECT_DETAIL = #{projectDetail:VARCHAR} ,</if>  
      <if test="companyId != null">COMPANY_ID = #{companyId:VARCHAR} ,</if>  
      <if test="longitude != null">LONGITUDE = #{longitude:VARCHAR} ,</if>  
      <if test="latitude != null">LATITUDE = #{latitude:VARCHAR} ,</if>  
      <if test="radius != null">RADIUS = #{radius:VARCHAR} ,</if>  
      <if test="projectActualNo != null">project_actual_no = #{projectActualNo:VARCHAR} ,</if> 
    </trim> where contract_no = #{contractNo:VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo"> 
    <!--
          WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
          This element was generated on Mon Jun 22 11:31:33 CST 2015.
        --> update tbl_project_info set project_name = #{projectName:VARCHAR}, short_project_name = #{shortProjectName:VARCHAR}, labour_budget = #{labourBudget:DECIMAL}, fee_budget = #{feeBudget:DECIMAL}, sales_budget = #{salesBudget:DECIMAL}, contract_amount = #{contractAmount:DECIMAL}, project_valid_amount = #{projectValidAmount:DECIMAL}, business_fee = #{businessFee:DECIMAL}, plan_start_date = #{planStartDate:DATE}, plan_end_date = #{planEndDate:DATE}, department_id = #{departmentId:CHAR}, standwork_starttime = #{standworkStarttime:VARCHAR}, standwork_endtime = #{standworkEndtime:VARCHAR}, STATUS = #{status:CHAR}, EMPLOYEE_ID = #{employeeId:VARCHAR}, PROJECT_DETAIL = #{projectDetail:VARCHAR}, COMPANY_ID = #{companyId:VARCHAR}, LONGITUDE = #{longitude:VARCHAR}, LATITUDE = #{latitude:VARCHAR}, RADIUS = #{radius:VARCHAR}, project_actual_no = #{projectActualNo:VARCHAR}, plan_warn_signin_start_date = #{signInStartDate:VARCHAR}, plan_warn_signout_end_date = #{signOutStartDate:VARCHAR} where contract_no = #{contractNo:VARCHAR}
  </update>
  <select id="selectProjectListByEmployeeId" resultMap="resultMapExt" parameterType="java.lang.String">select o.* from tbl_project_info o,tbl_project_etc tc where o.contract_no = tc.contract_no and tc.employee_id= #{value:VARCHAR} and tc.is_leave='00'</select>
  <select id="selectProjectByEmployeeId" resultMap="BaseResultMap" parameterType="java.lang.String">select o.* from tbl_project_info o,tbl_project_etc tc where o.contract_no = tc.contract_no and tc.employee_id= #{value:VARCHAR} and tc.is_leave='00'</select>
  <select id="selectByProjectInfo" resultMap="resultMapExt" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo">SELECT * FROM tbl_project_info
    <trim prefix="where"> 
      <include refid="tbl_project_info.project_Where_Clause"/> 
    </trim> 
  </select>
  <select id="countByProjectInfo" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo">SELECT count(1) FROM tbl_project_info
    <trim prefix="where"> 
      <include refid="tbl_project_info.project_Where_Clause"/> 
    </trim> 
  </select>
  <!-- 2016年8月10日 添加查询项目 执行周期  该方法特殊请看清出语句在使用-->
  <select id="selectByProjectInfoByPageStatByTimer" resultMap="resultMapExt" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo">SELECT * FROM tbl_project_info pi
    <trim prefix="where"> 
      <if test="departmentId != null">and pi.department_id = #{departmentId:VARCHAR}</if>  
      <if test="companyId != null">and pi.COMPANY_ID = #{companyId:VARCHAR}</if>  
      <if test="projectName != null">and pi.project_name like concat('%', #{projectName:VARCHAR}, '%')</if>  
      <!-- 项目无效    项目结束时间小于当前日期 没有多余字段直接使用 planStartDate 作为结束时间 -->  
      <if test="planStartDate != null">and pi.plan_end_date &lt;= date_format(#{planStartDate:DATE},'%Y-%m-%d')</if>  
      <!-- 项目有效  项目结束时间大于当前时间 -->  
      <if test="planEndDate != null">and pi.plan_end_date &gt;= date_format(#{planEndDate:DATE},'%Y-%m-%d')</if> 
    </trim> 
  </select>
  <!-- 2016年8月10日 添加查询项目 执行周期  该方法特殊请看清出语句在使用-->
  <select id="selectByProjectInfoByPageStatByTimerr" resultMap="resultMapExtt" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo"> 
    <!--SELECT ei.EMPLOYEE_NAME,ei.EMPLOYEE_ID,pe.contract_no,pi.*-->  
    <!--FROM tbl_employee_info ei,tbl_project_etc pe,tbl_project_info pi-->  
    <!--WHERE  ei.EMPLOYEE_ID = pe.employee_id-->  
    <!--AND pi.contract_no = pe.contract_no-->  
    <!--<dynamic>-->  
    <!--<isNotNull property="departmentId" prepend="and">-->  
    <!--pi.department_id = #{departmentId:VARCHAR}-->  
    <!--</isNotNull>-->  
    <!--<isNotNull property="companyId" prepend="and">-->  
    <!--pi.COMPANY_ID = #{companyId:VARCHAR}-->  
    <!--</isNotNull>-->  
    <!--<isNotNull property="projectName" prepend="and">-->  
    <!--pi.project_name like concat('%', #{projectName:VARCHAR}, '%')-->  
    <!--</isNotNull>-->  
    <!--<isNotNull property="employeeName" prepend="and">-->  
    <!--ei.EMPLOYEE_NAME like concat('%', #{employeeName:VARCHAR}, '%')-->  
    <!--</isNotNull>-->  
    <!--&lt;!&ndash; 项目无效    项目结束时间小于当前日期 没有多余字段直接使用 planStartDate 作为结束时间 &ndash;&gt;-->  
    <!--<isNotNull property="planStartDate" prepend="and">-->  
    <!--<![CDATA[-->  
    <!--pi.plan_end_date <= date_format(#{planStartDate:DATE},'%Y-%m-%d')-->  
    <!--]]>-->  
    <!--</isNotNull>-->  
    <!--&lt;!&ndash; 项目有效  项目结束时间大于当前时间 &ndash;&gt;-->  
    <!--<isNotNull property="planEndDate" prepend="and">-->  
    <!--<![CDATA[-->  
    <!--pi.plan_end_date >= date_format(#{planEndDate:DATE},'%Y-%m-%d')-->  
    <!--]]>-->  
    <!--</isNotNull>-->  
    <!--</dynamic>--> SELECT tbl.*,ei.EMPLOYEE_NAME FROM (SELECT ei.EMPLOYEE_NAME AS empName, ei.EMPLOYEE_ID empId, pe.contract_no conNo, pi.* FROM tbl_employee_info ei, tbl_project_etc pe, tbl_project_info pi WHERE ei.EMPLOYEE_ID = pe.employee_id AND pi.contract_no = pe.contract_no AND ei.EMPLOYEE_NAME like concat('%', #{employeeName:VARCHAR}, '%')) tbl LEFT JOIN tbl_employee_info ei on tbl.EMPLOYEE_ID = ei.EMPLOYEE_ID
  </select>
  <!-- 2016年8月10日 添加查询项目 执行周期 -->
  <select id="countByProjectInfoStatByTimer" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo">SELECT count(1) FROM tbl_project_info pi,tbl_project_etc pe where pe.contract_no = pi.contract_no
    <trim> 
      <if test="departmentId != null">and pi.department_id = #{departmentId:VARCHAR}</if>  
      <if test="companyId != null">and pi.COMPANY_ID = #{companyId:VARCHAR}</if>  
      <if test="projectName != null">and pi.project_name like concat('%', #{projectName:VARCHAR}, '%')</if>  
      <!-- 项目无效    项目结束时间小于当前日期 没有多余字段直接使用 planStartDate 作为结束时间 -->  
      <if test="planStartDate != null">and pi.plan_end_date &lt;= date_format(#{planStartDate:DATE},'%Y-%m-%d')</if>  
      <!-- 项目有效  项目结束时间大于当前时间 -->  
      <if test="planEndDate != null">and pi.plan_end_date &gt;= date_format(#{planEndDate:DATE},'%Y-%m-%d')</if> 
    </trim> 
  </select>
  <select id="countByProjectInfoStatByTimerr" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo">SELECT count(1) FROM tbl_project_info pi,tbl_employee_info ei,tbl_project_etc pe where ei.EMPLOYEE_ID = pe.employee_id AND pe.contract_no = pi.contract_no
    <trim> 
      <if test="departmentId != null">and pi.department_id = #{departmentId:VARCHAR}</if>  
      <if test="companyId != null">and pi.COMPANY_ID = #{companyId:VARCHAR}</if>  
      <if test="projectName != null">and pi.project_name like concat('%', #{projectName:VARCHAR}, '%')</if>  
      <if test="employeeName != null">and ei.EMPLOYEE_NAME like concat('%', #{employeeName:VARCHAR}, '%')</if>  
      <!-- 项目无效    项目结束时间小于当前日期 没有多余字段直接使用 planStartDate 作为结束时间 -->  
      <if test="planStartDate != null">and pi.plan_end_date &lt;= date_format(#{planStartDate:DATE},'%Y-%m-%d')</if>  
      <!-- 项目有效  项目结束时间大于当前时间 -->  
      <if test="planEndDate != null">and pi.plan_end_date &gt;= date_format(#{planEndDate:DATE},'%Y-%m-%d')</if> 
    </trim> 
  </select>
  <!--查询项目 区分地区和公司 -->
  <select id="selectByProjectInfoByPageStatByAREA" resultMap="resultMapExt" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo">SELECT * FROM tbl_project_info pi ,tbl_department_info dep where dep.DEPARTMENT_ID = pi.department_id
    <if test="area != null">and dep.area = #{area:VARCHAR}</if>  
    <if test="departmentId != null">and pi.department_id = #{departmentId:VARCHAR}</if>  
    <if test="companyId != null">and pi.COMPANY_ID = #{companyId:VARCHAR}</if>  
    <if test="projectName != null">and pi.project_name like concat('%', #{projectName:VARCHAR}, '%')</if>  
    <!-- 项目无效    项目结束时间小于当前日期 没有多余字段直接使用 planStartDate 作为结束时间 -->  
    <if test="planStartDate != null">and pi.plan_end_date &lt;= date_format(#{planStartDate:DATE},'%Y-%m-%d')</if>  
    <!-- 项目有效  项目结束时间大于当前时间 -->  
    <if test="planEndDate != null">and pi.plan_end_date &gt;= date_format(#{planEndDate:DATE},'%Y-%m-%d')</if>  
    <if test="array != null">
      <iterate property="array" close=")" open="(" conjunction=","> <![CDATA[ #{array[]} ]]> </iterate> and pi.contract_no in
    </if> 
  </select>
  <!--查询项目 区分地区和公司 -->
  <select id="selectByProjectInfoByPageStatByAREAA" resultMap="resultMapExtt" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo"> 
    <!--SELECT ei.EMPLOYEE_NAME,pi.*,dep.*-->  
    <!--FROM tbl_project_info pi ,tbl_department_info dep ,tbl_employee_info ei ,tbl_project_etc pe-->  
    <!--where dep.DEPARTMENT_ID = pi.department_id-->  
    <!--AND ei.EMPLOYEE_ID = pe.employee_id-->  
    <!--AND pe.contract_no = pi.contract_no-->  
    <!--<isNotNull property="area" prepend="and">-->  
    <!--dep.area = #{area:VARCHAR}-->  
    <!--</isNotNull>-->  
    <!--<isNotNull property="departmentId" prepend="and">-->  
    <!--pi.department_id = #{departmentId:VARCHAR}-->  
    <!--</isNotNull>-->  
    <!--<isNotNull property="companyId" prepend="and">-->  
    <!--pi.COMPANY_ID = #{companyId:VARCHAR}-->  
    <!--</isNotNull>-->  
    <!--<isNotNull property="projectName" prepend="and">-->  
    <!--pi.project_name like concat('%', #{projectName:VARCHAR}, '%')-->  
    <!--</isNotNull>-->  
    <!--<isNotNull property="employeeName" prepend="and">-->  
    <!--ei.EMPLOYEE_NAME like concat('%', #{employeeName:VARCHAR}, '%')-->  
    <!--</isNotNull>-->  
    <!--&lt;!&ndash; 项目无效    项目结束时间小于当前日期 没有多余字段直接使用 planStartDate 作为结束时间 &ndash;&gt;-->  
    <!--<isNotNull property="planStartDate" prepend="and">-->  
    <!--<![CDATA[-->  
    <!--pi.plan_end_date <= date_format(#{planStartDate:DATE},'%Y-%m-%d')-->  
    <!--]]>-->  
    <!--</isNotNull>-->  
    <!--&lt;!&ndash; 项目有效  项目结束时间大于当前时间 &ndash;&gt;-->  
    <!--<isNotNull property="planEndDate" prepend="and">-->  
    <!--<![CDATA[-->  
    <!--pi.plan_end_date >= date_format(#{planEndDate:DATE},'%Y-%m-%d')-->  
    <!--]]>-->  
    <!--</isNotNull>-->  
    <!--<isNotNull property="array" prepend="and">-->  
    <!--pi.contract_no  in-->  
    <!--<iterate property="array"  close=")" open="("  conjunction=",">-->  
    <!--<![CDATA[ #{array[]} ]]>-->  
    <!--</iterate>-->  
    <!--</isNotNull>--> SELECT tbl.*,ei.EMPLOYEE_NAME FROM (SELECT ei.EMPLOYEE_NAME AS empName, ei.EMPLOYEE_ID empId, pe.contract_no conNo, pi.* FROM tbl_employee_info ei, tbl_project_etc pe, tbl_project_info pi WHERE ei.EMPLOYEE_ID = pe.employee_id AND pi.contract_no = pe.contract_no AND ei.EMPLOYEE_NAME like concat('%', #{employeeName:VARCHAR}, '%')) tbl LEFT JOIN tbl_employee_info ei on tbl.EMPLOYEE_ID = ei.EMPLOYEE_ID
  </select>
  <!--查询项目 区分地区和公司 -->
  <select id="countByProjectInfoStatByAREAA" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo">SELECT count(1) FROM tbl_project_info pi ,tbl_employee_info ei,tbl_project_etc pe where ei.EMPLOYEE_ID = pe.employee_id AND pe.contract_no = pi.contract_no
    <!--<isNotNull property="area" prepend="and">-->  
    <!--dep.area = #{area:VARCHAR}-->  
    <!--</isNotNull>-->  
    <if test="departmentId != null">and pi.department_id = #{departmentId:VARCHAR}</if>  
    <if test="companyId != null">and pi.COMPANY_ID = #{companyId:VARCHAR}</if>  
    <if test="projectName != null">and pi.project_name like concat('%', #{projectName:VARCHAR}, '%')</if>  
    <if test="employeeName != null">and ei.EMPLOYEE_NAME like concat('%', #{employeeName:VARCHAR}, '%')</if>  
    <!-- 项目无效    项目结束时间小于当前日期 没有多余字段直接使用 planStartDate 作为结束时间 -->  
    <if test="planStartDate != null">and pi.plan_end_date &lt;= date_format(#{planStartDate:DATE},'%Y-%m-%d')</if>  
    <!-- 项目有效  项目结束时间大于当前时间 -->  
    <if test="planEndDate != null">and pi.plan_end_date &gt;= date_format(#{planEndDate:DATE},'%Y-%m-%d')</if>  
    <if test="array != null">
      <iterate property="array" close=")" open="(" conjunction=","> <![CDATA[ #{array[]} ]]> </iterate> and pi.contract_no in
    </if> 
  </select>
  <select id="countByProjectInfoStatByAREA" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo">SELECT count(1) FROM tbl_project_info pi ,tbl_department_info dep where dep.DEPARTMENT_ID = pi.department_id
    <if test="area != null">and dep.area = #{area:VARCHAR}</if>  
    <if test="departmentId != null">and pi.department_id = #{departmentId:VARCHAR}</if>  
    <if test="companyId != null">and pi.COMPANY_ID = #{companyId:VARCHAR}</if>  
    <if test="projectName != null">and pi.project_name like concat('%', #{projectName:VARCHAR}, '%')</if>  
    <!-- 项目无效    项目结束时间小于当前日期 没有多余字段直接使用 planStartDate 作为结束时间 -->  
    <if test="planStartDate != null">and pi.plan_end_date &lt;= date_format(#{planStartDate:DATE},'%Y-%m-%d')</if>  
    <!-- 项目有效  项目结束时间大于当前时间 -->  
    <if test="planEndDate != null">and pi.plan_end_date &gt;= date_format(#{planEndDate:DATE},'%Y-%m-%d')</if>  
    <if test="array != null">
      <iterate property="array" close=")" open="(" conjunction=","> <![CDATA[ #{array[]} ]]> </iterate> and pi.contract_no in
    </if> 
  </select>
  <!-- 查询所有的项目 -->
  <select id="selectAllProjectInfo" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo">SELECT * FROM tbl_project_info tpi ,tbl_department_info tdi where 1=1 and tpi.department_id = tdi.DEPARTMENT_ID
    <if test="departmentId != null">and tpi.department_id = #{departmentId:CHAR}</if>  
    <if test="companyId != null">and tpi.COMPANY_ID = #{companyId:VARCHAR}</if>  
    <if test="contractNo != null">and tpi.contract_no = #{contractNo:VARCHAR}</if>  
    <if test="planEndDate != null">and date_format(tpi.plan_end_date,'%Y-%m-%d')&gt;= date_format(#{planEndDate:DATE},'%Y-%m-%d')</if>  
    <if test="area != null">and tdi.area = #{area:VARCHAR}</if> 
  </select>
  <!-- 根据roleId查询所有的项目 -->
  <select id="selectAllProjectInfo2" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo"> 
    <!--select * from tbl_project_info WHERE  contract_no-->  
    <!--in(-->  
    <!--select ROLE_ENTILENMENT from tbl_project_menu WHERE  ROLE_ID = #{roleId:VARCHAR} AND ROLE_CHECKED=1 AND LENGTH(ROLE_ENTILENMENT)=11-->  
    <!--)-->  
    <!--<isNotNull prepend="and" property="departmentId" >-->  
    <!--department_id = #{departmentId:VARCHAR}-->  
    <!--</isNotNull>--> SELECT * FROM tbl_project_info tpi where 1=1
    <if test="departmentId != null">and tpi.department_id = #{departmentId:CHAR}</if>  
    <if test="companyId != null">and tpi.COMPANY_ID = #{companyId:VARCHAR}</if>  
    <if test="contractNo != null">and tpi.contract_no = #{contractNo:VARCHAR}</if>  
    <if test="planEndDate != null">and date_format(tpi.plan_end_date,'%Y-%m-%d')&gt;= date_format(#{planEndDate:DATE},'%Y-%m-%d')</if>  
    <!--<isNotNull prepend="and" property="area" >-->  
    <!--tdi.area = #{area:VARCHAR}-->  
    <!--</isNotNull>--> 
  </select>
  <!-- 查询客户的项目 -->
  <select id="getCustomerProjectById" resultMap="BaseResultMap" parameterType="java.lang.String">select pro.* from tbl_customer_project_ref ref , tbl_project_info pro where pro.contract_no = ref.contract_no and ref.customer_id =#{value:VARCHAR}</select>
  <!-- 查询所有的项目 -->
  <select id="selectProjectInfoByDepartMentId" resultMap="BaseResultMap" parameterType="java.lang.String">SELECT * FROM tbl_project_info where department_id= #{value:VARCHAR}</select>
  <!--  查询单个项目信息 -->
  <select id="getProjectByDaoEmpid" resultMap="resultMapExt" parameterType="java.util.HashMap"> 
    <!--
           SELECT * FROM tbl_project_info where employee_id= #{employeeId:VARCHAR}
           --> select o.* from tbl_project_info o,tbl_project_etc tc where o.contract_no = tc.contract_no and tc.employee_id= #{employeeIds:VARCHAR} and o.COMPANY_ID = #{companyIds:VARCHAR} and tc.is_leave='00'
  </select>
  <!-- 项目权限菜单 -->
  <select id="getProjectByMenu" resultType="java.util.HashMap" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo">select dep.DEPARTMENT_ID as departmentid, dep.DEPARTMENT_NAME as departmentname, pro.contract_no as contractno, pro.project_name as shortname from tbl_project_info pro ,tbl_department_info dep where pro.department_id = dep.DEPARTMENT_ID ORDER BY dep.DEPARTMENT_NAME</select>
  <select id="getProjectBycontractNo" resultMap="BaseResultMap" parameterType="java.lang.String">select * from tbl_project_info where tbl_project_info.contract_no =#{contractNo:VARCHAR}</select>
  <select id="selectProjectNameBycontractNo" resultType="java.lang.String" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo">select project_name from tbl_project_info where contract_no =#{contractNo:VARCHAR}</select>
  <select id="selectSimProjectInfo" resultMap="SimpleMap" parameterType="com.i2shopping.i2work.operation.core.project.model.ProjectInfo">SELECT contract_no,project_name,department_id,project_actual_no FROM tbl_project_info where 1=1
    <trim> 
      <include refid="tbl_project_info.project_Where_Clause"/> 
    </trim> and plan_end_date &gt; now()
  </select>
  <select id="selectProjectByRoleId" parameterType="java.lang.String" resultMap="BaseResultMap">select a.* from tbl_project_info a,tbl_project_menu b where a.contract_no = b.role_entilenment and b.role_checked = '1' and b.role_id = #{roleId:VARCHAR}</select>
</mapper>

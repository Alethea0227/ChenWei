<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="TBL_ROLE">
  <resultMap id="BaseResultMap" type="com.i2shopping.i2work.operation.core.common.model.Role">
    <result column="ROLE_ID" property="roleId" jdbcType="VARCHAR"/>
    <result column="NAME" property="name" jdbcType="VARCHAR"/>
    <result column="DESCRIPTION" property="description" jdbcType="VARCHAR"/>
    <result column="STATUS" property="status" jdbcType="VARCHAR"/>
  </resultMap>
  <!-- 动态组装sql 参数 代码片段 -->
  <sql id="role_where_clause"> 
    <if test="roleId != null and roleId != ''">and ROLE_ID=#{roleId}</if>  
    <if test="name != null and name != ''">and NAME LIKE '%'||#{name}||'%'</if>  
    <if test="description != null and description != ''">and DESCRIPTION=#{description}</if>  
    <if test="status != null and status != ''">and STATUS=#{status}</if> 
  </sql>
  <sql id="Criteria_Where_Clause"> 
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate"> 
      <if test="oredCriteria[].valid!= null and oredCriteria[].valid == 'true'.toString()">( 
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and">$oredCriteria[].criteriaWithoutValue[]$</iterate>  
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and">$oredCriteria[].criteriaWithSingleValue[].condition$ #{oredCriteria[].criteriaWithSingleValue[].value}</iterate>  
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and">$oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction=",">#{oredCriteria[].criteriaWithListValue[].values[]}</iterate> 
        </iterate>  
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and">$oredCriteria[].criteriaWithBetweenValue[].condition$ #{oredCriteria[].criteriaWithBetweenValue[].values[0]} and #{oredCriteria[].criteriaWithBetweenValue[].values[1]}</iterate> )
      </if> 
    </iterate> 
  </sql>
  <select id="selectByCriteria" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.common.model.RoleCriteria"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Jul 01 21:19:06 CST 2015.
    --> select ROLE_ID, NAME, DESCRIPTION, STATUS from tbl_role
    <if test="_parameter != null"> 
      <include refid="TBL_ROLE.Criteria_Where_Clause"/>  
      <if test="orderByClause != null">order by ${orderByClause}</if> 
    </if> 
  </select>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.common.model.Role"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Apr 12 21:27:40 CST 2012.
    --> select ROLE_ID, NAME, DESCRIPTION, STATUS from TBL_ROLE where ROLE_ID = #{roleId:VARCHAR}
    <!-- and ROLE_ID != 'ROLE2000' --> 
  </select>
  <!-- 通过权限获取角色 -->
  <select id="selectByEntId" resultMap="BaseResultMap" parameterType="java.lang.String"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Apr 12 21:27:40 CST 2012.
    --> select ROLE_ID from TBL_ROLE where ROLE_ID in (SELECT ROLE_ID FROM TBL_ROLE_ENT_RELATION where entitlement = #{value:VARCHAR});
  </select>
  <delete id="deleteByPrimaryKey" parameterType="com.i2shopping.i2work.operation.core.common.model.Role"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Apr 12 21:27:40 CST 2012.
    --> delete from TBL_ROLE where ROLE_ID = #{roleId:VARCHAR}
  </delete>
  <delete id="deleteByCriteria" parameterType="com.i2shopping.i2work.operation.core.common.model.RoleCriteria">delete from TBL_ROLE 
    <include refid="TBL_ROLE.Criteria_Where_Clause"/> 
  </delete>
  <insert id="insert" parameterType="com.i2shopping.i2work.operation.core.common.model.Role">insert into tbl_role (ROLE_ID, NAME, DESCRIPTION, STATUS) values (#{roleId:VARCHAR}, #{name:VARCHAR}, #{description:VARCHAR}, #{status:VARCHAR})</insert>
  <insert id="insertSelective" parameterType="com.i2shopping.i2work.operation.core.common.model.Role"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Jul 01 21:19:06 CST 2015.
    --> insert into tbl_role 
    <trim prefix="("> 
      <if test="roleId != null">ROLE_ID ,</if>  
      <if test="name != null">NAME ,</if>  
      <if test="description != null">DESCRIPTION ,</if>  
      <if test="status != null">STATUS ,</if> )
    </trim> values 
    <trim prefix="("> 
      <if test="roleId != null">#{roleId:VARCHAR} ,</if>  
      <if test="name != null">#{name:VARCHAR} ,</if>  
      <if test="description != null">#{description:VARCHAR} ,</if>  
      <if test="status != null">#{status:VARCHAR} ,</if> )
    </trim> 
  </insert>
  <select id="countByCriteria" parameterType="com.i2shopping.i2work.operation.core.common.model.RoleCriteria" resultType="java.lang.Integer"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Apr 12 21:27:40 CST 2012.
    --> select count(*) from TBL_ROLE 
    <include refid="TBL_ROLE.Criteria_Where_Clause"/> 
  </select>
  <update id="updateByCriteriaSelective"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Jul 01 21:19:06 CST 2015.
    --> update tbl_role 
    <trim prefix="set"> 
      <if test="record.roleId != null">ROLE_ID = #{record.roleId:VARCHAR} ,</if>  
      <if test="record.name != null">NAME = #{record.name:VARCHAR} ,</if>  
      <if test="record.description != null">DESCRIPTION = #{record.description:VARCHAR} ,</if>  
      <if test="record.status != null">STATUS = #{record.status:VARCHAR} ,</if> 
    </trim>  
    <if test="_parameter != null"> 
      <include refid="TBL_ROLE.Criteria_Where_Clause"/> 
    </if> 
  </update>
  <update id="updateByCriteria"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Jul 01 21:19:06 CST 2015.
    --> update tbl_role set ROLE_ID = #{record.roleId:VARCHAR}, NAME = #{record.name:VARCHAR}, DESCRIPTION = #{record.description:VARCHAR}, STATUS = #{record.status:VARCHAR}
    <if test="_parameter != null"> 
      <include refid="TBL_ROLE.Criteria_Where_Clause"/> 
    </if> 
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.i2shopping.i2work.operation.core.common.model.Role"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Apr 12 21:27:40 CST 2012.
    --> update TBL_ROLE 
    <trim prefix="set"> 
      <if test="roleId != null">ROLE_ID = #{roleId:VARCHAR} ,</if>  
      <if test="name != null">NAME = #{name:VARCHAR} ,</if>  
      <if test="description != null">DESCRIPTION = #{description:VARCHAR} ,</if>  
      <if test="status != null">STATUS = #{status:VARCHAR} ,</if> 
    </trim> where ROLE_ID = #{roleId:VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.i2shopping.i2work.operation.core.common.model.Role"> 
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Apr 12 21:27:40 CST 2012.
    --> update TBL_ROLE set NAME = #{name:VARCHAR}, DESCRIPTION = #{description:VARCHAR}, STATUS=#{status:CHAR}, where ROLE_ID = #{roleId:VARCHAR}
  </update>
  <select id="selectCount" resultType="java.lang.Integer" parameterType="com.i2shopping.i2work.operation.core.common.model.Role">select count(*) from TBL_ROLE
    <trim prefix="where"> 
      <include refid="role_where_clause"/> 
    </trim> 
  </select>
  <select id="selectRole" resultMap="BaseResultMap" parameterType="com.i2shopping.i2work.operation.core.common.model.Role">select * from TBL_ROLE
    <trim prefix="where"> 
      <include refid="role_where_clause"/> 
    </trim> 
  </select>
  <select id="selectRoleByUserId" resultMap="BaseResultMap" parameterType="java.lang.String">select * from TBL_ROLE where ROLE_ID in ( select ROLE_ID from TBL_USER_ROLE_REL where USERID = #{userid:varchar} )</select>
  <!-- 查询所有角色 -->
  <select id="selectRoleByPage" parameterType="com.i2shopping.i2work.operation.core.common.model.Role" resultMap="BaseResultMap">select * from tbl_role where role_id != 'ROLE2000'</select>
  <select id="selectByRoleCount" parameterType="com.i2shopping.i2work.operation.core.common.model.Role" resultType="java.lang.Integer">select count(*) from tbl_role where role_id != 'ROLE2000'</select>
</mapper>
